<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:th="http://www.thymeleaf.org">
<meta charset="utf-8">
<title class="MovementsSidebar">AssignOffenderBed</title>
<div th:replace="~{fragments/head :: head}"></div>
<!-- <script src="http://code.jquery.com/jquery-latest.js"></script> -->
    

<body class="mod-bg-1 mod-nav-link">
<!-- Inside another HTML page -->

	<!-- BEGIN Page Header --> 
				<div th:replace="~{fragments/header :: header}"></div>
				<div th:replace="~{fragments/navmenus :: navmenus}"></div>
				<!-- END Page Header -->
	<!-- BEGIN Page Wrapper -->
	<div class="page-wrapper"> 
		<div class="page-inner">
			<!-- BEGIN Left Aside -->

			<div th:replace="~{fragments/sidebar :: sidebar}"></div> 

			<!-- END Left Aside --> 
			<div class="page-content-wrapper">
			
				<!-- BEGIN Page Content -->
				<!-- the #js-page-content id is needed for some plugins to initialize -->
				<main id="js-page-content" role="main" class="page-content">
					<!-- <ol class="breadcrumb page-breadcrumb">
                            <li class="breadcrumb-item"><a href="javascript:void(0);">SmartAdmin</a></li>
                            <li class="breadcrumb-item">category_1</li>
                            <li class="breadcrumb-item">category_2</li>
                            <li class="breadcrumb-item active">Page Titile</li>
                            <li class="position-absolute pos-top pos-right d-none d-sm-block"><span class="js-get-date"></span></li>
                        </ol> -->
					<div class="subheader mb-1">
						<h1 class="subheader-title">
						<div th:replace="~{fragments/toggleMenu :: toggleMenu}"></div>
							<i class='subheader-icon fal fa-'></i> <span id="screenNameHolder" th:data-name="${screenCode}"  th:text="${screenName}"></span>
						</h1>
						<div class="frame-wrap bg-transparent">
							<div class="btn-group">
							<div class="col-12 pr-0">
								<div class="js-get-date">[your date here]</div>
							</div> 
								<div class="mr-2">
									<div class="input-append date position-relative w-100">
										
										<span class="add-on"></span>
									</div>
								</div>
							</div>
							<a href="javascript:void(0);"
								class="btn btn-primary btn-sm btn-icon waves-effect waves-themed disabled"
								data-toggle="tooltip" data-placement="top" data-original-title="Add"> <i
									class="fal fa-plus"></i>
							</a> <a href="javascript:void(0);"
								class="btn btn-warning btn-sm btn-icon waves-effect waves-themed disabled"
								data-toggle="tooltip" data-placement="top" data-original-title="Print"> <i
									class="fal fa-print"></i>
							</a> <a href="javascript:void(0);"
								class="btn btn-secondary btn-sm btn-icon waves-effect waves-themed"
								data-toggle="tooltip" data-placement="top" data-original-title="Clear" id="clear-btn"> <i
									class="fal fa-times"></i>
							</a> <a href="javascript:void(0);"
								class="btn btn-success btn-sm btn-icon waves-effect waves-themed" data-toggle="tooltip"
								data-placement="top" data-original-title="OK/Save"> <i class="fal fa-save"></i>
							</a> <a href="javascript:void(0);"
								class="btn btn-danger btn-sm btn-icon waves-effect waves-themed" data-toggle="tooltip"
								data-placement="top" data-original-title="Cancel/Exit"> <i class="fal fa-sign-out"></i>
							</a>
						</div>

					</div>
					
					<div class="row">
						<div class="col-lg-12">						
							<div th:replace="~{fragments/formheader :: formheader}"></div>
							<div class="panel mb-0 bg-transparent border-0 shadow-none">
								<div class="panel-content">
									<div class="row">
												<div class="col-lg-3 col-xl-3">
													<div class="row">
														<div class="col-lg-12 col-xl-12">
															<div id="selecthousingunit_Block" class="panel mb-2">
							                                    <div class="panel-hdr">
							                                        <h2>
							                                            Select Housing Unit
							                                        </h2>
							                                    </div>
							
							                                    <div class="panel-container show">
							                                        <div class="panel-content p-0">
							                                            <div id="js-checkbox-toggles" class="d-flex mb-3 housingUnitBlock leftHousingunit overflow-auto">
								            								<div class="form-group row mx-1 w-100">
																		

<!-- <div class="sidebartest">
  <ul>
    <li class="tree-node">Appliances</li>
    <li class="tree-node">Baby & Infant Care</li>
    
    <li class="tree-node has-children">Beauty & Hygiene
      <ul class="tree-branch">
        <li class="tree-node">Bath & Hand Wash</li>
        <li class="tree-node">Feminine Hygiene</li>
        <li class="tree-node">Fragrances & Deos</li>
        
        <li class="tree-node has-children">Hair Care
          <ul class="tree-branch">
            <li class="tree-node">Accessories</li>
            <li class="tree-node">Color</li>
            <li class="tree-node">Dry Shampoo</li>
            <li class="tree-node">Mask, Oil & Serum</li>
            <li class="tree-node active">Shampoo & Conditioner</li>
            <li class="tree-node">Styling</li>
            <li class="tree-node">Tools</li>
            <li class="tree-node">Treatments</li>
            <li class="tree-node">Value Packs</li>
          </ul>
        </li>
      </ul>
    </li> -->
<div class="sidebartest"></div>
<!-- <ul id="buildingTree"></ul> -->

								                                               <!--  <div class="floatingFields w-100 col-lg-6 mt-lg-3 pl-0 col-xl-12 mt-xl-3">
								                                                  <input type="text" class="form-control w-100 floatingLable rawField"  data-fld="unitnum" data-lbl="Wing/Unit"  aria-label="bldNumDropdown" id="unitNumDropdown" name="unitNumDropdown"  value="" placeholder="">
																						<label class="form-label mr-1 text-nowrap mb-0" for="unitNumDropdown" >Wing/Unit</label>																		
																					
								                                                </div>	
								                                                <div class="floatingFields w-100 col-lg-6 mt-lg-3 pl-0 col-xl-12 mt-xl-3">
								                                                   <input type="text" class="form-control w-100 floatingLable rawField"  data-fld="floornum" data-lbl="Floor"  aria-label="FloorNumDropdown" id="unitNumDropdown" name="FloorNumDropdown"  value="" placeholder="">
																						<label class="form-label mr-1 text-nowrap mb-0" for="FloorNumDropdown" >Floor</label>								
																					
								                                                </div>	
								                                                <div class="floatingFields w-100 col-lg-6 mt-lg-3 pl-0 col-xl-12 mt-xl-3">
																				  <input type="text" class="form-control w-100 floatingLable rawField"  data-fld="tiernum" data-lbl="Tier/Pod"  aria-label="tierNumDropdown" id="tierNumDropdown" name="tierNumDropdown"  value="" placeholder="">
																						<label class="form-label mr-1 text-nowrap mb-0" for="tierNumDropdown" >Tier/Pod</label>				
																						
								                                                </div>	
								                                                <div class="floatingFields w-100 col-lg-6 mt-lg-3 pl-0 col-xl-12 mt-xl-3">
			                                                                       <input type="text" class="form-control w-100 floatingLable rawField"  data-fld="cellnum" data-lbl="Room/Cell"  aria-label="cellNumDropdown" id="cellNumDropdown" name="cellNumDropdown"  value="" placeholder="">
																						<label class="form-label mr-1 text-nowrap mb-0" for="cellNumDropdown" >Room/Cell</label>				
																				
								                                                </div>	
																				<div class="col-lg-12 col-xl-12 mt-xl-3">
																					<label for="" class="mb-0 text-nowrap text-primary">SHOW</label>
																				</div>
																				<div class="col-lg-6 col-xl-12 mt-xl-3">
																					<div class="custom-control custom-radio mr-2 my-2">
																		                <input type="radio" class="custom-control-input all_beds rawField" data-fld="allbeds" data-lbl="All Beds" id="AllBedsradio" name="bedStatus" aria-label="AllBedsradio" value="" checked="">
																		                <label class="custom-control-label" for="AllBedsradio">All Beds</label>
																		            </div>
																		            <div class="custom-control custom-radio mr-2 mb-2">
																		                <input type="radio" class="custom-control-input unoccupied_beds rawField" data-fld="unoccupiedbeds" data-lbl="Unoccupied Beds" id="Unoccupiedradio" name="bedStatus" aria-label="Unoccupiedradio" value="">
																		                <label class="custom-control-label" for="Unoccupiedradio">Unoccupied Beds</label>
																		            </div>
																				</div>
																				<div class="col-lg-6 col-xl-12">
																					<div class="custom-control custom-radio mr-2 mb-2">
																		                <input type="radio" class="custom-control-input reserved_beds rawField" data-fld="reservedbeds" data-lbl="Reserved Beds"  id="Reservedradio" name="bedStatus" aria-label="Reservedradio" value="">
																		                <label class="custom-control-label" for="Reservedradio">Reserved Beds</label>
																		            </div>
																		            <div class="custom-control custom-radio mr-2 mb-1 d-flex allign-items-center justify-content-between">
																		                <input type="radio" class="custom-control-input occupied_bed rawField" data-fld="occupiedbeds" data-lbl="Occupied Beds"  id="Occupiedradio" name="bedStatus" aria-label="Occupiedradio" value="">
																		                <label class="custom-control-label" for="Occupiedradio">Occupied Beds</label>
																		                
																		                 <span class="d-flex" data-toggle="modal" data-target="" >
																								<a href="#" id="bedcellselected" style="padding: 5px;" class="btn btn-primary btn-sm ml-1 btn js-waves-off d-flex align-items-center select_btn " data-toggle="tooltip" data-placement="top" data-original-title="" data-action="toggle" >
																									Search 
																								</a>
																								
																							</span>
																							
																		            </div> -->
																				</div>
																			</div>                      	
							                                            </div>
							                                        </div>
							
							                                    </div>
							
							                                </div>		
														</div>
														<div class="col-lg-12 col-xl-12 px-0">
															<div id="reasonBed_Assign" class="panel mb-0">
							                                    <div class="panel-hdr characteristHeader">
							                                        <h2 style="font-size: 15px;line-height: 1.5;">
							                                            Reason Bed Assigned/Reserved
							                                        </h2>
							                                    </div>
							
							                                    <div class="panel-container show">
							                                        <div class="panel-content">
							                                            <div id="js-checkbox-toggles" class="d-flex housingUnitBlock mb-0">
																			<div class="form-group w-100">	
																				<div class="selectFloatingLabel w-100">
																					<label for="reasonDropDown" class="form-label mr-2 mb-0 control-label  selectFloating ">Reason</label>
																					<select class="custom-select form-control typecontact d-block mb-1 rawField floatingLableClick" data-fld="Reasondropdown" data-lbl="Reason"  id="reasonDropDown">
																				 <option value="">Reason</option>
																				  
																					</select>
								                                                </div>	
																	
																				<div class="d-flex align-items-center my-3">																	
																					<div class="floatingFields mr-2 w-100">
																						<input type="text" class="form-control w-100 floatingLable date-input rawField"  data-fld="startdate" data-lbl="Start Date"  aria-label="reasondate" id="reasondate" name="reasondate"  value="" placeholder="reasondate">
																						<label class="form-label mr-1 text-nowrap mb-0" for="reasondate" >Start Date</label>
																					</div>
																					<div class="floatingFields w-100">
																					
																						<input type="text" class="form-control w-100 floatingLable rawField"  data-fld="starttime" data-lbl="Start Time"  aria-label="reasontime" id="reasontime" name="reasontime"  value="" placeholder="reasontime">
																						<label class="form-label mr-1 text-nowrap mb-0" for="reasontime" >Start Time</label>
																					</div>
																				</div>
																				<div class="d-flex align-items-center">																	
																					<div class="floatingFields mr-2 w-100">
																						<input type="text" class="form-control w-100 floatingLable date-input rawField"  data-fld="enddate" data-lbl="End Date"  aria-label="enddate" id="enddate" name="enddate"  value="" placeholder="enddate">
																						<label class="form-label mr-1 text-nowrap mb-0" for="enddate" >End Date</label>
																					</div>
																					<div class="floatingFields w-100">
																						<input type="text" class="form-control w-100 floatingLable rawField"  data-fld="endtime" data-lbl="End Time"  aria-label="endtime" id="endtime" name="endtime"  value="" placeholder="endtime">
																						<label class="form-label mr-1 text-nowrap mb-0" for="endtime" >End Time</label>
																					</div>
																				</div>
																				
																			</div>
							                                            </div>
							                                        </div>
							                                    </div>
							                                </div>
														</div>
													</div>
												<div class="col-lg-9 pl-lg-0 col-xl-9 pl-xl-0">	
													<div id="cell_Characterist" class="panel mb-0">
					                                    <div class="panel-hdr characteristHeader">
					                                      
					                                        <!-- <div class="custom-control custom-radio mr-2 my-2">
																		                <input type="radio" class="custom-control-input all_beds rawField" data-fld="allbeds" data-lbl="All Beds" id="AllBedsradio" name="bedStatus" aria-label="AllBedsradio" value="" checked="">
																		                <label class="custom-control-label" for="AllBedsradio">All Beds</label>
																		            </div>
																		            <div class="custom-control custom-radio mr-2 ">
																		                <input type="radio" class="custom-control-input unoccupied_beds rawField" data-fld="unoccupiedbeds" data-lbl="Unoccupied Beds" id="Unoccupiedradio" name="bedStatus" aria-label="Unoccupiedradio" value="">
																		                <label class="custom-control-label" for="Unoccupiedradio">Unoccupied Beds</label>
																		            </div>
																		            <div class="custom-control custom-radio mr-2 ">
																		                <input type="radio" class="custom-control-input reserved_beds rawField" data-fld="reservedbeds" data-lbl="Reserved Beds"  id="Reservedradio" name="bedStatus" aria-label="Reservedradio" value="">
																		                <label class="custom-control-label" for="Reservedradio">Reserved Beds</label>
																		            </div>
																		             <div class="custom-control custom-radio mr-2  d-flex allign-items-center justify-content-between">
																		                <input type="radio" class="custom-control-input occupied_bed rawField" data-fld="occupiedbeds" data-lbl="Occupied Beds"  id="Occupiedradio" name="bedStatus" aria-label="Occupiedradio" value="">
																		                <label class="custom-control-label" for="Occupiedradio">Occupied Beds</label>
																		                  </div> -->
																		                  <!-- Nav Tabs -->
<ul class="nav nav-tabs" id="bedTabs" role="tablist">
  <li class="nav-item">
    <a class="nav-link active rawField px-1" id="AllBeds-tab" data-toggle="tab" href="#AllBeds" role="tab" 
       aria-controls="AllBeds" aria-selected="true" 
       data-fld="allbeds" data-lbl="All Beds">All Beds<span id="allbedcount" class="badge badge-primary">0</span></a>
  </li>
  <li class="nav-item unoccupiedtab">
    <a class="nav-link rawField px-2" id="Unoccupied-tab" data-toggle="tab" href="#Unoccupied" role="tab" 
       aria-controls="Unoccupied" aria-selected="false" 
       data-fld="unoccupiedbeds" data-lbl="Unoccupied Beds">Unoccupied Beds<span id="unoccupiedCount" class="badge badge-primaryUnoccupied">0</span></a>
  </li>
  <li class="nav-item Reservedtab">
    <a class="nav-link rawField px-2" id="Reserved-tab" data-toggle="tab" href="#Reserved" role="tab" 
       aria-controls="Reserved" aria-selected="false" 
       data-fld="reservedbeds" data-lbl="Reserved Beds">Reserved Beds<span id="reservedCount" class="badge badge-primaryReserved">0</span></a>
  </li>
  <li class="nav-item occupiedtab">
    <a class="nav-link rawField px-2" id="Occupied-tab" data-toggle="tab" href="#Occupied" role="tab" 
       aria-controls="Occupied" aria-selected="false" 
       data-fld="occupiedbeds" data-lbl="Occupied Beds">Occupied Beds<span id="occupiedCount" class="badge badge-primaryOccupied">0</span></a>
  </li>
 <li class="nav-item recommendedHousingtab">
    <a class="nav-link rawField px-2" id="recommendedHousing-tab" data-toggle="tab" href="#recommendedHousing" role="tab" 
       aria-controls="recommendedHousing" aria-selected="false" 
       data-fld="recommendedHousingbed" data-lbl="recommendedHousing">Recommended Housing<span id="RecommandedHousingCount" class="badge badge-primaryRecommendedHousing">0</span></a>
  </li> 
</ul>

<!-- Tab Panes -->
<div class="tab-content" id="bedTabsContent">
  <div class="tab-pane fade show active" id="AllBeds" role="tabpanel" aria-labelledby="AllBeds-tab">
    <!-- Your All Beds content goes here -->
  </div>
  <div class="tab-pane fade" id="Unoccupied" role="tabpanel" aria-labelledby="Unoccupied-tab">
    <!-- Your Unoccupied Beds content -->
  </div>
  <div class="tab-pane fade" id="Reserved" role="tabpanel" aria-labelledby="Reserved-tab">
    <!-- Reserved Beds content -->
  </div>
  <div class="tab-pane fade" id="Occupied" role="tabpanel" aria-labelledby="Occupied-tab">
    <!-- Occupied Beds content -->
  </div>
   <div class="tab-pane fade" id="recommendedHousing" role="tabpanel" aria-labelledby="recommendedHousing-tab">
     <div class="row">
					                        </div>
										
  </div> 
</div>
																		                  
					                                        <div class="d-flex align-items-center justify-content-end mr-2 ml-auto">

											
										</div>
					                                   </div>
					                            
					                                    <div class="panel-container show">
					                                        <div class="panel-content housingUnitBlock pb-1">
					                                            <div id="js-checkbox-toggles" class="d-flex mb-0 form-group">
					                                            	<div class="row mb-1">
																		<div class="col-lg-12 col-xl-12 cellBoxesBlock overflow-auto">	
																			<div class="row mx-1 floor-plan mt-1" id="cellBoxContainer">
																				<div class="CellBoxes unoccupied col-lg-1" >				
																				</div>
																			</div>
																			
														
																		</div>
																	<!-- 	<div class="col-lg-12 col-xl-2 pl-0 bedDetailsColor">	
																			<div class="row">
																				<div class="d-flex align-items-center mb-2 col-lg-2 mt-lg-2 col-xl-12">
																					<span class="cellBoxStatus" style="background-color: rgb(107 183 107);"></span>
																					<label for="unoccupiedCount" id="unoccupiedCount" class="form-label mb-0 ml-2 text-nowrap">Unoccupied</label>
																				</div>
																				<div class="d-flex align-items-center mb-2 col-lg-2 mt-lg-2 col-xl-12">
																					<span class="cellBoxStatus" style="background-color: rgb(238 155 67);"></span>
																					<label for="occupiedCount" id="occupiedCount" class="form-label mb-0 ml-2 text-nowrap">Occupied</label>
																				</div>
																				<div class="d-flex align-items-center mb-2 col-lg-2 mt-lg-2 col-xl-12">
																					<span class="cellBoxStatus" style="background-color: #0000ff;;"></span>
																					<label for="noContactCount" id="noContactCount" class="form-label mb-0 ml-2 text-nowrap">No Contact</label>
																				</div>
																				<div class="d-flex align-items-center mb-2 col-lg-2 mt-lg-2 col-xl-12">
																					<span class="cellBoxStatus" style="background-color: rgb(87 84 84);"></span>
																					<label for="currentoffender" id="currentoffender" class="form-label mb-0 ml-2 text-nowrap">Current Offender</label>
																				</div>
																				<div class="d-flex align-items-center mb-2 col-lg-2 mt-lg-2 col-xl-12">
																					<span class="cellBoxStatus" style="background-color: #3287d4;"></span>
																					<label for="reservedCount" id="reservedCount" class="form-label mb-0 ml-2 text-nowrap">Reserved</label>
																				</div>
																				<div class="d-flex align-items-center mb-2 col-lg-2 mt-lg-2 col-xl-12">
																					<span class="cellBoxStatus" style="background-color: #ff0000;"></span>
																					<label for="faultyCount"  id="faultyCount" class="form-label mb-0 ml-2 text-nowrap">Offline</label>
																				</div>
																				<div class="d-flex align-items-center mb-2 col-lg-2 mt-lg-2 col-xl-12">
																					<span class="cellBoxStatus" style="background-color: rgb(167 109 109);"></span>
																					<label for="covidCount" id="covidCount" class="form-label mb-0 ml-2 text-nowrap">COVID-19</label>
																				</div>
																				<div class="selectBedBlock col-lg-12 mb-lg-2 col-xl-12">
																					
																					<textarea class="form-control sel_bed_dtls rawfield " data-fld="selectedbeddetails"  data-lbl="Selected Bed Details" id="sel_bed_dtls" placeholder="" rows="4" name="sel_bed_dtls" aria-label="Comments" style="resize:none;background-color: #ffe0c0;" value=""></textarea>
																					<label  class="text-primary mb-0 mr-2 text-nowrap" for="sel_bed_dtls">Selected Bed Details</label>
																				</div>
																			</div>
																		</div> -->
																		<div class="col-12 mt-1">
																		<div class="d-flex align-items-center justify-content-between mb-1">
																			<h6 class="mx-1 mb-0 text-nowrap  text-left text-primary" style="font-weight: 600;">Occupied/Reserved/No Contact Inmate Detail</h6>
																			<div>
																				<button type="button" class="btn btn-primary btn-sm mr-1 assign_res_btn "   id="assign" > Assign/Reserve </button>									
																				<button type="button" class="btn btn-primary btn-sm mr-1 unreserve_btn "  id="unreserve"> Unreserve </button>							
																				<button type="button" class="btn btn-primary btn-sm mr-1 add_to_wait_btn " id="addWaitlist"> Add to Wait List </button>									
																			</div>
																		</div>
																			<div class="row mx-1">
																				<div class="col-12 col-lg-2 mt-11px pl-0 d-flex align-items-center  floatingFields">
																				<!-- 	<input type="text" class="form-control w-100 floatingLable rawfield"  data-fld="occupiedid"  data-lbl="ID#" aria-label="occupiedsbino" id="occupiedsbino" name="occupiedsbino" value=" " placeholder=" " >
																					<label for="occupiedsbino" class="form-label mb-0  text-nowrap">ID#</label> -->
																						<input type="text" class="form-control w-100 floatingLable rawField"  data-fld="occupiedid" data-lbl="ID#"  aria-label="occupiedsbino" id="occupiedsbino" name="occupiedsbino"  value="" placeholder="">
																						<label class="form-label mr-1 text-nowrap mb-0" for="occupiedsbino" >ID#</label>
																				</div>
																				<div class="col-12 col-lg-4 pl-0 mt-11px d-flex align-items-center  floatingFields">
																					<input type="text" class="form-control w-100 floatingLable rawField"  data-fld="occupiedname" data-lbl="Name(L,F,M,S)"  aria-label="occupiedname" id="occupiedname" name="occupiedname"  value="" placeholder="">
																					<label class="form-label mr-1 text-nowrap mb-0" for="occupiedname" >Name(L,F,M,S)</label>
																				</div>
																				<div class="col-12 col-lg-2 pl-0 mt-11px d-flex  align-items-center  floatingFields">
																					<input type="text" class="form-control w-100 floatingLable rawField"  data-fld="occupieddob" data-lbl="DOB"  aria-label="occupieddob" id="occupieddob" name="occupieddob"  value="" placeholder="">
																						<label class="form-label mr-1 text-nowrap mb-0" for="occupieddob" >DOB</label>
																				</div>
																				<div class="col-12 col-lg-1 pl-0 mt-11px d-flex  align-items-center  floatingFields">
																					<input type="text" class="form-control w-100 floatingLable rawField"  data-fld="occupiedsex" data-lbl="Sex"  aria-label="occupiedsex" id="occupiedsex" name="occupiedsex"  value="" placeholder="">
																						<label class="form-label mr-1 text-nowrap mb-0" for="occupiedsex" >Sex</label>
																				</div>
																				<div class="col-12 col-lg-1 pl-0  d-flex mt-11px align-items-center  floatingFields">
																							<input type="text" class="form-control w-100 floatingLable rawField"  data-fld="occupiedrace" data-lbl="Race"  aria-label="occupiedrace" id="occupiedrace" name="occupiedrace"  value="" placeholder="">
																						<label class="form-label mr-1 text-nowrap mb-0" for="occupiedrace" >Race</label>
																				</div>
																				<div class="col-12 col-lg-2 pl-0 d-flex mt-11px align-items-center   floatingFields ">																			
													                                	<input type="text" class="form-control w-100 floatingLable rawField"  data-fld="releasedate" data-lbl="Release Date"  aria-label="occupiedreleaseDate" id="occupiedreleaseDate" name="occupiedreleaseDate"  value="" placeholder="">
																						<label class="form-label mr-1 text-nowrap mb-0" for="occupiedreleaseDate" >Release Date</label>
																				</div>
																				<div class="col-12 col-lg-7 pl-0 d-flex align-items-center mt-11px floatingFields">

																					 	<input type="text" class="form-control w-100 floatingLable rawField"  data-fld="rhreason" data-lbl="RH Reason"  aria-label="ocuupiedrhreasonstatus" id="ocuupiedrhreasonstatus" name="ocuupiedrhreasonstatus"  value="" placeholder="">
																						<label class="form-label mr-1 text-nowrap mb-0" for="ocuupiedrhreasonstatus" >RH Reason</label>
																				</div>	
																				<div class="col-lg-5 px-0 mt-11px d-flex align-items-center">
																					<button type="button" class="btn btn-primary btn-sm mx-2 show_housing_btn "   id="showhousingdetails"style="width: 300px;"disabled> Show Housing Details </button>
																					 <label for="showhousingdetails" class="form-label mb-0  text-nowrap"></label>
																					<button type="button" class="btn btn-primary btn-sm mx-2 protected_off_btn "  id="protectedoffbtn" style="width: 350px;" disabled> Protected Offender Details </button>
																					 <label for="protectedoffbtn" class="form-label mb-0  text-nowrap"></label>
																				</div>																																					
																			</div>
																		</div>
																	</div>
					                                            </div>
					                                        </div>
					                                    </div>
					                                </div>
												</div>
											</div>
											
								</div>	
								</div>
							</div>
							
							<!-- <div class="ml-1 mb-1">
								<a href="OffenderHousingDetailsHistory" class="off_dtl_btn"><button type="button" class="btn btn-primary btn-sm mr-1 off_dtl_btn "  id="offenderdetails"> Offender Details </button></a>		
								<a href="HousingEntityDetailsHistory" class="bed_dtl_btn"><button type="button" class="btn btn-primary btn-sm mr-1 bed_dtl_btn "  id="beddetails"> Bed Details </button></a>
								<a href="IndividualOffenderMovement" class="ind_move_btn"><button type="button" class="btn btn-primary btn-sm mr-1 ind_move_btn "  id="individualmovement"> Individual Movement </button></a>
							</div> -->
						</div>
						<div class="modal fade" id="listOfCaseChargeModal" tabindex="-1" role="dialog" aria-hidden="true">
                            <div class="modal-dialog modal-dialog-centered modal-lg" role="document">
                               <div class="modal-content">
                                 <div class="modal-header pt-3 pb-2">
                                  <h6 class="modal-title">OMNET MESSAGE</h6>
                                 <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                  <span aria-hidden="true"><i class="fal fa-times"></i></span>
                                  </button>
                                  </div>
                            <div class="modal-body py-0">
                            </div>
                            <div class="modal-footer">
                            <button type="button" class="btn btn-primary btn-sm" data-dismiss="modal" id="fetchDataBtn" >Ok</button>                         
                            </div>
                             </div>
                    </div>
					</div>
							<div class="modal fade" id="securitymodal" tabindex="-1" role="dialog" aria-hidden="true">
                            <div class="modal-dialog modal-dialog-centered modal-lg" role="document">
                               <div class="modal-content">
                                 <div class="modal-header pt-3 pb-2">
                                  <h6 class="modal-title"> OMNET MESSAGE</h6>
                                 <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                  <span aria-hidden="true"><i class="fal fa-times"></i></span>
                                  </button>
                                  </div>
                            <div class="modal-body py-0">
                            </div>
                            <div class="modal-footer">
                            <button type="button" class="btn btn-primary btn-sm"  id="automatically" >YES</button>
                            <button type="button" class="btn btn-primary btn-sm" data-dismiss="modal" >NO</button>                          
                            </div>
                             </div>
                    </div>
					</div>
					<div class="modal fade" id="checklocationmodal" tabindex="-1" role="dialog" aria-hidden="true">
                            <div class="modal-dialog modal-dialog-centered modal-lg" role="document">
                               <div class="modal-content">
                                 <div class="modal-header pt-3 pb-2">
                                  <h6 class="modal-title"> OMNET MESSAGE</h6>
                                 <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                  <span aria-hidden="true"><i class="fal fa-times"></i></span>
                                  </button>
                                  </div>
                            <div class="modal-body py-0">The offender is not the selected location.Do you want OMNET to move him to the location automatically?
                            </div>
                            <div class="modal-footer">
                            <button type="button" class="btn btn-primary btn-sm"  id="checklocationmodalautomatically" >YES</button>
                            <button type="button" class="btn btn-primary btn-sm" data-dismiss="modal" >NO</button>                          
                            </div>
                             </div>
                    </div>
					</div>
					<div class="modal fade" id="movingoutresonchecklocation" tabindex="-1" role="dialog" aria-hidden="true">
                            <div class="modal-dialog modal-dialog-centered modal-lg" role="document">
                               <div class="modal-content">
                                 <div class="modal-header pt-3 pb-2">
                                  <h6 class="modal-title"> OMNET MESSAGE</h6>
                                 <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                  <span aria-hidden="true"><i class="fal fa-times"></i></span>
                                  </button>
                                  </div>
                            <div class="modal-body py-0">The offender is not the selected location.Do you want OMNET to move him to the location automatically?
                            </div>
                            <div class="modal-footer">
                            <button type="button" class="btn btn-primary btn-sm"  id="yesmovingoutlocation" >YES</button>
                            <button type="button" class="btn btn-primary btn-sm" id="movingoutno" >NO</button>                          
                            </div>
                             </div>
                    </div>
					</div>
						<div class="modal fade" id="locationmodal" tabindex="-1" role="dialog" aria-hidden="true">
                            <div class="modal-dialog modal-dialog-centered modal-lg" role="document">
                               <div class="modal-content">
                                 <div class="modal-header pt-3 pb-2">
                                  <h6 class="modal-title"> OMNET MESSAGE</h6>
                                 <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                  <span aria-hidden="true"><i class="fal fa-times"></i></span>
                                  </button>
                                  </div>
                            <div class="modal-body py-0">
                            </div>
                            <div class="modal-footer">
                            <button type="button" class="btn btn-primary btn-sm" data-dismiss="modal" id="locationmodal" >Ok</button>                         
                            </div>
                             </div>
                    </div>
					</div>
					     <div class="modal fade" id="ReasonforRH" tabindex="-1" role="dialog" aria-hidden="true">
             <div class="modal-dialog modal-dialog-centered modal-md" role="document">
                <div class="modal-content">
                      <div class="modal-header pt-3 pb-2">
                            <h6 class="modal-title">Reason for RH...!</h6>
                              <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                     <span aria-hidden="true"><i class="fal fa-times"></i></span>
                                            </button>
                                                </div>
<div class="modal-body py-0">
    <h6 class="mx-0 mb-0 text-nowrap headerBlock text-center" style="font-weight: 600;">REASON FOR RESTRICTIVE HOUSING</h6>
    <div id="table-container">
        <div class="tableFixHead" style="height: 170px;">
            <table id="reasonTable" class="table table-striped table-bordered table-sm">
                <tbody>
                    
                </tbody>
            </table>
        </div>
    </div>
</div>
<div class="modal-footer">
    <button type="button" class="btn btn-primary btn-sm" id="saveupdatereason">Ok</button>
    <button type="button" class="btn btn-secondary btn-sm" data-dismiss="modal">Cancel</button>
</div>

</div>
</div>
</div>
<div class="modal fade" id="NonRhreason" tabindex="-1" role="dialog" aria-hidden="true">

<div class="modal-dialog modal-dialog-centered modal-md" role="document">

<div class="modal-content">

<div class="modal-header pt-3 pb-2">

<h6 class="modal-title">Reason for Moving the Offender Out of RH</h6>

<button type="button" class="close" data-dismiss="modal" aria-label="Close">

<span aria-hidden="true"><i class="fal fa-times"></i></span>

</button>

</div>

<div class="modal-body py-0">

<div>

<p class="text-danger">

You are moving this offender from a restrictive housing to a non restrictive housing. Does this housing assignment end the Restrictive housing stay for this offender?

</p>

</div>

</div>

<div class="modal-footer">

<button type="button" class="btn btn-primary btn-sm" id="yesmovingout" >Yes</button>

<button type="button" class="btn btn-secondary btn-sm" id="nomovingout" >No</button>

</div>

<div class="modal-body py-0">

<div>

<p class="text-danger">

Please select a reason for moving this offender out of RH:

</p>

<div class="d-flex">

<div class="custom-control custom-checkbox custom-control-inline mr-2">

<input type="checkbox" class="custom-control-input" id="InfirmaryCheck">

<label class="custom-control-label text-nowrap" for="InfirmaryCheck">Infirmary</label>

</div>

<div class="custom-control custom-checkbox custom-control-inline mr-2">

<input type="checkbox" class="custom-control-input" id="outsideHospital">

<label class="custom-control-label text-nowrap" for="outsideHospital">Outside Hospital</label>

</div>

<div class="custom-control custom-checkbox custom-control-inline mr-2">

<input type="checkbox" class="custom-control-input" id="pco">

<label class="custom-control-label text-nowrap" for="pco">PCO</label>

</div>

</div>

</div>

</div>

<div class="modal-footer">

<button type="button" class="btn btn-primary btn-sm" id="nonrhsavebutton" >Ok</button>

<button type="button" class="btn btn-secondary btn-sm" data-dismiss="modal">Cancel</button>

</div>

</div>

</div>

</div>		
					
	<div class="modal fade" id="movementauthorities" tabindex="-1" role="dialog" aria-hidden="true">
							<div class="modal-dialog modal-dialog-centered modal-lg" role="document">
								<div class="modal-content">
									<div class="modal-header pt-3 pb-2">
										<h6 class="modal-title">Movement Authorization</h6>
										<button type="button" class="close" data-dismiss="modal" aria-label="Close">
											<span aria-hidden="true"><i class="fal fa-times"></i></span>
										</button>
									</div>
									<div class="modal-body py-0">
										<p class="text-primary mb-2">The movement of this offender is restricted. This movement requires approval from shift Commander or above.</p>
										<h6 class="mx-0 mb-0 text-nowrap headerBlock text-center" style="font-weight: 600;">FORWARD FOR APPROVAL</h6>
										<div class="d-flex align-items-center mt-1">
											<div class="custom-control custom-checkbox custom-control-inline mr-2">
												<input type="checkbox" class="custom-control-input" id="ForwardCheck">
												<label class="custom-control-label text-nowrap" for="ForwardCheck">Forward</label>
											</div>
											<div class="d-flex align-items-center position-relative">
												<label for="weight" class="form-label mb-0 mr-2 text-nowrap">Forward To</label>																					
												<select class="custom-select form-control" style="width: 230px;" id="userFullNameDropdown">
													<option></option>		
													<i class="fa fa-users"></i>											
												</select>
											</div>
											<div class="d-flex align-items-center ml-2">
												<label for="weight" class="form-label mb-0 mr-2 text-nowrap">Movement Reason</label>																					
												<select class="custom-select form-control" style="width: 230px;" id="movementReasonsDropdown">
													<option></option>													
												</select>
											</div>
										</div>
										<div class="mt-1">
											<textarea class="form-control" id="addComments" placeholder="Comments" rows="3" name="Comments" aria-label="Comments" style="resize:none;" value=""></textarea>
										</div>
										<div class="d-flex align-items-center my-1">
											<div class="d-flex align-items-center mr-2">
												<label for="weight" class="form-label mb-0 mr-2 text-nowrap">Forward By</label>																					
												<input type="text" class="form-control w-100" aria-label="forwardByDisplay" name="forwardByDisplay" id="forwardByDisplay" value=""  style="min-width: 200px;">
											</div>
											<div class="d-flex align-items-center mr-2">
												<label for="weight" class="form-label mb-0 mr-2 text-nowrap">Forward Date</label>																					
												<input type="text" class="form-control w-100" aria-label="forwardByDdate" name="forwardByDdate" id="forwardByDdate" value=""  style="min-width: 80px;">
											</div>
											<div class="d-flex align-items-center mr-2">
												<label for="weight" class="form-label mb-0 mr-2 text-nowrap">Time</label>																					
												<input type="text" class="form-control w-100" aria-label="forwardByTime" name="forwardByTime" id="forwardByTime" value="" style="min-width: 80px;">
											</div>
										</div>
										<h6 class="mx-0 mb-0 text-nowrap headerBlock text-center" style="font-weight: 600;">APPROVAL</h6>
										<div class="d-flex my-1 mr-2">
                                            <div class="custom-control custom-radio mr-2">
                                                <input type="radio" class="custom-control-input" id="ApprovalcheckedRadio" name="defaultExampleRadios" disabled>
                                                <label class="custom-control-label" for="ApprovalcheckedRadio">Approval</label>
                                            </div>
                                            <div class="custom-control custom-radio mr-2">
                                                <input type="radio" class="custom-control-input" id="DisapprovalCheckedRadio" name="defaultExampleRadios" disabled>
                                                <label class="custom-control-label" for="DisapprovalCheckedRadio">Disapproval</label>
                                            </div>
											<div class="d-flex align-items-center mr-2" style="width: 300px;">
												<label for="weight" class="form-label mb-0 mr-2 text-nowrap">Approved By</label>																					
												<input type="text" class="form-control" aria-label="weight" name="weight" id="weight" value="" disabled>
											</div>
											<div class="d-flex align-items-center" style="width: 200px;">
												<label for="weight" class="form-label mb-0 mr-2 text-nowrap">Password</label>																					
												<input type="text" class="form-control" aria-label="weight" name="weight" id="weight" value="" disabled>
											</div>
										</div>
										<div class="d-flex my-2 mr-2">
											<div class="d-flex align-items-center mr-2" style="width: 190px;">
												<label for="weight" class="form-label mb-0 mr-2 text-nowrap">Approval Date</label>																					
												<input type="text" class="form-control" aria-label="weight" name="weight" id="weight" value="" disabled>
											</div>
											<div class="d-flex align-items-center" style="width: 140px;">
												<label for="weight" class="form-label mb-0 mr-2 text-nowrap">Time</label>																					
												<input type="text" class="form-control" aria-label="weight" name="weight" id="weight" value="" disabled>
											</div>
											<div class="d-flex align-items-center ml-2" style="width: 350px;">
												<label for="weight" class="form-label mb-0 mr-2 text-nowrap">Disapprove Reason</label>																				
												<select class="custom-select form-control" id="disapproveReasonsDropdown" disabled>
													<option></option>												
												</select>
											</div>
										</div>
										<div class="my-1">
											<textarea class="form-control" id="addComments" placeholder="Comments" rows="3" name="Comments" aria-label="Comments" style="resize:none;" value=""></textarea>
										</div>
										<h6 class="mx-0 mb-0 text-nowrap headerBlock text-center" style="font-weight: 600;">NO CONTACT DETAILS</h6>
										<div id="table-container">
											<div class="tableFixHead" style="max-height: 150px;">
											  <table id="" class="table table-striped table-bordered table-sm" disabled>
												    <thead>
													    <tr>
															<th style="width: 100px;">SBI#</th>
															<th>First Name</th>
															<th>Last Name</th>
															<th style="width: 50px;">MI</th>
															<th style="width: 100px;">Date</th>
															<th>Type</th>
														</tr>
												    </thead>
												   <tbody id="enemy-table-body">
														<tr class="disabletd">
															<td style="width: 100px;">
																<input type="text" class="form-control" aria-label="fname" name="fname" id="fname" value="">
															</td>
															<td>
																<input type="text" class="form-control" aria-label="fname" name="fname" id="fname" value="">
															</td>
															<td>
																<input type="text" class="form-control" aria-label="fname" name="fname" id="fname" value="">
															</td>
															<td style="width: 50px;">
																<input type="text" class="form-control" aria-label="fname" name="fname" id="fname" value="">
															</td>
															<td style="width: 100px;">
																<input type="text" class="form-control" aria-label="fname" name="fname" id="fname" value="">
															</td>
															<td>
																<input type="text" class="form-control" aria-label="fname" name="fname" id="fname" value="">
															</td>
														</tr>
														<tr class="disabletd">
															<td style="width: 100px;">
																<input type="text" class="form-control" aria-label="fname" name="fname" id="fname" value="">
															</td>
															<td>
																<input type="text" class="form-control" aria-label="fname" name="fname" id="fname" value="">
															</td>
															<td>
																<input type="text" class="form-control" aria-label="fname" name="fname" id="fname" value="">
															</td>
															<td style="width: 50px;">
																<input type="text" class="form-control" aria-label="fname" name="fname" id="fname" value="">
															</td>
															<td style="width: 100px;">
																<input type="text" class="form-control" aria-label="fname" name="fname" id="fname" value="">
															</td>
															<td>
																<input type="text" class="form-control" aria-label="fname" name="fname" id="fname" value="">
															</td>
														</tr>
													</tbody>
												</table>
											</div>
										</div>
										
									</div>
									<div class="modal-footer">
										<button type="button" class="btn btn-primary btn-sm" id="movementassignmentokk" >Ok</button>
										<button type="button" class="btn btn-secondary btn-sm" data-dismiss="modal">Cancel</button>
									</div>
								</div>
							</div>
						</div>				
					
					
				</main>
				<!-- this overlay is activated only when mobile menu is triggered -->
				<div class="page-content-overlay" data-action="toggle" data-class="mobile-nav-on"></div>
				<!-- END Page Content -->
				
				<!-- Modal Large -->
				<div class="modal fade" id="default-example-modal-lg" tabindex="-1" role="dialog" aria-hidden="true">
					<div class="modal-dialog modal-lg" role="document">
						<div class="modal-content">
							<div class="modal-header">
								<h5 class="modal-title">Staff Name</h5>
								<button type="button" class="close" data-dismiss="modal" aria-label="Close">
									<span aria-hidden="true"><i class="fal fa-times"></i></span>
								</button>
							</div>
							<div class="modal-body">
								<div class="form-group row">
									<label for="staffSearch"
										class="col-form-label col-12 col-lg-1 form-label">Search</label>
									<div class="col-12 col-lg-11">
										<input type="text" class="form-control" aria-label="staffSearch"
											name="staffSearch" id="staffSearch" value="">
									</div>

								</div>
								<div class="table-responsive-lg">
									<table class="table table-bordered m-0">
										<thead>
											<tr>
												<th>Last Name</th>
												<th>First Name</th>
												<th>MI</th>
												<th>Suffix</th>
											</tr>
										</thead>
										<tbody>
											<tr>
												<td>14</td>
												<td>Staff</td>
												<td></td>
												<td></td>
											</tr>
											<tr>
												<td>14</td>
												<td>Staff</td>
												<td></td>
												<td></td>
											</tr>
											<tr>
												<td>14</td>
												<td>Staff</td>
												<td></td>
												<td></td>
											</tr>
											<tr>
												<td>14</td>
												<td>Staff</td>
												<td></td>
												<td></td>
											</tr>
											<tr>
												<td>14</td>
												<td>Staff</td>
												<td></td>
												<td></td>
											</tr>

										</tbody>
									</table>
								</div>
							</div>

						</div>
					</div>
				</div>
				<!-- BEGIN Shortcuts -->
				<!-- modal shortcut -->
				<div class="modal fade modal-backdrop-transparent" id="modal-shortcut" tabindex="-1" role="dialog"
					aria-labelledby="modal-shortcut" aria-hidden="true">
					<div class="modal-dialog modal-dialog-top modal-transparent" role="document">
						<div class="modal-content">
							<div class="modal-body">
								<ul class="app-list w-auto h-auto p-0 text-left">
									<li>
										<a href="intel_introduction.html" class="app-list-item text-white border-0 m-0">
											<div class="icon-stack">
												<i class="base base-7 icon-stack-3x opacity-100 color-primary-500 "></i>
												<i class="base base-7 icon-stack-2x opacity-100 color-primary-300 "></i>
												<i class="fal fa-home icon-stack-1x opacity-100 color-white"></i>
											</div>
											<span class="app-list-name">
												Home
											</span>
										</a>
									</li>
									<li>
										<a href="page_inbox_general.html" class="app-list-item text-white border-0 m-0">
											<div class="icon-stack">
												<i class="base base-7 icon-stack-3x opacity-100 color-success-500 "></i>
												<i class="base base-7 icon-stack-2x opacity-100 color-success-300 "></i>
												<i class="ni ni-envelope icon-stack-1x text-white"></i>
											</div>
											<span class="app-list-name">
												Inbox
											</span>
										</a>
									</li>
									<li>
										<a href="intel_introduction.html" class="app-list-item text-white border-0 m-0">
											<div class="icon-stack">
												<i class="base base-7 icon-stack-2x opacity-100 color-primary-300 "></i>
												<i class="fal fa-plus icon-stack-1x opacity-100 color-white"></i>
											</div>
											<span class="app-list-name">
												Add More
											</span>
										</a>
									</li>
								</ul>
							</div>
						</div>
					</div>
				</div> <!-- END Shortcuts -->
			</div>
		</div>
	</div>
	<!-- END Page Wrapper -->
	<!-- BEGIN Quick Menu -->
	<!-- to add more items, please make sure to change the variable '$menu-items: number;' in your _page-components-shortcut.scss -->
	<nav class="shortcut-menu d-none d-sm-block"> <input

		type="checkbox" class="menu-open" name="menu-open" id="menu_open" />

	<label for="menu_open" class="menu-open-button "> <span

		class="app-shortcut-icon d-block"></span>

	</label> <a href="#" class="menu-item btn" data-toggle="tooltip"

		data-placement="left" title="Scroll Top"> <i

		class="fal fa-arrow-up"></i>

	</a> <a href="page_login-alt.html" class="menu-item btn"

		data-toggle="tooltip" data-placement="left" title="Logout"> <i

		class="fal fa-sign-out"></i>

	</a> <a href="#" class="menu-item btn" data-action="app-fullscreen"

		data-toggle="tooltip" data-placement="left" title="Full Screen"> <i

		class="fal fa-expand"></i>

	</a> <a href="#" class="menu-item btn" data-action="app-print"

		data-toggle="tooltip" data-placement="left" title="Print page"> <i

		class="fal fa-print"></i>

	</a> <a href="#" class="menu-item btn" data-action="app-voice"

		data-toggle="tooltip" data-placement="left" title="Voice command">

		<i class="fal fa-microphone"></i>

	</a> </nav>
	<!-- END Quick Menu -->
	<!-- BEGIN Messenger -->
	<div class="modal fade js-modal-messenger modal-backdrop-transparent" tabindex="-1" role="dialog"
		aria-hidden="true">
		<div class="modal-dialog modal-dialog-right">
			<div class="modal-content h-100">
				<div class="dropdown-header bg-trans-gradient d-flex align-items-center w-100">
					<div class="d-flex flex-row align-items-center mt-1 mb-1 color-white">
						<span class="mr-2">
							<span class="rounded-circle profile-image d-block"
								style="background-image:url('img/demo/avatars/avatar-d.png'); background-size: cover;"></span>
						</span>
						<div class="info-card-text">
							<a href="javascript:void(0);" class="fs-lg text-truncate text-truncate-lg text-white"
								data-toggle="dropdown" aria-expanded="false">
								Tracey Chang
								<i class="fal fa-angle-down d-inline-block ml-1 text-white fs-md"></i>
							</a>
							<div class="dropdown-menu">
								<a class="dropdown-item" href="#">Send Email</a>
								<a class="dropdown-item" href="#">Create Appointment</a>
								<a class="dropdown-item" href="#">Block User</a>
							</div>
							<span class="text-truncate text-truncate-md opacity-80">IT Director</span>
						</div>
					</div>
					<button type="button" class="close text-white position-absolute pos-top pos-right p-2 m-1 mr-2"
						data-dismiss="modal" aria-label="Close">
						<span aria-hidden="true"><i class="fal fa-times"></i></span>
					</button>
				</div>
				<div class="modal-body p-0 h-100 d-flex">
					<!-- BEGIN msgr-list -->
					<div
						class="msgr-list d-flex flex-column bg-faded border-faded border-top-0 border-right-0 border-bottom-0 position-absolute pos-top pos-bottom">
						<div>
							<div
								class="height-4 width-3 h3 m-0 d-flex justify-content-center flex-column color-primary-500 pl-3 mt-2">
								<i class="fal fa-search"></i>
							</div>
							<input type="text" class="form-control bg-white" id="msgr_listfilter_input"
								name="msgr_listfilter_input" placeholder="Filter contacts" aria-label="FilterSearch"
								value="" data-listfilter="#js-msgr-listfilter">
						</div>
						<div class="flex-1 h-100 custom-scroll">
							<div class="w-100">
								<ul id="js-msgr-listfilter" class="list-unstyled m-0">
									<li>
										<a href="#" class="d-table w-100 px-2 py-2 text-dark hover-white"
											data-filter-tags="tracey chang online">
											<div class="d-table-cell align-middle status status-success status-sm ">
												<span class="profile-image-md rounded-circle d-block"
													style="background-image:url('img/demo/avatars/avatar-d.png'); background-size: cover;"></span>
											</div>
											<div class="d-table-cell w-100 align-middle pl-2 pr-2">
												<div class="text-truncate text-truncate-md">
													Tracey Chang
													<small class="d-block font-italic text-success fs-xs">
														Online
													</small>
												</div>
											</div>
										</a>
									</li>
									<li>
										<a href="#" class="d-table w-100 px-2 py-2 text-dark hover-white"
											data-filter-tags="oliver kopyuv online">
											<div class="d-table-cell align-middle status status-success status-sm ">
												<span class="profile-image-md rounded-circle d-block"
													style="background-image:url('img/demo/avatars/avatar-b.png'); background-size: cover;"></span>
											</div>
											<div class="d-table-cell w-100 align-middle pl-2 pr-2">
												<div class="text-truncate text-truncate-md">
													Oliver Kopyuv
													<small class="d-block font-italic text-success fs-xs">
														Online
													</small>
												</div>
											</div>
										</a>
									</li>
									<li>
										<a href="#" class="d-table w-100 px-2 py-2 text-dark hover-white"
											data-filter-tags="dr john cook phd away">
											<div class="d-table-cell align-middle status status-warning status-sm ">
												<span class="profile-image-md rounded-circle d-block"
													style="background-image:url('img/demo/avatars/avatar-e.png'); background-size: cover;"></span>
											</div>
											<div class="d-table-cell w-100 align-middle pl-2 pr-2">
												<div class="text-truncate text-truncate-md">
													Dr. John Cook PhD
													<small class="d-block font-italic fs-xs">
														Away
													</small>
												</div>
											</div>
										</a>
									</li>
									<li>
										<a href="#" class="d-table w-100 px-2 py-2 text-dark hover-white"
											data-filter-tags="ali amdaney online">
											<div class="d-table-cell align-middle status status-success status-sm ">
												<span class="profile-image-md rounded-circle d-block"
													style="background-image:url('img/demo/avatars/avatar-g.png'); background-size: cover;"></span>
											</div>
											<div class="d-table-cell w-100 align-middle pl-2 pr-2">
												<div class="text-truncate text-truncate-md">
													Ali Amdaney
													<small class="d-block font-italic fs-xs text-success">
														Online
													</small>
												</div>
											</div>
										</a>
									</li>
									<li>
										<a href="#" class="d-table w-100 px-2 py-2 text-dark hover-white"
											data-filter-tags="sarah mcbrook online">
											<div class="d-table-cell align-middle status status-success status-sm">
												<span class="profile-image-md rounded-circle d-block"
													style="background-image:url('img/demo/avatars/avatar-h.png'); background-size: cover;"></span>
											</div>
											<div class="d-table-cell w-100 align-middle pl-2 pr-2">
												<div class="text-truncate text-truncate-md">
													Sarah McBrook
													<small class="d-block font-italic fs-xs text-success">
														Online
													</small>
												</div>
											</div>
										</a>
									</li>
									<li>
										<a href="#" class="d-table w-100 px-2 py-2 text-dark hover-white"
											data-filter-tags="ali amdaney offline">
											<div class="d-table-cell align-middle status status-sm">
												<span class="profile-image-md rounded-circle d-block"
													style="background-image:url('img/demo/avatars/avatar-a.png'); background-size: cover;"></span>
											</div>
											<div class="d-table-cell w-100 align-middle pl-2 pr-2">
												<div class="text-truncate text-truncate-md">
													oliver.kopyuv@gotbootstrap.com
													<small class="d-block font-italic fs-xs">
														Offline
													</small>
												</div>
											</div>
										</a>
									</li>
									<li>
										<a href="#" class="d-table w-100 px-2 py-2 text-dark hover-white"
											data-filter-tags="ali amdaney busy">
											<div class="d-table-cell align-middle status status-danger status-sm">
												<span class="profile-image-md rounded-circle d-block"
													style="background-image:url('img/demo/avatars/avatar-j.png'); background-size: cover;"></span>
											</div>
											<div class="d-table-cell w-100 align-middle pl-2 pr-2">
												<div class="text-truncate text-truncate-md">
													oliver.kopyuv@gotbootstrap.com
													<small class="d-block font-italic fs-xs text-danger">
														Busy
													</small>
												</div>
											</div>
										</a>
									</li>
									<li>
										<a href="#" class="d-table w-100 px-2 py-2 text-dark hover-white"
											data-filter-tags="ali amdaney offline">
											<div class="d-table-cell align-middle status status-sm">
												<span class="profile-image-md rounded-circle d-block"
													style="background-image:url('img/demo/avatars/avatar-c.png'); background-size: cover;"></span>
											</div>
											<div class="d-table-cell w-100 align-middle pl-2 pr-2">
												<div class="text-truncate text-truncate-md">
													oliver.kopyuv@gotbootstrap.com
													<small class="d-block font-italic fs-xs">
														Offline
													</small>
												</div>
											</div>
										</a>
									</li>
									<li>
										<a href="#" class="d-table w-100 px-2 py-2 text-dark hover-white"
											data-filter-tags="ali amdaney inactive">
											<div class="d-table-cell align-middle">
												<span class="profile-image-md rounded-circle d-block"
													style="background-image:url('img/demo/avatars/avatar-m.png'); background-size: cover;"></span>
											</div>
											<div class="d-table-cell w-100 align-middle pl-2 pr-2">
												<div class="text-truncate text-truncate-md">
													+714651347790
													<small class="d-block font-italic fs-xs opacity-50">
														Missed Call
													</small>
												</div>
											</div>
										</a>
									</li>
								</ul>
								<div class="filter-message js-filter-message"></div>
							</div>
						</div>
						<div>
							<a class="fs-xl d-flex align-items-center p-3">
								<i class="fal fa-cogs"></i>
							</a>
						</div>
					</div>
					<!-- END msgr-list -->
					<!-- BEGIN msgr -->
					<div class="msgr d-flex h-100 flex-column bg-white">
						<!-- BEGIN custom-scroll -->
						<div class="custom-scroll flex-1 h-100">
							<div id="chat_container" class="w-100 p-4">
								<!-- start .chat-segment -->
								<div class="chat-segment">
									<div class="time-stamp text-center mb-2 fw-400">
										Jun 19
									</div>
								</div>
								<!--  end .chat-segment -->
								<!-- start .chat-segment -->
								<div class="chat-segment chat-segment-sent">
									<div class="chat-message">
										<p>
											Hey Ching, did you get my files?
										</p>
									</div>
									<div class="text-right fw-300 text-muted mt-1 fs-xs">
										3:00 pm
									</div>
								</div>
								<!--  end .chat-segment -->
								<!-- start .chat-segment -->
								<div class="chat-segment chat-segment-get">
									<div class="chat-message">
										<p>
											Hi
										</p>
										<p>
											Sorry going through a busy time in office. Yes I analyzed the solution.
										</p>
										<p>
											It will require some resource, which I could not manage.
										</p>
									</div>
									<div class="fw-300 text-muted mt-1 fs-xs">
										3:24 pm
									</div>
								</div>
								<!--  end .chat-segment -->
								<!-- start .chat-segment -->
								<div class="chat-segment chat-segment-sent chat-start">
									<div class="chat-message">
										<p>
											Okay
										</p>
									</div>
								</div>
								<!--  end .chat-segment -->
								<!-- start .chat-segment -->
								<div class="chat-segment chat-segment-sent chat-end">
									<div class="chat-message">
										<p>
											Sending you some dough today, you can allocate the resources to this
											project.
										</p>
									</div>
									<div class="text-right fw-300 text-muted mt-1 fs-xs">
										3:26 pm
									</div>
								</div>
								<!--  end .chat-segment -->
								<!-- start .chat-segment -->
								<div class="chat-segment chat-segment-get chat-start">
									<div class="chat-message">
										<p>
											Perfect. Thanks a lot!
										</p>
									</div>
								</div>
								<!--  end .chat-segment -->
								<!-- start .chat-segment -->
								<div class="chat-segment chat-segment-get">
									<div class="chat-message">
										<p>
											I will have them ready by tonight.
										</p>
									</div>
								</div>
								<!--  end .chat-segment -->
								<!-- start .chat-segment -->
								<div class="chat-segment chat-segment-get chat-end">
									<div class="chat-message">
										<p>
											Cheers
										</p>
									</div>
								</div>
								<!--  end .chat-segment -->
								<!-- start .chat-segment for timestamp -->
								<div class="chat-segment">
									<div class="time-stamp text-center mb-2 fw-400">
										Jun 20
									</div>
								</div>
								<!--  end .chat-segment for timestamp -->
							</div>
						</div>
						<!-- END custom-scroll  -->
						<!-- BEGIN msgr__chatinput -->
						<div class="d-flex flex-column">
							<div
								class="border-faded border-right-0 border-bottom-0 border-left-0 flex-1 mr-3 ml-3 position-relative shadow-top">
								<div class="pt-3 pb-1 pr-0 pl-0 rounded-0" tabindex="-1">
									<div id="msgr_input" contenteditable="true"
										data-placeholder="Type your message here..."
										class="height-10 form-content-editable"></div>
								</div>
							</div>
							<div class="height-8 px-3 d-flex flex-row align-items-center flex-wrap flex-shrink-0">
								<a href="javascript:void(0);" class="btn btn-icon fs-xl width-1 mr-1"
									data-toggle="tooltip" data-original-title="More options" data-placement="top">
									<i class="fal fa-ellipsis-v-alt color-fusion-300"></i>
								</a>
								<a href="javascript:void(0);" class="btn btn-icon fs-xl mr-1" data-toggle="tooltip"
									data-original-title="Attach files" data-placement="top">
									<i class="fal fa-paperclip color-fusion-300"></i>
								</a>
								<a href="javascript:void(0);" class="btn btn-icon fs-xl mr-1" data-toggle="tooltip"
									data-original-title="Insert photo" data-placement="top">
									<i class="fal fa-camera color-fusion-300"></i>
								</a>
								<div class="ml-auto">
									<a href="javascript:void(0);" class="btn btn-info">Send</a>
								</div>
							</div>
						</div>
						<!-- END msgr__chatinput -->
					</div>
					<!-- END msgr -->
				</div>
			</div>
		</div>
	</div>
	<!-- END Messenger -->
	<!-- BEGIN Page Settings -->
	<div class="modal fade js-modal-settings modal-backdrop-transparent" tabindex="-1" role="dialog" aria-hidden="true">
		<div class="modal-dialog modal-dialog-right modal-md">
			<div class="modal-content">
				<div class="dropdown-header bg-trans-gradient d-flex justify-content-center align-items-center w-100">
					<h4 class="m-0 text-center color-white">
						Layout Settings
						<small class="mb-0 opacity-80">User Interface Settings</small>
					</h4>
					<button type="button" class="close text-white position-absolute pos-top pos-right p-2 m-1 mr-2"
						data-dismiss="modal" aria-label="Close">
						<span aria-hidden="true"><i class="fal fa-times"></i></span>
					</button>
				</div>
				<div class="modal-body p-0">
					<div class="settings-panel">
						<div class="mt-4 d-table w-100 px-5">
							<div class="d-table-cell align-middle">
								<h5 class="p-0">
									App Layout
								</h5>
							</div>
						</div>
						<div class="list" id="fh">
							<a href="#" onclick="return false;" class="btn btn-switch" data-action="toggle"
								data-class="header-function-fixed"></a>
							<span class="onoffswitch-title">Fixed Header</span>
							<span class="onoffswitch-title-desc">header is in a fixed at all times</span>
						</div>
						<div class="list" id="nff">
							<a href="#" onclick="return false;" class="btn btn-switch" data-action="toggle"
								data-class="nav-function-fixed"></a>
							<span class="onoffswitch-title">Fixed Navigation</span>
							<span class="onoffswitch-title-desc">left panel is fixed</span>
						</div>
						<div class="list" id="nfm">
							<a href="#" onclick="return false;" class="btn btn-switch" data-action="toggle"
								data-class="nav-function-minify"></a>
							<span class="onoffswitch-title">Minify Navigation</span>
							<span class="onoffswitch-title-desc">Skew nav to maximize space</span>
						</div>
						<div class="list" id="nfh">
							<a href="#" onclick="return false;" class="btn btn-switch" data-action="toggle"
								data-class="nav-function-hidden"></a>
							<span class="onoffswitch-title">Hide Navigation</span>
							<span class="onoffswitch-title-desc">roll mouse on edge to reveal</span>
						</div>
						<div class="list" id="nft">
							<a href="#" onclick="return false;" class="btn btn-switch" data-action="toggle"
								data-class="nav-function-top"></a>
							<span class="onoffswitch-title">Top Navigation</span>
							<span class="onoffswitch-title-desc">Relocate left pane to top</span>
						</div>
						<div class="list" id="mmb">
							<a href="#" onclick="return false;" class="btn btn-switch" data-action="toggle"
								data-class="mod-main-boxed"></a>
							<span class="onoffswitch-title">Boxed Layout</span>
							<span class="onoffswitch-title-desc">Encapsulates to a container</span>
						</div>
						<div class="expanded">
							<ul class="">
								<li>
									<div class="bg-fusion-50" data-action="toggle" data-class="mod-bg-1"></div>
								</li>
								<li>
									<div class="bg-warning-200" data-action="toggle" data-class="mod-bg-2"></div>
								</li>
								<li>
									<div class="bg-primary-200" data-action="toggle" data-class="mod-bg-3"></div>
								</li>
								<li>
									<div class="bg-success-300" data-action="toggle" data-class="mod-bg-4"></div>
								</li>
							</ul>
							<div class="list" id="mbgf">
								<a href="#" onclick="return false;" class="btn btn-switch" data-action="toggle"
									data-class="mod-fixed-bg"></a>
								<span class="onoffswitch-title">Fixed Background</span>
							</div>
						</div>
						<!-- <div class="mt-4 d-table w-100 px-5">
                            <div class="d-table-cell align-middle">
                                <h5 class="p-0">
                                    Mobile Menu
                                </h5>
                            </div>
                        </div>
                        <div class="list" id="nmp">
                            <a href="#" onclick="return false;" class="btn btn-switch" data-action="toggle"
                                data-class="nav-mobile-push"></a>
                            <span class="onoffswitch-title">Push Content</span>
                            <span class="onoffswitch-title-desc">Content pushed on menu reveal</span>
                        </div>
                        <div class="list" id="nmno">
                            <a href="#" onclick="return false;" class="btn btn-switch" data-action="toggle"
                                data-class="nav-mobile-no-overlay"></a>
                            <span class="onoffswitch-title">No Overlay</span>
                            <span class="onoffswitch-title-desc">Removes mesh on menu reveal</span>
                        </div>
                        <div class="list" id="sldo">
                            <a href="#" onclick="return false;" class="btn btn-switch" data-action="toggle"
                                data-class="nav-mobile-slide-out"></a>
                            <span class="onoffswitch-title">Off-Canvas <sup>(beta)</sup></span>
                            <span class="onoffswitch-title-desc">Content overlaps menu</span>
                        </div> -->
						<div class="mt-4 d-table w-100 px-5">
							<div class="d-table-cell align-middle">
								<h5 class="p-0">
									Accessibility
								</h5>
							</div>
						</div>
						<div class="list" id="mbf">
							<a href="#" onclick="return false;" class="btn btn-switch" data-action="toggle"
								data-class="mod-bigger-font"></a>
							<span class="onoffswitch-title">Bigger Content Font</span>
							<span class="onoffswitch-title-desc">content fonts are bigger for readability</span>
						</div>
						<div class="list" id="mhc">
							<a href="#" onclick="return false;" class="btn btn-switch" data-action="toggle"
								data-class="mod-high-contrast"></a>
							<span class="onoffswitch-title">High Contrast Text (WCAG 2 AA)</span>
							<span class="onoffswitch-title-desc">4.5:1 text contrast ratio</span>
						</div>
						<div class="list" id="mcb">
							<a href="#" onclick="return false;" class="btn btn-switch" data-action="toggle"
								data-class="mod-color-blind"></a>
							<span class="onoffswitch-title">Daltonism <sup>(beta)</sup> </span>
							<span class="onoffswitch-title-desc">color vision deficiency</span>
						</div>
						<div class="list" id="mpc">
							<a href="#" onclick="return false;" class="btn btn-switch" data-action="toggle"
								data-class="mod-pace-custom"></a>
							<span class="onoffswitch-title">Preloader Inside</span>
							<span class="onoffswitch-title-desc">preloader will be inside content</span>
						</div>
						<div class="mt-4 d-table w-100 px-5">
							<div class="d-table-cell align-middle">
								<h5 class="p-0">
									Global Modifications
								</h5>
							</div>
						</div>
						<div class="list" id="mcbg">
							<a href="#" onclick="return false;" class="btn btn-switch" data-action="toggle"
								data-class="mod-clean-page-bg"></a>
							<span class="onoffswitch-title">Clean Page Background</span>
							<span class="onoffswitch-title-desc">adds more whitespace</span>
						</div>
						<div class="list" id="mhni">
							<a href="#" onclick="return false;" class="btn btn-switch" data-action="toggle"
								data-class="mod-hide-nav-icons"></a>
							<span class="onoffswitch-title">Hide Navigation Icons</span>
							<span class="onoffswitch-title-desc">invisible navigation icons</span>
						</div>
						<div class="list" id="dan">
							<a href="#" onclick="return false;" class="btn btn-switch" data-action="toggle"
								data-class="mod-disable-animation"></a>
							<span class="onoffswitch-title">Disable CSS Animation</span>
							<span class="onoffswitch-title-desc">Disables CSS based animations</span>
						</div>
						<div class="list" id="mhic">
							<a href="#" onclick="return false;" class="btn btn-switch" data-action="toggle"
								data-class="mod-hide-info-card"></a>
							<span class="onoffswitch-title">Hide Info Card</span>
							<span class="onoffswitch-title-desc">Hides info card from left panel</span>
						</div>
						<div class="list" id="mlph">
							<a href="#" onclick="return false;" class="btn btn-switch" data-action="toggle"
								data-class="mod-lean-subheader"></a>
							<span class="onoffswitch-title">Lean Subheader</span>
							<span class="onoffswitch-title-desc">distinguished page header</span>
						</div>
						<div class="list" id="mnl">
							<a href="#" onclick="return false;" class="btn btn-switch" data-action="toggle"
								data-class="mod-nav-link"></a>
							<span class="onoffswitch-title">Hierarchical Navigation</span>
							<span class="onoffswitch-title-desc">Clear breakdown of nav links</span>
						</div>
						<div class="list mt-1">
							<span class="onoffswitch-title">Global Font Size <small>(RESETS ON REFRESH)</small> </span>
							<div class="btn-group btn-group-sm btn-group-toggle my-2" data-toggle="buttons">
								<label for="smRadio" class="btn btn-default btn-sm" data-action="toggle-swap"
									data-class="root-text-sm" data-target="html">
									<input type="radio" aria-label="smRadio" name="smRadio" id="smRadio" value=""> SM
								</label>
								<label for="mdRadio" class="btn btn-default btn-sm" data-action="toggle-swap"
									data-class="root-text" data-target="html">
									<input type="radio" aria-label="mdRadio" name="mdRadio" id="mdRadio" value=""
										checked=""> MD
								</label>
								<label for="lgRadio" class="btn btn-default btn-sm" data-action="toggle-swap"
									data-class="root-text-lg" data-target="html">
									<input type="radio" aria-label="lgRadio" name="lgRadio" id="lgRadio" value=""> LG
								</label>
								<label for="xlRadio" class="btn btn-default btn-sm" data-action="toggle-swap"
									data-class="root-text-xl" data-target="html">
									<input type="radio" aria-label="xlRadio" name="xlRadio" id="xlRadio" value=""> XL
								</label>
							</div>
							<span class="onoffswitch-title-desc d-block mb-g">Change <strong>root</strong> font size to
								effect rem values</span>
						</div>
						<div class="mt-2 d-table w-100 pl-5 pr-3">
							<div class="d-table-cell align-middle">
								<h5 class="p-0">
									Theme colors <small>(overlays base css)</small>
								</h5>
								<!-- <div class="fs-xs text-muted p-2 alert alert-warning mt-3 mb-0">
                                    <i class="fal fa-exclamation-triangle text-warning mr-2"></i>Due to network latency
                                    and CPU utilization, you may experience a brief flickering effect on page load which
                                    may show the intial applied theme for a split second. Setting the prefered
                                    style/theme in the header will prevent this from happening.
                                </div> -->
							</div>
						</div>
						<div class="expanded theme-colors pl-5 pr-3">
							<ul class="m-0">
								<li><a href="#" id="myapp-0" data-action="theme-update" data-themesave data-theme=""
										data-toggle="tooltip" data-placement="top" title="Wisteria (base css)"
										data-original-title="Wisteria (base css)"></a></li>
								<li><a href="#" id="myapp-1" data-action="theme-update" data-themesave
										data-theme="css/themes/cust-theme-1.css" data-toggle="tooltip"
										data-placement="top" title="Tapestry" data-original-title="Tapestry"></a></li>
								<li><a href="#" id="myapp-2" data-action="theme-update" data-themesave
										data-theme="css/themes/cust-theme-2.css" data-toggle="tooltip"
										data-placement="top" title="Atlantis" data-original-title="Atlantis"></a></li>
								<li><a href="#" id="myapp-3" data-action="theme-update" data-themesave
										data-theme="css/themes/cust-theme-3.css" data-toggle="tooltip"
										data-placement="top" title="Indigo" data-original-title="Indigo"></a></li>
								<li><a href="#" id="myapp-4" data-action="theme-update" data-themesave
										data-theme="css/themes/cust-theme-4.css" data-toggle="tooltip"
										data-placement="top" title="Dodger Blue" data-original-title="Dodger Blue"></a>
								</li>
								<li><a href="#" id="myapp-5" data-action="theme-update" data-themesave 
										data-theme="css/themes/cust-theme-5.css" data-toggle="tooltip"
										data-placement="top" title="Tradewind" data-original-title="Tradewind"></a></li>
								<li><a href="#" id="myapp-6" data-action="theme-update" data-themesave
										data-theme="css/themes/cust-theme-6.css" data-toggle="tooltip"
										data-placement="top" title="Cranberry" data-original-title="Cranberry"></a></li>
								<li><a href="#" id="myapp-7" data-action="theme-update" data-themesave
										data-theme="css/themes/cust-theme-7.css" data-toggle="tooltip"
										data-placement="top" title="Oslo Gray" data-original-title="Oslo Gray"></a></li>
								<li><a href="#" id="myapp-8" data-action="theme-update" data-themesave
										data-theme="css/themes/cust-theme-8.css" data-toggle="tooltip"
										data-placement="top" title="Chetwode Blue"
										data-original-title="Chetwode Blue"></a></li>
								<li><a href="#" id="myapp-9" data-action="theme-update" data-themesave
										data-theme="css/themes/cust-theme-9.css" data-toggle="tooltip"
										data-placement="top" title="Apricot" data-original-title="Apricot"></a></li>
								<li><a href="#" id="myapp-10" data-action="theme-update" data-themesave
										data-theme="css/themes/cust-theme-10.css" data-toggle="tooltip"
										data-placement="top" title="Blue Smoke" data-original-title="Blue Smoke"></a>
								</li>
								<li><a href="#" id="myapp-11" data-action="theme-update" data-themesave
										data-theme="css/themes/cust-theme-11.css" data-toggle="tooltip"
										data-placement="top" title="Green Smoke" data-original-title="Green Smoke"></a>
								</li>
								<li><a href="#" id="myapp-12" data-action="theme-update" data-themesave
										data-theme="css/themes/cust-theme-12.css" data-toggle="tooltip"
										data-placement="top" title="Wild Blue Yonder"
										data-original-title="Wild Blue Yonder"></a></li>
								<li><a href="#" id="myapp-13" data-action="theme-update" data-themesave
										data-theme="css/themes/cust-theme-13.css" data-toggle="tooltip"
										data-placement="top" title="Emerald" data-original-title="Emerald"></a></li>
							</ul>
						</div>
						<hr class="mb-0 mt-4">
						<div class="pl-5 pr-3 py-3 bg-faded">
							<div class="row no-gutters">
								<div class="col-6 pr-1">
									<a href="#" class="btn btn-outline-danger fw-500 btn-block"
										data-action="app-reset">Reset Settings</a>
								</div>
								<div class="col-6 pl-1">
									<a href="#" class="btn btn-danger fw-500 btn-block"
										data-action="factory-reset">Factory Reset</a>
								</div>
							</div>
						</div>
					</div>
					<span id="saving"></span>
				</div>
			</div>
		</div>
	</div>
	<!-- END Page Settings -->
	
	<div style="display:none">
		<form id="entryform">
			<input type="hidden" name="screenCode" id="screenCode" value="MOV_AOTB"> 
			
			<label forx="1" for="Building">Building</label>
			<input id="Building" name="Building" type="text" data-typ="Dropdown">
			
			<label forx="1" for="Wing_unit">Wing/Unit</label>
			<input id="Wing_unit" name="Wing_unit" type="text" data-typ="Dropdown">
			
			<label forx="1" for="Floor">Floor</label>
			<input id="Floor" name="Floor" type="text" data-typ="Dropdown">
			
			<label forx="1" for="Tier_Pod">Tier/Pod</label>
			<input id="Tier_Pod" name="Tier_Pod" type="text" data-typ="Dropdown">
			
			<label forx="1" for="Room_Cell">Room/Cell</label>
			<input id="Room_Cell" name="Room_Cell" type="text" data-typ="Dropdown">
			
			<label forx="1" for="all_beds">All Beds</label>
			<input type="text" id="all_beds" name="all_beds" data-typ="Radio">
			
			<label forx="1" for="unoccupied_beds">Unoccupied Beds</label>
			<input type="text" id="unoccupied_beds" name="unoccupied_beds" data-typ="Radio">
			
			<label forx="1" for="reserved_beds">Reserved Beds</label>
			<input type="text" id="reserved_beds" name="reserved_beds" data-typ="Radio">
			
			<label forx="1" for="occupied_bed">Occupied Beds</label>
			<input type="text" id="occupied_bed" name="occupied_bed" data-typ="Radio">
			
			<label forx="1" for="select_btn">Select</label>
			<input type="text" id="select_btn" name="select_btn" data-typ="Button">
			
			<label forx="1" for="Reason">Reason</label>
			<input id="Reason" name="Reason" type="text" data-typ="Dropdown">

			<label forx="1" for="start_dt">Start Date</label>
			<input type="text" id="start_dt" name="start_dt" data-typ="Date">
			
			<label forx="1" for="end_dt">End Date</label>
			<input type="text" id="end_dt" name="end_dt" data-typ="Date">
			
			<label forx="1" for="start_tm">Start Time</label>
			<input type="text" id="start_tm" name="start_tm" data-typ="Text">
			
			<label forx="1" for="end_tm">End Time</label>
			<input type="text" id="end_tm" name="end_tm" data-typ="Text">

			<label forx="1" for="sbi_no_aob">SBI#</label>
			<input type="text" id="sbi_no_aob" name="sbi_no_aob" data-typ="Text">
			
			<label forx="1" for="sbi_name_aob">SBI Name</label>
			<input type="text" id="sbi_name_aob" name="sbi_name_aob" data-typ="Text">
			
			<label forx="1" for="dob_aob">DOB</label>
			<input type="text" id="dob_aob" name="dob_aob" data-typ="Date">
			
			<label forx="1" for="sex_aob">Sex</label>
			<input type="text" id="sex_aob" name="sex_aob" data-typ="Text">
			
			<label forx="1" for="race_aob">Race</label>
			<input type="text" id="race_aob" name="race_aob" data-typ="Text">
			
			<label forx="1" for="release_dt_aob">Release Date</label>
			<input type="text" id="release_dt_aob" name="release_dt_aob" data-typ="Date">
			
			<label forx="1" for="rh_reason_aob">RH Reason</label>
			<input type="text" id="rh_reason_aob" name="rh_reason_aob" data-typ="Text">

			<label forx="1" for="show_housing_btn"> Show Housing Details</label>
			<input type="text" id="show_housing_btn" name="show_housing_btn" data-typ="Button">
			
			<label forx="1" for="protected_off_btn"> Protected Offender Details</label>
			<input type="text" id="protected_off_btn" name="protected_off_btn" data-typ="Button">
			
			<label forx="1" for="off_dtl_btn">Offender Details</label>
			<input type="text" id="off_dtl_btn" name="off_dtl_btn" data-typ="Button">
			
			<label forx="1" for="bed_dtl_btn">Bed Details</label>
			<input type="text" id="bed_dtl_btn" name="bed_dtl_btn" data-typ="Button">
			
			<label forx="1" for="ind_move_btn">Individual Movement</label>
			<input type="text" id="ind_move_btn" name="ind_move_btn" data-typ="Button">
			  	
			<label forx="1" for="assign_res_btn">Assign/Reserve</label>
			<input type="text" id="assign_res_btn" name="assign_res_btn" data-typ="Button">
			
			<label forx="1" for="unreserve_btn">Unreserve</label>
			<input type="text" id="unreserve_btn" name="unreserve_btn" data-typ="Button">
			
			<label forx="1" for="add_to_wait_btn">Add to Wait List</label>
			<input type="text" id="add_to_wait_btn" name="add_to_wait_btn" data-typ="Button">
			
			<label forx="1" for="sel_bed_dtls">Selected Bed Details</label>
			<input type="text" id="sel_bed_dtls" name="sel_bed_dtls" data-typ="Text">

		</form>
	</div>
	
	<style>
	.characteristHeader{
		height: 100%!important;
		min-height:35px;
	}
	.building:nth-child(odd){
		background:#f1f1f1;
		transition: transform .2s;
	}
	.building{
	font-size:14px
	}
	.openCollapse{
		background:#fff!important;
	}
	.tree-node:nth-child(even){
		background:#fff;
		transition: transform .2s;
	}
	.building:hover .fa-building-columns{
		-ms-transform: scale(1.3); /* IE 9 */
		-webkit-transform: scale(1.3); /* Safari 3-8 */
		transform: scale(1.3); 
	}
	.unit:hover .fa-building{
		-ms-transform: scale(1.3); /* IE 9 */
		-webkit-transform: scale(1.3); /* Safari 3-8 */
		transform: scale(1.3); 
	}
	.floor:hover .fa-sitemap{
		-ms-transform: scale(1.3); /* IE 9 */
		-webkit-transform: scale(1.3); /* Safari 3-8 */
		transform: scale(1.3);
	}
		.bedDetailsColor .form-label{
			font-size: 16px;
			color: #7a59ad !important;
		}
		.form-group.focused .selectFloating {
		    left: 10px;
		}
		.badge-primaryOccupied{
			margin-left:5px;
		  background-color :#ee9b43;
		  color:white;
		  
		}
		.badge-primaryReserved{
			margin-left:5px;
		 background-color :#3287d4;
		  color:white;
		}
		.badge-primaryUnoccupied{
		margin-left:5px;
		 background-color :#6bb76b;
		  color:white;
		}
			.badge-primaryRecommendedHousing{
		margin-left:5px;
		 background-color :#6bb76b;
		  color:white;
		}
		.badge-primary{
			margin-left:5px;
		}
/* 
	.custom-select option:first-child{
	color:red
	
	} */
	.selected-row {
    background-color: #d9edf7; /* light blue highlight */
}
		.progress{
			height: 6px;
		}
		.greypercentage{
			background-color: rgb(157, 157, 157);
		}
		.greypercentageBorder{
			border-color: rgb(157, 157, 157)!important;
		}
		.yellowpercentage{
			background-color: #ffc241;
		}
		.yellowpercentageBorder{
			border-color: #ffc241!important;
		}
		.orangepercentage{
			background-color: #ff8000;
		}
		.orangepercentageBorder{
			border-color: #ff8000!important;
		}
		.housingDetailColumn{
			width: 100%;
			max-width: 200px;
		}
		.percentageBlock .h5{
			font-size: 12px!important;
		}
		.offenderCards{
		    padding: 5px;
		    border-radius: 5px;
		    color: #fff;	
		    height: 96px;	
		    overflow: auto;
		    overflow-x: hidden;
		}
		.currentlyBg{
			background:#a38cc6;
		}
		.ProgramsBg{
			background:#ffca5b;
		}
		.StaysBg{
			background:#39a1f4;
		}
		.IncidentsBg{
			background:#ff0000;
		}
		.cellBoxesBlock{
			height: calc(100vh - 468px);
		}
		.leftHousingunit{
			height: calc(100vh - 527px);
		}
		
.sidebartest {
    font-size: 13.5px;
    color:  #9a7bc8!important;  
    width: 100%;      
}
		label{
			font-weight: 500;
		}
	
		.recommendehouse{
    display: flex;
    justify-content: space-between;
}
		.checkboxBlock .custom-checkbox{
			width: 70px;
		}
		.levelStatusCheckbox .custom-checkbox{
			width: 95px;
		}
		.dataTables_info{
			position: absolute;
		}
		.panelContentBlock{
			/* border: 1px solid #7a58ac;	 */
			border-radius: 5px!important;
		}
	
		.cellBoxStatus{
			min-width: 10px;
			height: 10px;
		}
		.selected {
            padding: 4px;
             background:  #9a7bc8  !important;  
		    color: #fff;
		    border-radius: 3px; 
		    font-weight:700;    
        }
        
        .cellBox.hovered {
            background-color: #f0f0f0; 
            border-color: #007bff;
        }
.page-content-wrapper {
    overflow: auto;
    height: calc(100vh - 200px);
    overflow-x: hidden;
}
 .unoccupiedtab .active{
    border-bottom: 5px solid #6bb76b !important;
    border-image: unset  !important;
}
 .recommendedHousingtab .active{
    border-bottom: 5px solid #6bb76b !important;
    border-image: unset  !important;
}
 .occupiedtab .active{
    border-bottom: 5px solid #ee9b43 !important;
    border-image: unset  !important;
}
 .Reservedtab .active{
    border-bottom: 5px solid #3287d4 !important;
    border-image: unset  !important;
}


 		.floor-plan {
            gap: 10px;
            justify-content: center;
        }
     .CellBoxes{
            min-width: 100px;
            height: 100px;
            display: flex;
            justify-content: center;
            
            align-items: center;
          border: 1px solid #ddd;
            border-radius: 10px;
            font-size: 1.2em;
            cursor: pointer;
            transition: transform 0.2s, background-color 0.2s;
            color: #fff;
        }
        .CellBoxes.unoccupied {
            background-color:#d3d3d3;
            color: white;
        }
        .CellBoxes.occupied {
           background-color: #dc3545;
            color: white;
        }
        .CellBoxes:hover {
            transform: scale(1.1);
        }
        .tabulator .tabulator-tableholder{
        	overflow-x:hidden;
        }
          body {
      font-family: Arial, sans-serif;
      background: #fff;
      color: #333;
      margin: 0;
    }

    .sidebar {
      width: 280px;
      background: #fff;
      height: 100vh;
      padding: 15px;
      border-right: 1px solid #ccc;
      overflow-y: auto;
    }

    ul {
      list-style: none;
      margin: 0;
      padding: 0;
      position: relative;
    }

    ul ul {
      margin-left: 20px;
      padding-left: 15px;
      border-left: 1px solid #ccc; /* vertical connector */
    }

    .tree-node {
      padding: 6px 10px 6px 20px; /* space for +/− */
      cursor: pointer;
      position: relative;
      transition: background 0.3s;
    }

    .tree-node:hover {
      background: #ece0ff;
    }

    /* horizontal connector */
    ul ul .tree-node::before {
      content: "";
      position: absolute;
      top: 50%;
      left: -15px;
      width: 15px;
      height: 1px;
      background: #ccc;
    }

    .tree-branch {
      display: none;
    }

    .tree-node.active {
      background: #e6f0ff;
      font-weight: bold;
    }

   .tree-node.has-children > ul {
    display: none;
    padding-left: 20px; /* optional indentation */
}

.sidebartest ul {
    list-style-type: none; /* remove bullets */
    padding-left: 15px;    /* indent children */
}

.sidebartest .building {
    color: #4a4a4a!important  /* blue for buildings */
   
}

.sidebartest .unit {
    color: #ff7f0e;  /* orange for units */
}

.sidebartest .floor {
    color: #2ca02c;  /* green for floors */
}

.sidebartest .tier {
    color: #d62728;  /* red for tiers */
}


.tree-node {
    cursor: pointer;
    padding: 3px 8px;
    border-radius: 4px;
}

.tree-node:hover {
    color: #007bff; /* blue text on hover */
}
.tree-node.selected {
    background-color: #f0f0f0;
    color: white;
}
.fa-mars,.fa-venus{
      color: white;
	  margin-right: 5px;
	  position: absolute;
	  right: 0;
	           top: 6px;
	            font-size: 16px;

}
.colapsetree{
    font-size: 20px
}
.tree-node.building.no-children {
    padding-left: 24px;
    padding-top: 8px;
    padding-bottom: 8px;
}

@media screen and (max-width: 1367px) {
	.page-content-wrapper {
	    height: calc(100vh - 125px) !important;
	}
	.cellBoxesBlock{
		height: calc(100vh - 500px);
	}
	.leftHousingunit{
		height: calc(100vh - 521px);
	}
}

@media screen and (max-width: 1280px) {
	
}

@media (max-width: 1485px) {
	.bedDetailsColor{
	    width: 100%;
	    min-width: 100%;
	    display: flex;
	}
	.bedDetailsColor .selectBedBlock{
		margin-top:10px;
	}
	.bedDetailsColor .d-flex{
		margin-right:10px;
		max-width:fit-content;
	}
}


	</style>

	<div th:replace="~{fragments/script :: script}"></div>
	<script src="js/staticjs.js"></script>
	<script src="js/script.js"></script>
	<script>
	$(".date-input").attr("maxlength", "10").datepicker({
	    dateFormat: "mm/dd/yy",
	    changeMonth: true,
	    changeYear: true,
	    yearRange: function () {
	        var currentYear = new Date().getFullYear();
	        return (currentYear - 20) + ":" + (currentYear + 20);
	    }(),
	    onSelect: function (dateText, inst) {
	        $(this).datepicker("hide");
	    },
		beforeShow: function(input, inst) {
	        setTimeout(function() {
	            const $datepickerDiv = $('#ui-datepicker-div');

	            // Avoid adding multiple times
	            if (!$datepickerDiv.find('.custom-btn-wrapper').length) {
	                const $wrapper = $('<div>', {
	                    class: 'custom-btn-wrapper',
	                    css: {
	                        display: 'flex',
	                        gap: '4px',
	                        marginTop: '2px',
							marginBottom: '2px',
	                        justifyContent: 'space-between'
	                    }
	                });

	                const $todayBtn = $('<button>', {
	                    text: "Today",
	                    class: 'custom-today-btn',
	                    css: {
	                        flex: 1,
	                        padding: '2px',
	                        cursor: 'pointer',
							background: '#ece0ff', 
							border: 'none'
	                    },
	                    click: function(e) {
	                        e.preventDefault();
	                        const today = $.datepicker.formatDate("mm/dd/yy", new Date());
	                        $(input).val(today).trigger('change').datepicker("hide");
	                    }
	                });

	                const $clearBtn = $('<button>', {
	                    text: "Clear",
	                    class: 'custom-clear-btn',
	                    css: {
	                        flex: 1,
	                        padding: '2px',
	                        cursor: 'pointer',
							background: '#ece0ff',
							border: 'none'
	                    },
	                    click: function(e) {
	                        e.preventDefault();
	                        $(input).val('').trigger('change');
	                    }
	                });

	                $wrapper.append($todayBtn, $clearBtn);
	                $datepickerDiv.append($wrapper);
	            }
	        }, 10);
	    }
}).on("input", function () {

let value = $(this).val().replace(/\D/g, ""); 
if (value.length >= 3 && value.length <= 4) {
value = value.slice(0, 2) + "/" + value.slice(2);
} else if (value.length > 4 && value.length <= 8) {
value = value.slice(0, 2) + "/" + value.slice(2, 4) + "/" + value.slice(4);
}
$(this).val(value);

if ($(this).val().length === 10) {
$(this).datepicker("hide");
}
});
	
	
	 function makeTimeInput(input) {
	      input.setAttribute("maxlength", "5");
	      input.placeholder = "HH:MM";
	      input.addEventListener("keydown", function (e) {
	        const key = e.key;
	        if (["Backspace", "ArrowLeft", "ArrowRight", "Tab", "Delete"].includes(key)) return;
	        if (!/^[0-9]$/.test(key)) {
	          e.preventDefault();
	          return;
	        }
	        const raw = input.value.replace(/[^0-9]/g, "");
	        const pos = raw.length;
	        if (pos === 0 && !/[0-2]/.test(key)) {
	          e.preventDefault();
	        } else if (pos === 1 && raw[0] === "2" && !/[0-3]/.test(key)) {
	          e.preventDefault();
	        } else if (pos === 2 && !/[0-5]/.test(key)) {
	          e.preventDefault();
	        } else if (pos === 3 && !/[0-9]/.test(key)) {
	          e.preventDefault();
	        } else if (pos >= 4) {
	          e.preventDefault();
	        }
	      });
	      input.addEventListener("input", function () {
	        let val = input.value.replace(/[^0-9]/g, "");
	        if (val.length > 2) {
	          val = val.slice(0, 2) + ":" + val.slice(2, 4);
	        }
	        input.value = val.slice(0, 5);
	      });
	      input.addEventListener("blur", function () {
	        let value = input.value;
	        const regex = /^([01]\d|2[0-3]):([0-5]\d)$/;
	        if (value.trim() === "") {
	          input.value = "00:00";
	          return;
	        }
	        let raw = value.replace(/[^0-9]/g, "");
	        while (raw.length < 4) {
	          raw += "0";
	        }
	        const hh = raw.slice(0, 2);
	        const mm = raw.slice(2, 4);
	        const formatted = `${hh}:${mm}`;
	        if (regex.test(formatted)) {
	          input.value = formatted;
	        } else {
	          input.value = "00:00";
	        }
	      });
	    }
    
 
    
	// Date formatting function 
	function convertToMMDDYYYY(dateString) {
	       if (dateString) {
		   const date = new Date(dateString);
		   const formattedMonth = String(date.getUTCMonth() + 1).padStart(2, '0');
		   const formattedDay = String(date.getUTCDate()).padStart(2, '0');
		   const formattedYear = date.getUTCFullYear();
		   return `${formattedMonth}/${formattedDay}/${formattedYear}`;
		 }
		 return '';
		} 
	
    function getFormattedTime() {
        const now = new Date();
        const hours = String(now.getHours()).padStart(2, '0');
        const minutes = String(now.getMinutes()).padStart(2, '0');
        const seconds = String(now.getSeconds()).padStart(2, '0');
        return `${hours}:${minutes}`;
    }
    
    var userId = localStorage.getItem('userId');
    document.getElementById('forwardByDisplay').value = userId;

	$(document).ready(function() {
	     enableDropdowns(); 
	      var totalBoxes = 48;
	     var cellBoxesContainer = $('#cellBoxContainer');     
	     for (var i = 0; i < totalBoxes; i++) {
	         var greyedBox = $('<div class="CellBoxes unoccupied"></div>');
	         greyedBox.html(' ').css('background-color', '#d3d3d3');
	         cellBoxesContainer.append(greyedBox);
	     } 
	     
	     
		$('#searchButton').on('click', function () { 					   
		        fetchBuildingHierarchy();
		        fetchReasonDescription();
		});
		


///----------------------------------------------------------------------------------/////////////////////

		  function fetchReasonDescription() {
			  var SbiNo = document.getElementById('sbiNumberInput').value;
		        $.ajax({
		            url:  contextPath + 'rhreasonstatusdescription',
		            type: 'GET',
		            data: { SbiNo: SbiNo },
		            success: function(response) {
		                console.log("Response:", response);
		                $('#ocuupiedrhreasonstatus').val(response.reasonDesc || '');
		            },
		            error: function(xhr, status, error) {
		                console.error("Error:", error);
		                $('#reasonDescOutput').text("Failed to fetch reason description.");
		            }
		        });
		    }
		
		function enableDropdowns() {
		    // Check and enable based on values
		    if ($('#bldNumDropdown').val()) {
		        $('#bldNumDropdown').prop('disabled', false).css('pointer-events', 'auto');
		    }
		    if ($('#unitNumDropdown').val()) {
		        $('#unitNumDropdown').prop('disabled', false).css('pointer-events', 'auto');
		    }
		    if ($('#FloorNumDropdown').val()) {
		        $('#FloorNumDropdown').prop('disabled', false).css('pointer-events', 'auto');
		    }
		    if ($('#tierNumDropdown').val()) {
		        $('#tierNumDropdown').prop('disabled', false).css('pointer-events', 'auto');
		    }
		    if ($('#cellNumDropdown').val()) {
		        $('#cellNumDropdown').prop('disabled', false).css('pointer-events', 'auto');
		    }
		}
		
		 /////////// dropdown of building , unit , tier ,floor, cell///////////

	
	
function buildHierarchyList(nodes, level = 0, parentData = {unitId:null, floorNum:null, bldNum:null}) {
    let html = '<ul class="pl-0">';
    
    // Sort the keys alphabetically by node name
    const sortedKeys = Object.keys(nodes).sort((a, b) => {
        const nameA = nodes[a].name.toUpperCase(); // ignore case
        const nameB = nodes[b].name.toUpperCase();
        return nameA.localeCompare(nameB);
    });

    for (let key of sortedKeys) {
        const node = nodes[key];
        const hasChildren = node.children && Object.keys(node.children).length > 0;

        // Determine level class
        let levelClass = '';
        switch(level) {
            case 0: levelClass = 'building'; break;
            case 1: levelClass = 'unit'; break;
            case 2: levelClass = 'floor'; break;
            case 3: levelClass = 'tier'; break;
        }

        // Inherit parent values if child doesn't have them
        const unitId = node.unitId || parentData.unitId || null;
        const floorNum = node.floorNum || parentData.floorNum || null;
        const bldNum = node.bldNum || parentData.bldNum || null;
        const tierNum = node.tierNum || null;

        let noChildrenClass = (level === 0 && !hasChildren) ? ' no-children' : '';

        // Choose icon per level
        let iconHtml = '';
        if(level === 0) iconHtml = `<i class="fa-solid fa-building-columns" style="color:#000; margin-right:5px;"></i>`;
        else if(level === 1) iconHtml = `<i class="far fa-building" style="color:#555; margin-right:5px;"></i>`;
        else if(level === 2) iconHtml = `<i class="fa fa-sitemap" style="color:#777; margin-right:5px;"></i>`;
        else if(level === 3) iconHtml = `<i class="fa fa-sitemap" style="color:#999; margin-right:5px;"></i>`;

        html += `<li class="tree-node ${levelClass}${noChildrenClass}${hasChildren ? ' has-children' : ''}" 
                    data-level="${level}" 
                    data-id="${key}" 
                    data-name="${node.name}" 
                    data-bldnum="${bldNum}"
                    data-unitid="${unitId}"
                    data-floornum="${floorNum}"
                    data-tiernum="${tierNum}">
                    ${hasChildren ? '<span class="toggle colapsetree">+</span>' : ''}
                    ${iconHtml}
                    <span class="label">${toPascalCase(node.name)}</span>`;

        // Recursively add children if any
        if (hasChildren) {
            html += `<ul class="nested" style="display:none;">`;
            html += buildHierarchyList(node.children, level + 1, {unitId, floorNum, bldNum});
            html += `</ul>`;
        }

        html += '</li>';
    }

    html += '</ul>';
    return html;
}


function toPascalCase(str) {
    if (!str) return str; // return as-is if null/undefined
    return str
        .toLowerCase()
        .replace(/(^\w|[\s_-]\w)/g, match => match.replace(/[\s_-]/, '').toUpperCase());
}

	function fetchBuildingHierarchy() {
		  var SbiNo = document.getElementById('sbiNumberInput').value;
		    var screenName = document.getElementById('screenNameHolder').textContent;
		    var screenCode = document.getElementById('screenNameHolder').dataset.name;  		    
		    insertSBISearch(screenCode,screenName,SbiNo);
		    var location1 = localStorage.getItem('location1');
		/*     var parts = location1.split("-"); */
		    var instNum = '03';
	    $.ajax({
	        url: "hierarchy",
	        type: "GET",
	        data: { instNum },
	        success: function(response) {
	        	const hierarchy = {};	    	        	 
	         response.forEach(row => {	        		 
	        		const upperRow = row.map(item => 
	        	    typeof item === "string" ? item.toUpperCase() : item
	        	)/* .sort((a, b) => {
		            // Compare the first string element in each row
		            const strA = a.find(item => typeof item === "string") || "";
		            const strB = b.find(item => typeof item === "string") || "";
		            return strA.localeCompare(strB);
		        }) */;
	        console.log(response);
	                const [bldNum, bldName, unitId, unitName, floorNum, floorName, tierNum, tierName] = upperRow;

	        	    if (!hierarchy[bldNum]) {
	        	        hierarchy[bldNum] = { 
	        	            name: bldName, 
	        	            bldNum: bldNum, 
	        	            unitId: null,
	        	            floorNum: null,
	        	            children: {} 
	        	        };
	        	    }
	        	    let parent = hierarchy[bldNum];

	        	    // Unit
	        	    if (unitId) {
	        	        if (!parent.children[unitId]) {
	        	            parent.children[unitId] = { 
	        	                name: unitName, 
	        	                bldNum: bldNum, 
	        	                unitId: unitId, 
	        	                floorNum: null,
	        	                children: {} 
	        	            };
	        	        }
	        	        parent = parent.children[unitId];
	        	    }

	        	    // Floor
	        	    if (floorNum) {
	        	        if (!parent.children[floorNum]) {
	        	            parent.children[floorNum] = { 
	        	                name: floorName, 
	        	                bldNum: bldNum, 
	        	                unitId: parent.unitId || null, 
	        	                floorNum: floorNum,
	        	                children: {} 
	        	            };
	        	        }
	        	        parent = parent.children[floorNum];
	        	    }

	        	    // Tier
	        	    if (tierNum) {
	        	        if (!parent.children[tierNum]) {
	        	            parent.children[tierNum] = { 
	        	                name: tierName, 
	        	                bldNum: bldNum, 
	        	                unitId: parent.unitId || null, 
	        	                floorNum: parent.floorNum || null,
	        	                tierNum: tierNum,
	        	                children: {} 
	        	            };
	        	        }
	        	    }
	        	});
	            $(".sidebartest").html(buildHierarchyList(hierarchy));
	            
	        },
	        complete: function (response){
	        	setTimeout(function (){
	        		loader(0);
	        	},1500)
	        },
	        error: function(xhr, status, error) {
	            console.error("Error fetching hierarchy:", error);
	        }
	    });
	}

	
	// Handle expand/collapse with class toggle
	$(".sidebartest").on("click", ".toggle", function (e) {
	    e.stopPropagation();

	    const $li = $(this).closest("li");

	    // Toggle visibility of children
	    const $nested = $li.children("ul.nested");

	    if ($nested.is(":visible")) {
	        // Collapse
	        $nested.slideUp(150);
	        $(this).text("+");
	        $li.removeClass("openCollapse"); // 🔹 remove class when collapsed
	    } else {
	        // Expand
	        $nested.slideDown(150);
	        $(this).text("-");
	        $li.addClass("openCollapse"); // 🔹 add class when opened
	    }
	});


	let selectedNode = null;
$(".sidebartest").on("click", ".label", function(e) {
    e.stopPropagation();
    $(".tree-node .label").removeClass("selected");
    $(this).addClass("selected");

    const $li = $(this).closest("li");
     selectedNode = {
        id: $li.data("id"),
        name: $li.data("name"),
        bldNum: $li.data("bldnum") || null,
        unitId: $li.data("unitid") || null,
        floorNum: $li.data("floornum") || null,
        tierNum: $li.data("tiernum") || null,
        level: $li.data("level")
    };
     localStorage.setItem('bldNum', selectedNode.bldNum);
     localStorage.setItem('unitId', selectedNode.unitId);
     localStorage.setItem('floorNum', selectedNode.floorNum);
     localStorage.setItem('tierNum', selectedNode.tierNum);
    callFetchBedCells();
});
	


$('#bedTabs .nav-link').on('shown.bs.tab', function(e) {
    if (selectedNode) {
        callFetchBedCells();
    }
});
//✅ Put this at top-level
function callFetchBedCells() {
    const activeTab = $('#bedTabs .nav-link.active').attr('id');
    let occupiedFlag = null;
    let updateCount = false;

    switch (activeTab) {
    case 'Occupied-tab':
        occupiedFlag = 'O';
        break;
    case 'Unoccupied-tab':
    case 'recommendedHousing-tab':  // 👈 both tabs share same logic
        occupiedFlag = 'U';
        break;
    case 'Reserved-tab':
        occupiedFlag = 'R';
        break;
    default:
        occupiedFlag = null;
        updateCount = true;
}

    console.log("✅ callFetchBedCells triggered with flag:", occupiedFlag);
    fetchBedCells(
        $('#sbiNumberInput').val(),
        '03',
        selectedNode?.bldNum,
        selectedNode?.unitId,
        selectedNode?.floorNum,
        selectedNode?.tierNum,
        null,
        occupiedFlag,
        updateCount
    );

    fetchReasonDropdown();
}



		  
		var building=[];
		function fetchBuildings() {		
			loader(1);
		    var SbiNo = document.getElementById('sbiNumberInput').value;
		    var screenName = document.getElementById('screenNameHolder').textContent;
		    var screenCode = document.getElementById('screenNameHolder').dataset.name;  		    
		    insertSBISearch(screenCode,screenName,SbiNo); 
		  /*   var userId = localStorage.getItem('userId'); */
		    var bldNum = $('#bldNumDropdown').val();
		    var unitId = $('#unitNumDropdown').val();
		    var floorNum = $('#FloorNumDropdown').val();
		    var tierNum = $('#tierNumDropdown').val();
		    var cellNum = $('#cellNumDropdown').val();
		    $.ajax({
		        method: 'GET',
		        url: contextPath + 'Building',
		        data: {
		            userId: userId,
		            SbiNo: SbiNo
		        },
		        success: function(response) {		        	
		            if (response.message) { 
		                if (response.message === "The Offender is not active in your facility") {		          
		                    message('CUE', 'The Offender is not active in your facility', 0);	
		                    return; 
		                }
		            }  
		            else {			            
		            	 fetchReasonDropdown(); 
		 		        /* fetchBedRecommendations(); */
		 		          fetchReasonDescription();
		                $('#bldNumDropdown').removeAttr('disabled');
		                $('#bldNumDropdown').removeAttr('readonly');
		                $('#bldNumDropdown').css('pointer-events', 'auto');
		                $('#AllBedsradio').prop('disabled', false);
		                $('#Unoccupiedradio').prop('disabled', false);
		                $('#Reservedradio').prop('disabled', false);
		                $('#Occupiedradio').prop('disabled', false);
		                $('#bedcellselected').removeAttr('disabled').removeAttr('readonly').css('pointer-events', 'auto');
		                $('#offenderdetails').prop('disabled', false).removeAttr('disabled').removeAttr('read-only').css('pointer-events', 'auto');
			            $('#individualmovement').prop('disabled', false).removeAttr('disabled').removeAttr('read-only').css('pointer-events', 'auto');
			            $('#beddetails').prop('disabled', false).removeAttr('disabled').removeAttr('read-only').css('pointer-events', 'auto');
			            $('#unreserve').prop('disabled', false).removeAttr('disabled').removeAttr('read-only').css('pointer-events', 'auto');
			            $('#assign').prop('disabled', false).removeAttr('disabled').removeAttr('read-only').css('pointer-events', 'auto');
			            $('#addWaitlist').prop('disabled', false).removeAttr('disabled').removeAttr('read-only').css('pointer-events', 'auto');				            
			            var building = response.bedDetails; 		             			           
			         // Empty the existing tree if needed
			            $('#buildingTree').empty();

			            for (var i = 0; i < building.length; i++) {
			                var bldLabel = building[i][0].trim();
			                var bldValue = building[i][1].trim();

			                // Build the HTML for each building
			                var listItem = `
			                  <li>
			                    <div class="folder">${bldLabel}</div>
			                    <ul class="nested">
			                        <li>Unit 1 for ${bldLabel}</li>
			                        <li>Unit 2 for ${bldLabel}</li>
			                    </ul>
			                  </li>
			                `;

			                $('#buildingTree').append(listItem);
			            }

			          
			         
		            }           
		        },
		        complete: function (response){
   		        	setTimeout(function (){
   		        		loader(0);
   		        	},1500)
   		        },
		        error: function(xhr, status, error) {
		            console.error(status, error);
		        }
		    });
		}

	    function fetchUnits(instNum, bldNum) {		     
	        $.ajax({
	            method: 'GET',
	            url: contextPath + 'units', 
	            data: {
	                instNum: instNum,
	                bldNum: bldNum
	            },
	            success: function(response) {	     
	            	if (response.length === 0) {		            		
	                $('#unitNumDropdown')
	                    .attr('disabled', 'disabled')
	                    .css('pointer-events', 'none');	
	                fetchFloors(instNum, bldNum,null); 
	                    
	            } else {
	           	$('#bedcellselected').prop('disabled', false).removeAttr('readonly').css('pointer-events', 'auto');
	                $('#unitNumDropdown')
	                    .removeAttr('disabled')
	                    .removeAttr('readonly')
	                    .css('pointer-events', 'auto');
	                $('#FloorNumDropdown').attr('disabled', 'disabled').css('pointer-events', 'none');
	    	        $('#tierNumDropdown').attr('disabled', 'disabled').css('pointer-events', 'none');
	    	        $('#cellNumDropdown').attr('disabled', 'disabled').css('pointer-events', 'none'); 
	    	        $('#unitNumDropdown').empty().append('<option value="">Wing/Unit</option>');
	    	
	    	        var jsonDataUnits = [];
	    	        for (var i = 0; i < response.length; i++) {
	    	            var entry = {
	    	                value: response[i][1].trim(), 
	    	                label: response[i][0].trim()  
	    	            };
	    	            jsonDataUnits.push(entry);
	    	        }
	    	     /*    autocomplete('unitNumDropdown', jsonData2, "label", "value"); */
	    	        
	    	     // Assuming your autocomplete function can take a select callback
	    	        autocomplete('unitNumDropdown', jsonDataUnits, "label", "value", function(selectedItem) {
	    	            var unitId = selectedItem.value;  // the actual value
	    	            console.log("Selected unit number:", unitId);

	    	            var location1 = localStorage.getItem('location1');
	    	            let parts = location1.split("-");
	    	            var instNum = parts[1].trim();
	    	            var bldNum = "22909"; // or get dynamically if needed

	    	            // Call your function
	    	            fetchFloors(instNum, bldNum, unitId);
	    	        });
	            }
	        },
	            error: function(xhr, status, error) {
	                console.error('Error fetching units:', status, error);
	            }
	        });
	    }
	    
	    function fetchFloors(instNum, bldNum, unitId) {	 	      
	        $.ajax({
	            method: 'GET',
	            url: contextPath + 'floors', 
	            data: {
	                instNum: instNum,
	                bldNum: bldNum,
	                unitId: unitId
	            },
	            success: function(response) {
	                if (response.length === 0) {   	                	 
	                    $('#FloorNumDropdown')
	                        .attr('disabled', 'disabled')
	                        .attr('readonly', 'readonly')
	                        .css('pointer-events', 'none');  
	                    fetchTiers(instNum, bldNum, unitId,null);	                    
	                                       
	                } else {	
	                 	$('#bedcellselected').prop('disabled', false).removeAttr('readonly').css('pointer-events', 'auto');
	                    $('#FloorNumDropdown')
	                        .removeAttr('disabled')
	                        .removeAttr('readonly')
	                        .css('pointer-events', 'auto');
	                    $('#tierNumDropdown').attr('disabled', 'disabled').css('pointer-events', 'none');
		    	        $('#cellNumDropdown').attr('disabled', 'disabled').css('pointer-events', 'none'); 
		    	        $('#FloorNumDropdown').empty().append('<option value="">Floor</option>');
		    	     // Convert response into JSON for autocomplete
		    	        var jsonDataFloors = [];
		    	        for (var i = 0; i < response.length; i++) {
		    	            var entry = {
		    	                value: response[i][1].trim(), // VAL
		    	                label: response[i][0].trim()  // OPT
		    	            };
		    	            jsonDataFloors.push(entry);
		    	        }

		    	    
	                }
	            },
	            error: function(xhr, status, error) {
	                console.error('Error fetching floors:', status, error);
	            }
	        });
	    }
	    
	    function fetchTiers(instNum, bldNum, unitId, floorNum) {
	   
	        $.ajax({
	            method: 'GET',
	            url: contextPath + 'tiers', 
	            data: {
	                instNum: instNum,
	                bldNum: bldNum,
	                unitId: unitId,
	                floorNum: floorNum
	            },
	            success: function(response) {
	                if (response.length === 0) {
	                     $('#tierNumDropdown')
	                        .attr('disabled', 'disabled')
	                        .attr('readonly', 'readonly')
	                        .css('pointer-events', 'none'); 
	                    fetchCells(instNum, bldNum, unitId, floorNum, null);	                                     
	                } else {
	                 
	                     $('#tierNumDropdown')
	                        .removeAttr('disabled')
	                        .removeAttr('readonly')
	                        .css('pointer-events', 'auto'); 
	                    $('#tierNumDropdown').empty().append('<option value="">Tier/pod</option>');
	                 
	                   
	                }
	            },
	            error: function(xhr, status, error) {
	                console.error('Error fetching tiers:', status, error);
	            }
	        });
	    }
	    
	    function fetchCells(instNum, bldNum, unitId, floorNum, tierNum) {	     
	        $.ajax({
	            method: 'GET',
	            url: contextPath + 'cells', 
	            data: {
	                instNum: instNum,
	                bldNum: bldNum,
	                unitId: unitId,
	                floorNum: floorNum,
	                tierNum: tierNum
	            },
	            success: function(response) {
	                if (response.length === 0) {
	                    $('#cellNumDropdown')
	                        .attr('disabled', 'disabled')
	                        .attr('readonly', 'readonly')
	                        .css('pointer-events', 'none'); 	                   
	                } else {
	                    $('#cellNumDropdown')
	                        .removeAttr('disabled')
	                        .removeAttr('readonly')
	                        .css('pointer-events', 'auto'); 	                    
	                    $('#cellNumDropdown').empty().append('<option value="">Room/Cell</option>');
	                }
	            },
	            error: function(xhr, status, error) {
	                console.error('Error fetching cells:', status, error);
	            }
	        });
	    }
	    	    
	    
	    // cell characterticts display populate grid  //


			 // unreserving the bed //  
		      
		    $('#unreserve').on('click', function() {
		    	  var selectedCellBox = $('.CellBoxes.selected');     
		            var selectedcellno = selectedCellBox.data('cellNo');
		            var selectedBedNum = selectedCellBox.data('bed-no');
		            var bedStatus = selectedCellBox.data('bed-status');	      
			    if (bedStatus !== 'R') {
			    	  message('CUE','Bed is not reserved to unreserve.',0);
			     
			    } else {
			        $('#listOfCaseChargeModal').modal('hide');
			        $.ajax({
			            url: contextPath + 'unreserve',
			            type: 'GET', 	                       
			            data: { bedNo: selectedBedNum },
			            success: function(response) {	            			              		     
			              /*   triggersearch();  */
			                callFetchBedCells();
			                message('AS01',0);	
			                
			            },
			            error: function(xhr, status, error) {
			                console.error('Error executing procedure: ' + error);
			            }
			        });
			    }
			});
	 
  //////////reason dropdown //////////////////	
      
	    function fetchReasonDropdown() {			
		    $.ajax({
		        url: contextPath + 'reason',
		        type: 'GET',
		        success: function(response) {
		            $('#bedcellselected').prop('disabled', false).removeAttr('readonly').css('pointer-events', 'auto');
		            $('#offenderdetails').prop('disabled', false).removeAttr('disabled').removeAttr('read-only').css('pointer-events', 'auto');
		            $('#individualmovement').prop('disabled', false).removeAttr('disabled').removeAttr('read-only').css('pointer-events', 'auto');
		            $('#beddetails').prop('disabled', false).removeAttr('disabled').removeAttr('read-only').css('pointer-events', 'auto');
		            $('#unreserve').prop('disabled', false).removeAttr('disabled').removeAttr('read-only').css('pointer-events', 'auto');
		            $('#assign').prop('disabled', false).removeAttr('disabled').removeAttr('read-only').css('pointer-events', 'auto');
		            $('#addWaitlist').prop('disabled', false).removeAttr('disabled').removeAttr('read-only').css('pointer-events', 'auto');
		            $('#reasondate').removeAttr('disabled').removeAttr('readonly').css('pointer-events', 'auto');
		            $('#reasontime').removeAttr('disabled').removeAttr('readonly').css('pointer-events', 'auto');
		            $('#reasonDropDown').removeAttr('disabled').removeAttr('readonly').css('pointer-events', 'auto');
		            $('#enddate').removeAttr('disabled').removeAttr('readonly').css('pointer-events', 'auto');
		            $('#endtime').removeAttr('disabled').removeAttr('readonly').css('pointer-events', 'auto');
		            const currentDate = new Date();
		            const formattedCurrentDate = convertToMMDDYYYY(currentDate);
		            const currentTime = getFormattedTime();
		            $('#reasondate').val(formattedCurrentDate);
		            $('#reasontime').val(currentTime);
		            var $dropdown = $('#reasonDropDown');
		            $dropdown.empty();
		         
		            $.each(response, function(key, value) {
			            $('#reasonDropDown').append(`
			                <option value="${key}">${value}</option>
			            `); 

			        });	            
		            
		            
		            $('#reasonDropDown').on('change', function() {
		                const currentDate = new Date();
		                const formattedCurrentDate = convertToMMDDYYYY(currentDate);
		                const currentTime = getFormattedTime();
		                $('#reasondate').val(formattedCurrentDate);
		                $('#reasontime').val(currentTime);
		            });
		        },
		        error: function(xhr, status, error) {
		            console.error('Error fetching dropdown values:', error);
		        }
		    });
		} 



 ///////////////////////////////////addwaitlist/////////////////////////////////////////////
	$('#addWaitlist').on('click', function () {
		    var reason = $('#reasonDropDown').val();
	    var startDateTime = $('#reasondate').val();
		    var endDateTime = $('#enddate').val();
		    var cellSelected = $('.CellBoxes.selected').length > 0;
		    if (!cellSelected) {
		    	 message('CUW','Please select a bed',0); 		      
		    }
		    var selectedCellBox = $('.CellBoxes.selected');
		    var selectedCellNo = selectedCellBox.data('cellNo');
		    var selectedBedNum = selectedCellBox.data('bed-no');
		    var bedStatus = selectedCellBox.data('bed-status');
		    var sbiNo = $('#sbiNumberInput').val();
		    var location1 = localStorage.getItem('location1');
		    var parts = location1.split("-");
		    var instNum = parts[1].trim();
		    if (bedStatus === 'U') {
	    	 message('CUE','Cannot waitlist an offender for an unoccupied bed. Please assign the offender to the bed first.',0); 
		    } 
		    if (!reason) {
		    	 message('CUE','Reason must be entered',0); 		       
		    }
		    if (!startDateTime) {
		    	 message('CUE','Start date needs to be entered',0); 		       
		    }
		    if (!endDateTime) {
		    	 message('CUE','End date needs to be entered',0); 			      
		    }
		    $.ajax({
		        url: contextPath + 'addtowaitlist',
    	        method: 'GET',
		        data: {
		            bedNo: selectedBedNum,
		            sbiNo: sbiNo,
		            instNum: instNum,
		            cellNo: selectedCellNo
		        },
		        success: function (response) {		           
		            if (response.waitlistResult.result) {
		            	 message('S',0,0);

		            } else {
		                $.ajax({
		                    url: contextPath + 'insert',
		                    method: 'POST',
	                    data: {
		                        sbiNo: sbiNo,
		                        instNum: instNum,
		                        bedNo: selectedBedNum,
		                        reason: reason,
	                            stDateTime: startDateTime,
	                            toDate: endDateTime,
		                        cellNo: selectedCellNo,
		                        bldNum: response.extractedBldNum,
		                        unitId: response.extractedUnitId,
		                        floorNum: response.extractedFloorNum,
		                        tierNum: response.extractedTierNum
		                    },
		                    success: function (insertResponse) {
		                        if (insertResponse === "Unit waitlist inserted successfully.") {		                        
		                        	callFetchBedCells();
		                        	 message('S',0,0);
		                        }
		                        selectedCellBox.removeClass('selected'); 
		                    },
		                    error: function (xhr, status, error) {
		                        console.error('Error inserting value:', status, error);
		                        console.error('Response:', xhr.responseText);
		                    }
		                });
		            }
		        },
		        error: function (xhr, status, error) {
		            console.error('Error adding to waitlist:', status, error);
		            console.error('Response:', xhr.responseText);
		        }
		    });
		});

	    
 ///////////////////////////////  assign/reserve button ///////////////////////////////////////////////// 
 
 	$('#assign').on('click', function() {
	    	    if (!checkOffenderProtection()) {	
	    	    	triggerCheckRestrictedAjax();	    	      
	    	    }
	    	});
	        
	    function checkOffenderProtection(sbiNo) {
			var Sbino = $('#sbiNumberInput').val();
			  var userId = localStorage.getItem('userId');
			  let isProtected = false; 
		    $.ajax({
		        url:  contextPath + 'isProtected',
		        type: 'GET',
		        data: { sbiNo: Sbino },
		        success: function(response) {
		            if(response === true) {	
		            	  isProtected = true; 
		            	fetchEnemies(); 
		            	 fetchMovementReasons();
		            	  fetchdisapproveReasons(); 
		            	  loadUsersFullName(userId);		       
		              $('#movementauthorities').modal('show');
		             
		            } else {
		            	/* checkLocation(); */
		            	/*  triggerCheckRestrictedAjax(); */
		            }
		        },
		        error: function(xhr, status, error) {
		            console.log("Error: " + error);
		        }
		    });
		}
	    
	    
	    function insertProtectedOffenderBedStage() {
			sendNotification(); 
		    var sbiNo = $('#sbiNumberInput').val();		   
			var bldNum   = localStorage.getItem("bldNum");
	    	var unitId   = localStorage.getItem("unitId");
	    	var floorNum = localStorage.getItem("floorNum");
	    	var tierNum  = localStorage.getItem("tierNum");       
            var selectedCellBox = $('.CellBoxes.selected');
            var selectedcellno = selectedCellBox.data('cellNo');
            var selectedBedNum = selectedCellBox.data('bed-no');		
		    var reason = $('#reasonDropDown').val();
		    /* var reasonString =reason.join(',');  */
            var startDateTime = $('#reasondate').val();
            var statdatesad =convertToMMDDYYYY(startDateTime);          
            var endDateTime = $('#enddate').val();
            var enddatere =convertToMMDDYYYY(endDateTime);       
		    var bedStayEndTime = $('#endtime').val();
		    var bedStayStartTime = $('#reasontime').val();		    
		    $.ajax({
		        url: contextPath + 'protectedbedstage', 
		        type: 'POST',
		        data: {
		            sbiNo: sbiNo,		           
		            bldNum: bldNum,
		            unitId: unitNum,
		            floorNum: floorNum,
		            tierNum: tierNum,
		            cellNo: selectedcellno,
		            bedNo: selectedBedNum,
		            reasonCode: reason,
		            bedStayStartDate: statdatesad,
		            bedStayStartTime: bedStayStartTime,
		            bedStayEndDate: enddatere,
		            bedStayEndTime: bedStayEndTime,
		           
		        },
		        success: function(response) {	         
		        	  $('#movementauthorities').modal('hide');	
			        	 $('#listOfCaseChargeModal .modal-body').html('<p>Changes saved in the database</p>');
	                     $('#listOfCaseChargeModal').modal('show');
		            
		        },
		        error: function(xhr, status, error) {
		            alert("Failed to insert into protected_ofndr_bed_stage: " + xhr.responseText);
		        }
		    }); 
		}
		
		function sendNotification(notificationType, sbiNo, commitNo, userId, instNum, bldNum, unitNum, floorNum, tierNum, cellNo, bedNo, pobsSeqNum, promsSeqNum) {
			var sbiNo = $('#sbiNumberInput').val();
			   var location1 = localStorage.getItem('location1');
	            let parts = location1.split("-");
	            var instNum = parts[1].trim();
	        	var bldNum   = localStorage.getItem("bldNum");
		    	var unitId   = localStorage.getItem("unitId");
		    	var floorNum = localStorage.getItem("floorNum");
		    	var tierNum  = localStorage.getItem("tierNum");       
	            var selectedCellBox = $('.CellBoxes.selected');
	            var selectedcellno = selectedCellBox.data('cellNo');
	            var selectedBedNum = selectedCellBox.data('bed-no');	
				var userId=localStorage.getItem('userId');

		    $.ajax({
		        url: contextPath +'sendnotification',  
		        type: 'POST',		      
		        data:{
			        notificationType: 'FORWARD',
			        sbiNo: sbiNo,
			        userId: "BADMMRP",
			        instNum: instNum,
			        bldNum: bldNum,
			        unitNum: unitNum,
			        floorNum: floorNum,
			        tierNum: tierNum,
			        cellNo: selectedcellno,
			        bedNo: selectedBedNum,
			        pobsSeqNum: null,
			        promsSeqNum: null
			    },
		        success: function(response) {
		        	  $('#movementauthorities').modal('hide');	
		        	 $('#listOfCaseChargeModal .modal-body').html('<p>Notification sent.</p>');
                     $('#listOfCaseChargeModal').modal('show');
		        },
		        error: function(jqXHR, textStatus, errorThrown) {
		            console.error("Error:", textStatus, errorThrown);
		        }
		    });
		}

  
		 function triggerCheckRestrictedAjax() {
				console.log("rh and non rh popup");
	            var Sbino = $('#sbiNumberInput').val();
	            var location1 = localStorage.getItem('location1');            
	            let parts = location1.split("-");
	            var instNum = parts[1].trim();
	        	var bldNum   = localStorage.getItem("bldNum");
		    	var unitId   = localStorage.getItem("unitId");
		    	var floorNum = localStorage.getItem("floorNum");
		    	var tierNum  = localStorage.getItem("tierNum");       
	            $.ajax({
	                url: contextPath + 'checkrestricted', 
	                method: 'POST',            
	                data: {
	                    SbiNo: Sbino,
	                    instNum: instNum,
	                    bldNum: bldNum,
	                    unitId: unitId,
	                    floorNum: floorNum,
	                    tierNum: tierNum     
	                },
	                success: function(response) {
	                    console.log('Success:', response);                
	                    if (response.waitlistResult && response.waitlistResult.popup === 'RH') {
	                        $('#ReasonforRH').modal('show');
	                        fetchReasonQuery('03','0053779'); 
	                    } 
	                    else if (response.waitlistResult && response.waitlistResult.popup === 'NON-RH') {
	                        $('#NonRhreason').modal('show');
	                        $('#NonRhreason').on('shown.bs.modal', function () {
	                            $('#InfirmaryCheck').prop('disabled', true);
	                            $('#outsideHospital').prop('disabled', true);
	                            $('#pco').prop('disabled', true);
	                        });
	                    } 
	                    else if (response.waitlistResult && !response.waitlistResult.popup) {
	                    	checkHandicap();
	                    }
	                },
	                error: function(xhr, status, error) {
	                    console.error('Error:', error);
	                    alert('Failed to assign value');
	                }
	            });
	        }
		    
		 const timeInput = document.getElementById("endtime");
		 makeTimeInput(timeInput);
		 const timeInput1 = document.getElementById("reasontime");
		 makeTimeInput(timeInput1);
		 
		 $('#saveupdatereason').click(function() { 
			    var bldNum   = localStorage.getItem("bldNum");
			    var unitId   = localStorage.getItem("unitId");
			    var floorNum = localStorage.getItem("floorNum");
			    var tierNum  = localStorage.getItem("tierNum");       
			    var startDate = $('#reasondate').val();
			    var startDateTime = convertToMMDDYYYY(startDate);
			    var endDate = $('#enddate').val();
			    var endDateTime = convertToMMDDYYYY(endDate);
			    var selectedCellBox = $('.CellBoxes.selected');
			    var selectedcellno = selectedCellBox.data('cellNo');
			    var selectedBedNum = selectedCellBox.data('bed-no');          
			    var location1 = localStorage.getItem('location1');
			    var parts = location1.split("-");
			    var instNum = parts[1].trim();
			    var action='CONFIRM_ASGN';
			    var nonRhRsnFlag=null;
			    var userId=localStorage.getItem('userId');
			    var sbino = $('#sbiNumberInput').val();

			    // Collect selected reasons
			    var selectedReasons = [];
			    $('#reasonTable tbody input:checked').each(function() {
			        selectedReasons.push($(this).attr('id').replace('Check', ''));
			    });

			    if (selectedReasons.length === 0) {
			        $('#ReasonforRH').modal('hide');
			        message('CUE','Please select at least one reason for assigning the offender to a restrictive housing location',0);  
			        return;   
			    }

			    // First, fetch the commit number
			    $.ajax({
			        url: 'vitalcommitNo',
			        method: 'GET',
			        data: { parameter: sbino },
			        success: function(selectedCommit) {
			            // Build payload for RH reason update
			            var payload = {
			                commitNo: selectedCommit,
			                reasonCodes: selectedReasons,
			                userId: userId
			            };

			            // Now call the updateRhReason controller
			            $.ajax({
			                url: contextPath + 'updateRhReason',
			                type: 'POST',
			                contentType: 'application/json',
			                data: JSON.stringify(payload),
			                success: function(response) {
			                    console.log("RH reason updated:", response);
			                    $('#ReasonforRH').modal('hide');

			                    // Then assign the bed
			                    $.ajax({
			                        url: contextPath + 'assignbed',
			                        method: 'POST',
			                        data: {
			                            sbino: sbino,
			                            instNum: instNum,
			                            buildNum: bldNum,
			                            unitId: unitId,
			                            floorNum: floorNum,
			                            tierNum: tierNum,
			                            cellNo: selectedcellno,
			                            bedNo: selectedBedNum,
			                            action: action,
			                            stDateTime: startDateTime,
			                            resnCode: selectedReasons.join(','), // comma-separated
			                            toDate: endDateTime,
			                            nonRhRsnFlag: nonRhRsnFlag
			                        },
			                        success: function(response) {     
			                            console.log("Bed assigned successfully");
			                            callFetchBedCells();
			                            selectedCellBox.removeClass('selected'); 
			                            $('#bedTabs .nav-link').removeClass('active');
			                            $('#bedTabsContent .tab-pane').removeClass('active show');
			                            $('#AllBeds-tab').addClass('active');
			                            $('#AllBeds').addClass('active show');
			                            message('S',0,0);   
			                        },
			                        error: function(xhr, status, error) {
			                            alert('Error executing assignbed: ' + xhr.responseText);
			                        }
			                    });
			                },
			                error: function(xhr, status, error) {
			                    console.error('Error updating RH reason:', xhr.responseText);
			                }
			            });
			        },
			        error: function(xhr, status, error) {
			            console.error('Error fetching commit number:', xhr.responseText);
			        }
			    });
			});

//////////////////////////////////////////////////////////////////////////////////////////////	       
	   
	    
		$('#movementassignmentokk').on('click', function() {
			 triggerCheckRestrictedAjax(); 
      })
      
		$('#checklocationmodalautomatically').on('click', function() {
             assignBed(); 
        	 $('#checklocationmodal').modal('hide');
      })
      
	     $('#yesmovingout').on('click', function() {	        	
	        	 $('#NonRhreason').modal('hide');
	            $('#InfirmaryCheck').prop('disabled', true);
	            $('#outsideHospital').prop('disabled', true);
	            $('#pco').prop('disabled', true);
	            assignBed(); 
	        });
	    
	    
	    function updateOccupiedFlag() {
	        var occupiedFlag = "";
	        if ($('#AllBedsradio').is(':checked')) {
	            occupiedFlag = null;
	        } else if ($('#Unoccupiedradio').is(':checked')) {
	            occupiedFlag = 'U';
	        } else if ($('#Reservedradio').is(':checked')) {
	            occupiedFlag = 'R';
	        } else if ($('#Occupiedradio').is(':checked')) {
	            occupiedFlag = 'O';
	        }

	        return occupiedFlag;
	    }
	    
	 // Step 1: Bind click handler safely, works even if element is added later
	    $(document).on('click', '#bedcellselected', function () {
	        var Sbino = $('#sbiNumberInput').val();
	        console.log("selectsbino:", Sbino);

	        var location1 = localStorage.getItem('location1');
	        let parts = location1.split("-");
	        var instNum = parts[1].trim();

	        var bldNum = localStorage.getItem('bldcode') || $('#bldNumDropdown').val();
	        var unitId = localStorage.getItem('unitcode') || $('#unitNumDropdown').val();
	        var tierNum = localStorage.getItem('tierpodcode') || $('#tierNumDropdown').val();
	        var floorNum = localStorage.getItem('floorcode') || $('#FloorNumDropdown').val();
	        var cellNum = $('#cellNumDropdown').val();
	        var occupiedFlag = updateOccupiedFlag();

	        fetchBedCells(Sbino, instNum, bldNum, unitId, floorNum, tierNum, cellNum, occupiedFlag);

	        localStorage.removeItem('bldNum');
	        localStorage.removeItem('unitId');
	        localStorage.removeItem('floorNum');
	        localStorage.removeItem('tierNum');
	        localStorage.removeItem('cellNum');
	    });

	 
	    
	   
    	 const currentDate = new Date();
     	const ForwardDate = convertToMMDDYYYY(currentDate);
     	console.log(ForwardDate);   
     	 document.getElementById('forwardByDdate').value = ForwardDate;
     	
     	const currentTime = getFormattedTime();
     	console.log(currentTime);		           
     	 document.getElementById('forwardByTime').value = currentTime;
        
     	
     	document.getElementById("endtime").addEventListener("click", function () {
     	    const input = this;
     	    const cellValue = input.value;

     	    input.type = "time";
     	    input.value = cellValue || "";

     	    input.addEventListener("change", function () {
     	        console.log("Time selected:", this.value);
     	    }, { once: true });
     	});

		
		function fetchEnemies(Sbino) {
			var Sbino = $('#sbiNumberInput').val();			
		    $.ajax({
		        url: contextPath + 'getEnemies', 
		        type: 'GET',
		        data: {
		            sbiNo: Sbino  
		        },
		        success: function(response) {
		            console.log(response);
		            populateTable(response);
		        },
		        error: function(xhr, status, error) {
		            console.error('Error fetching enemies: ', error);
		            alert('An error occurred while fetching enemy data.');
		        }
		    });
		}
	
		function fetchdisapproveReasons() {
		    $.ajax({
		        url:  contextPath +'disapproveValue',   
		        type: 'GET', 		       
		        success: function(response) {		          
		            console.log(response); 
		            let dropdown = $('#disapproveReasonsDropdown');
		            dropdown.empty(); 
		            $.each(response, function(index, referenceValue) {
		                dropdown.append($('<option>', {
		                    value: referenceValue.refValueCode,
		                    text: referenceValue.refValueDesc
		                }));
		            });
		        },
		        error: function(error) {
		            console.error('Error fetching movement reasons:', error);
		        }
		    });
		} 
		
		function fetchMovementReasons() {
		    $.ajax({
		        url:  contextPath +'referenceValue',   
		        type: 'GET', 		       
		        success: function(response) {		          
		            console.log(response); 
		            let dropdown = $('#movementReasonsDropdown');
		            dropdown.empty(); 
		            $.each(response, function(index, referenceValue) {
		                dropdown.append($('<option>', {
		                    value: referenceValue.refValueCode,
		                    text: referenceValue.refValueDesc
		                }));
		            });
		        },
		        error: function(error) {
		            console.error('Error fetching movement reasons:', error);
		        }
		    });
		}
		
		function loadUsersFullName(userId) {						
		    $.ajax({
		        url: contextPath +'forwardto',
		        type: 'GET', 		        
		        data: { userId: userId }, 		       
		        success: function(response) {
		            console.log(response);		          
		            let dropdown = $('#userFullNameDropdown'); 
		            dropdown.empty(); 
		            $.each(response, function(index, user) {
		                dropdown.append($('<option>', {
		                    value: user[0],
		                    text: user[1]  
		                }));
		            });
		        },
		        error: function(error) {
		            console.error('Error fetching user full names:', error);
		        }
		    });
		}
		

		
 
	   
	 
		$('#locationmodal').on('click', function() {
			 clearFormHeaderData(); 
       })

	   /*  function checkVictimAggressorInLoop() {
            var Sbino = $('#sbiNumberInput').val();
            var location1 = localStorage.getItem('location1');            
            let parts = location1.split("-");
            var instNum = parts[1].trim();
            var bldNum = $('#bldNumDropdown').val();
            var unitId = $('#unitNumDropdown').val();
            var floorNum = $('#FloorNumDropdown').val();
            var tierNum = $('#tierNumDropdown').val();  
            var bedNo = $('#bedNoInput').val();
            var selectedCellBox = $('.CellBoxes.selected');     
            var selectedcellno = selectedCellBox.data('cellNo');
            var selectedBedNum = selectedCellBox.data('bed-no');
            function makeAjaxCall(num) {
            	console.log(`Making checkVictimAggressor call number: ${num}`);
            
                $.ajax({
                    url: contextPath + 'checkVictimAggressor',
                    type: 'GET',
                    data: {
                    	Sbino: Sbino,
                        instNum: instNum,
                        cellNo: selectedcellno,
                        tierNum: tierNum,
                        floorNum: floorNum,
                        unitId: unitId,
                        bldNum: bldNum,
                        bedNo: selectedBedNum,
                        num: num
                    },
                    success: function(response) {
                    	 console.log(`Response for call number ${num}:`, response);
                    	 if(response === ''){
                    		 triggerCheckRestrictedAjax();
                    		 return;
                    	 }
                    	 if (response.ovc_error_type === 'ERROR') {
                             console.log('Error detected, stopping execution.');
                             triggerCheckRestrictedAjax();
                             return;
                         }

                    	  if (response.ovc_error_type === 'CONFIRM' && response.ovc_error_message === 'NO_MSG') {
                              console.log('Response indicates to stop further iterations.');
                              triggerCheckRestrictedAjax();
                              return; 
                          }
                 
                          if (response.ovc_error_type === 'CONFIRM' && response.ovc_error_message === 'assign') {
                              console.log('Response indicates further actions needed.');
                             
                              return;
                          }
                          if (response.ovc_error_type === 'NO_ASGN') {
                              console.log('Response indicates to exit the procedure.');
                              triggerCheckRestrictedAjax();
                              return; 
                          }
             	                    
                    },
                    error: function(xhr, status, error) {
                        console.error('Request failed: ' + xhr.responseText);
                    }
                });
            }

            for (var i = 1; i <= 5; i++) {
                makeAjaxCall(i);
            }
        }
	      */
      
        
        $('#nomovingout').on('click', function() {
            $('#InfirmaryCheck').prop('disabled', false);
            $('#outsideHospital').prop('disabled', false);
            $('#pco').prop('disabled', false);
        });
        
        $('#movementassignmentokk').on('click', function() {
            insertProtectedOffenderBedStage();
        })
        $('#nonrhsavebutton').on('click', function() {      	
        	checkLocation();
      	  $('#NonRhreason').modal('hide');
        });
        $('#automatically').on('click', function() {      	
        	automaticallyassignBed();      
      });
        
     
      
 

   
	        function fetchReasonQuery(reasonCode,commitNo) {
	            $.ajax({
	                url: contextPath + 'reasonQuery', 
	                type: 'GET',        
	                data: {
	                    reasonCode: reasonCode,
	                    commitNo:commitNo
	                },
	                success: function(response) {          
	                console.log(response.resonrhrow);
	                console.log(response.rhreasonselected);
	                
	                var tableBody = $('#reasonTable tbody');
	                tableBody.empty(); // clear existing rows

	                response.rhreasonselected.forEach(function(item) {
	                    var cbSelect = item[0];      
	                    var refValueCode = item[1];  
	                    var refValueDesc = item[2]; 

	                    var isChecked = cbSelect === "Y" ? ' checked' : '';

	                    var rowHtml = '<tr>' +
	                        '<td>' +
	                        '<div class="custom-control custom-checkbox custom-control-inline ml-2">' +
	                        '<input type="checkbox" class="custom-control-input" id="' + refValueCode + 'Check"' + isChecked + '>' +
	                        '<label class="custom-control-label text-nowrap" for="' + refValueCode + 'Check">' + refValueDesc + '</label>' +
	                        '</div>' +
	                        '</td>' +
	                        '</tr>';

	                    tableBody.append(rowHtml);
	                });

	                },
	                error: function(xhr, status, error) {
	                    console.error("Error occurred: " + error);
	                   
	                }
	            });
	        }
	    });

	    

	
		
		
		$('#showhousingdetails').on('click', function () {
		    console.log('Button clicked');
		    var cellSelected = $('.CellBoxes.selected').length > 0;
		    console.log('Cell selectedshowhousing:', cellSelected);
		    if (!cellSelected) {
		    	 message('CUW','Please select a bed',0);  		   
		    }
		    var selectedCellBox = $('.CellBoxes.selected');
		    var selectedCellNo = selectedCellBox.data('cellNo');
		    var selectedBedNum = selectedCellBox.data('bed-no');
		    var bedStatus = selectedCellBox.data('bed-status');
		    if (bedStatus !== 'O') {
		    	 message('CUW','Please select an occupied Bed.',0);  		      
		    }
		    if (bedStatus === 'O') {
		        console.log('Redirecting to:', contextPath + 'OffenderHousingDetailsHistory');
		        window.location.href = contextPath + 'OffenderHousingDetailsHistory';
		    }
		});
		
	    function disableAllDropdowns() {	    	
	        $('#bldNumDropdown').val('').trigger('change').prop('disabled', true).css('pointer-events', 'none');
	        $('#unitNumDropdown').val('').trigger('change').prop('disabled', true).css('pointer-events', 'none');
	        $('#FloorNumDropdown').val('').trigger('change').prop('disabled', true).css('pointer-events', 'none');
	        $('#tierNumDropdown').val('').trigger('change').prop('disabled', true).css('pointer-events', 'none');
	        $('#cellNumDropdown').val('').trigger('change').prop('disabled', true).css('pointer-events', 'none');


	    }
	
	
	var counters = {
		    'U': 0,
		    'R': 0,
		    'F': 0,
		    'COVID': 0,
		    'O': 0,
		    'C':0,
		    'N':0
		};

		var statusColors = {
		    'U': 'rgb(107 183 107)',   
		    'R': '#3287d4',   
		    'F': '#ff0000',  
		    'COVID': 'rgb(167 109 109)', 
		    'O': 'rgb(238 155 67)',
		    'C':'rgb(87 84 84)',
		    'N':' #0000ff'
		};

		function updateCounters() {
		    $('#occupiedCount').text(`(${counters['O']})`);
		    $('#unoccupiedCount').text(`(${counters['U']})`);
		    $('#noContactCount').text(`(${counters['N']})`);
		    $('#reservedCount').text(`(${counters['R']})`);
		    $('#faultyCount').text(`(${counters['F']})`);
		    $('#RecommandedHousingCount').text(`(${counters['U']})`);
		    // Total beds = O + U + R
		    var totalBeds = (counters['O'] || 0) + (counters['U'] || 0) + (counters['R'] || 0);
		    $('#allbedcount').text(`(${totalBeds})`);

		    $('#currentoffender').text(`(${counters['C']})`);
		}
	
		 

        function triggersearch() {
   
          var reason = localStorage.getItem('reason');
            var occupiedFlag =  updateOccupiedFlag();
           var Sbino = $('#sbiNumberInput').val();
           var location1 = localStorage.getItem('location1');
          var parts = location1.split("-");
           var instNum = parts[1].trim();
             fetchBedCells(Sbino, instNum, bldNum, unitId, floorNum, tierNum, cellNum, occupiedFlag,true);
       }

	    function updateOccupiedFlag() {
	        var occupiedFlag = "";
	        if ($('#AllBedsradio').is(':checked')) {
	            occupiedFlag = null;
	        } else if ($('#Unoccupiedradio').is(':checked')) {
	            occupiedFlag = 'U';
	        } else if ($('#Reservedradio').is(':checked')) {
	            occupiedFlag = 'R';
	        } else if ($('#Occupiedradio').is(':checked')) {
	            occupiedFlag = 'O';
	        }

	        return occupiedFlag;
	    }
	   
	    function fetchBedCells(Sbino, instNum, bldNum, unitId, floorNum, tierNum, cellNum, occupiedFlag, updateCount = true) {
	        fetchCommitNumber();
	        localStorage.removeItem('bldNum');
	        localStorage.removeItem('unitId');
	        localStorage.removeItem('floorNum');
	        localStorage.removeItem('tierNum');
	        localStorage.removeItem('cellNum');

	        localStorage.setItem('bldNum', bldNum);
	        localStorage.setItem('unitId', unitId);
	        localStorage.setItem('floorNum', floorNum);
	        localStorage.setItem('tierNum', tierNum);
	        localStorage.setItem('cellNum', cellNum);

	        $.ajax({
	            url: contextPath + 'bedCell',
	            type: 'GET',
	            data: {
	                Sbino: Sbino,
	                instNum: instNum,
	                bldNum: bldNum,
	                unitId: unitId,
	                floorNum: floorNum,
	                tierNum: tierNum,
	                cellNum: cellNum,
	                occupiedFlag: occupiedFlag
	            },
	            success: function(response) {
	                let currentoffenderbed = false;

	                // ✅ Only update counters if explicitly requested
	                if (updateCount==true) {
	                    counters = { O: 0, U: 0, R: 0, F: 0, N: 0, C: 0, COVID: 0 };
	                    response.forEach(function(bedCell) {
	                        if (bedCell.commitNo === selectedCommit && bedCell.bedStatus === 'O') {
	                            bedCell.bedStatus = 'C';
	                            currentoffenderbed = true;
	                        }
	                        if (bedCell.bedStatus === 'O') {
	                            if (bedCell.covidFlag === 'Y') counters.COVID++;
	                            else counters.O++;
	                        } else if (bedCell.bedStatus === 'U' || !bedCell.bedStatus) counters.U++;
	                        else if (bedCell.bedStatus === 'N') counters.N++;
	                        else if (bedCell.bedStatus === 'R') counters.R++;
	                        else if (bedCell.bedStatus === 'F') counters.F++;
	                        else if (bedCell.bedStatus === 'C') {
	                            if (bedCell.covidFlag === 'Y') counters.COVID++;
	                            else counters.C++;
	                        }
	                    });
	                    updateCountersDisplay();
	                }

	                updateCellBoxes(response, currentoffenderbed);
	            },
	            complete: function() {
	                setTimeout(function() {
	                    loader(0);
	                }, 1500);
	            },
	            error: function(xhr, status, error) {
	                console.error('Error fetching bed cells:', error);
	            }
	        });
	    }

        
	    function updateCountersDisplay() {
	    
	        $('#occupiedCount').text(`(${counters.O})`);
	        $('#unoccupiedCount').text(`(${counters.U})`);
	        $('#reservedCount').text(`(${counters.R})`);
	        $('#RecommandedHousingCount').text(`(${counters.U})`);
	        var totalBeds = (counters.O || 0) + (counters.U || 0) + (counters.R || 0);
	        $('#allbedcount').text(`(${totalBeds})`);
	    }
	    
	    var selectedCellBox = null;
	    var firstCBox = null;

	    function updateCellBoxes(response, prioritizeC = false) {
	        var container = $('#cellBoxContainer');
	        container.empty();
	        firstCBox = null;

	        response.forEach(function(item) {
	            var cellBox = $('<div class="CellBoxes col-lg-1"></div>');
	            var sexIcon = '';
	            if (item.bedSex === 'M') {
	                sexIcon = '<i class="fa fa-mars" style="color:white; margin-right:5px;"></i>';
	            } else if (item.bedSex === 'F') {
	                sexIcon = '<i class="fa fa-venus" style="color:white; margin-right:5px;"></i>';
	            }else if (item.bedSex === 'B') {
	                sexIcon = `
	                    <i class="fa fa-venus" style="color:white; margin-right:5px;"></i>
	                    <i class="fa fa-mars" style="color:white; margin-right:21px;"></i>
	                `;
	            }
	            else if (item.bedSex === 'T') {
	            	  sexIcon = '<i class="fas fa-transgender" style="color:white; margin-right:5px;"></i>';
	            }
	            var displayText = `
	                ${sexIcon}
	                ${item.cellDesc || ' '}<br>
	                ${item.bedDesc || ' '}<br>
	                [${item.bedStatus || ' '}]
	            `;

	            cellBox.html(displayText);
	            if (item.bedStatus === 'U') {
	                cellBox.css('background-color',  'rgb(107 183 107)'); 
	            } else if (item.bedStatus === 'R') {
	                cellBox.css('background-color', '#3287d4'); 
	            } else if (item.bedStatus === 'F') {
	                cellBox.css('background-color', '#ff0000'); 
	            } else if (item.bedStatus === 'O') {
	               
	                    cellBox.css('background-color','rgb(238 155 67)');
	                
	            } else if (item.bedStatus === 'C') {
	                cellBox.css('background-color', 'rgb(87 84 84)');
	                if (firstCBox === null) firstCBox = cellBox; 
	            } else {
	                cellBox.css('background-color', '#d3d3d3'); 
	            }

	            // Existing data binding and click handlers
	            cellBox.data('cellNo', item.cellNo);
	            cellBox.data('bedNo', item.bedNo);
	            cellBox.data('bedStatus', item.bedStatus);
	            cellBox.data('commitNo', item.commitNo);

	            cellBox.on('click', function() {
	                if (selectedCellBox) selectedCellBox.removeClass('selected');
	                $(this).addClass('selected');
	                selectedCellBox = $(this);
	                handleCellBoxClick($(this));
	            });

	            container.append(cellBox);
	        });


	        var totalBoxes = 48; 
	        var missingBoxes = totalBoxes - response.length;
	        for (var i = 0; i < missingBoxes; i++) {
	            var greyedBox = $('<div class="CellBoxes unoccupied"></div>');
	            greyedBox.html(' ').css('background-color', '#d3d3d3');
	            container.append(greyedBox);
	        }

	        if (prioritizeC && firstCBox) {
	            if (selectedCellBox) selectedCellBox.removeClass('selected');
	            firstCBox.addClass('selected');
	            selectedCellBox = firstCBox;
	            handleCellBoxClick(firstCBox);
	        } else {
	            var firstCellBox = container.find('.CellBoxes').not('.unoccupied').first();
	            if (firstCellBox.length > 0) {
	                if (selectedCellBox) selectedCellBox.removeClass('selected');
	                firstCellBox.addClass('selected');
	                selectedCellBox = firstCellBox;
	                handleCellBoxClick(firstCellBox);
	            }
	        }
	    }


	    function handleCellBoxClick(selectedCellBox) {
	        selectedCellBox.addClass('selected');	   
	        var commitNo = selectedCellBox.data('commit-no');
	        var selectedBedNum = selectedCellBox.data('bed-no');
	        var bedStatus = selectedCellBox.data('bed-status');		    				    
	        if (bedStatus !== 'O') {
	            clearOccupiedFields();
	        }
	        var location1 = localStorage.getItem('location1');
	        var instNum = location1.split("-")[1].trim();		    
	        fetchCellInmateDetails(commitNo, instNum);
	        fetchBuildingDetails(instNum, selectedBedNum);
	        fetchBedDetails(selectedBedNum);
	    }

	    function fetchBedDetails(selectedBedNum) {
	        $.ajax({
	            url: contextPath + "getbeddetails",  
	            type: "GET",
	            data: { bedNo: selectedBedNum },
	            success: function(response) {
	            	   var bldNum   = response?.bldNum || '';
	                   var unitId   = response?.unitId || '';
	                   var floorNum = response?.floorNum || '';
	                   var tierNum  = response?.tierNum || '';
	            	
	                localStorage.setItem("bldNum", bldNum);
	                localStorage.setItem("unitId", unitId);
	                localStorage.setItem("floorNum", floorNum);
	                localStorage.setItem("tierNum", tierNum);	            	 	               
	            },
	            error: function(xhr, status, error) {
	                console.error("Error fetching bed details:", error);
	                alert("Failed to fetch bed details.");
	            }
	        });
	    }
	    
	    function checkHandicap() {	    	
            var sbiNo = $('#sbiNumberInput').val();
            var bldNum   = localStorage.getItem("bldNum");
            var unitId   = localStorage.getItem("unitId");
            var floorNum = localStorage.getItem("floorNum");
            var tierNum  = localStorage.getItem("tierNum");
		    var location1 = localStorage.getItem('location1');    
		    var parts = location1.split("-");
		    var instNum = parts[1].trim();
		    var selectedCellBox = $('.CellBoxes.selected');     
		    var cellNo = selectedCellBox.data('cellNo');
		    var bedNo = selectedCellBox.data('bed-no');
	        $.ajax({
	            url:  contextPath + 'checkhandicap',  
	            type: 'GET', 
	            data: {
	            	sbiNo:sbiNo,
	                instNum: instNum,
	                bldNum: bldNum,
	                unitId: unitId,     
	                floorNum: floorNum,
	                tierNum: tierNum,
	                cellNo: cellNo,
	                bedNo: bedNo
	            },
	            success: function(response) {	               	             
	                let allMatches = true;                    
	                    if (response.p_hanmatch === "N") {	                	
	                    	message('CH0',0,0);
	                        allMatches = false;                      
	                    }	                    
	                    if (response.p_sexmatch === "N") {
	                        message('CH1',0,0);
	                        allMatches = false;                       
	                    }                    
	                    if (response.P_juvenile_match === "N") {
	                    	message('CH2',0,0);
	                        allMatches = false;	                     
	                    }
	                 if (response.p_program_match === "N") {	                	
	                    	message('CH3',0,0);
	                        allMatches = false;	                       
	                    } 	                  	                   
	                    if (allMatches) {		                    	
	                    	 $.ajax({
	             	            url: 'vitalcommitNo',
	             	            method: 'GET',
	             	            data: { parameter: sbiNo },
	             	            success: function(data) {
	             	                selectedCommit = data; 
	             	               checkSecurity(selectedCommit, bedNo)    
	             	            },
	             	            error: function(xhr, status, error) {
	             	                console.error('Error fetching commit number:', error);
	             	            }
	             	        });
	                    	       	                               
	                    }
	            },
	            error: function(jqXHR, textStatus, errorThrown) {
	                console.error("Error: " + textStatus, errorThrown);
	             
	            }
	        });
	    }
	    
	    function checkSecurity(commitNo, bedNo) {
	    	  var sbiNo = $('#sbiNumberInput').val();
	    	 var selectedCellBox = $('.CellBoxes.selected');
	            var bedNo = selectedCellBox.data('bed-no');          
	        $.ajax({
	            url: contextPath + 'checkSecurity',
	            type: "GET",
	            data: { sbiNo: sbiNo, bedNo: bedNo },
	            success: function(response) {
	            	if (response==2){
	            		checkLocation();
	            	}	                	    	                
	            },
	            error: function(xhr) {
	               
	            }
	        });
	    }
	    
	    function checkLocation() {
	    	 var sbiNo = $('#sbiNumberInput').val();
	    	 var userId = localStorage.getItem('userId');
	        $.ajax({
	            url: 'checkLocation',
	            type: 'GET',
	            data: {
	            	sbiNo: sbiNo,
	                user: userId ,
	            },
	            success: function(response) {
	            console.log(response);	          
	                var dateTimeOfArr = response.dateTimeOfArr;
	                var countLocCodeTo = response.countLocCodeTo;
	                var houLocation = response.houLocation;
	             
	                if (dateTimeOfArr === null || countLocCodeTo !== houLocation) {	                	 	                	
	                        $('#checklocationmodal').modal('show');
	                   
	                }else if(houLocation===countLocCodeTo){	           	                	
	                	 assignBed();
	                }
	            },
	            error: function(err) {
	                console.error("Error checking location:", err);
	            }
	        });
	    }

	    function fetchCommitNumber(callback) {
	        var sbiNumberInput = $('#sbiNumberInput').val();
	        $.ajax({
	            url: 'vitalcommitNo',
	            method: 'GET',
	            data: { parameter: sbiNumberInput },
	            success: function(data) {
	                selectedCommit = data; 
	                if (callback) {
	                    callback(); 
	                }
	            },
	            error: function(xhr, status, error) {
	                console.error('Error fetching commit number:', error);
	            }
	        });
	    }
	    
	    function assignBed() {         
            fetchCommitNumber(doAssignBed); 
        }
        
      
        function automaticallyassignBed(sbino, instNum, bldNum, unitId, floorNum, tierNum, selectedCellNo, selectedBedNum, action, startDateTime, reason, endDateTime, nonRhRsnFlag) {
        	var bldNum   = localStorage.getItem("bldNum");
	    	var unitId   = localStorage.getItem("unitId");
	    	var floorNum = localStorage.getItem("floorNum");
	    	var tierNum  = localStorage.getItem("tierNum");       
               var reason = $('#reasonDropDown').val();
               /* var reasonString =reason.join(',');  */
               var startDate = $('#reasondate').val();
              var startDateTime= convertToMMDDYYYY(startDate);             
               var endDate = $('#enddate').val();
              var endDateTime = convertToMMDDYYYY(endDate);
               var cellSelected = $('.CellBoxes.selected').length > 0;
               var selectedCellBox = $('.CellBoxes.selected');
               var commitNo = selectedCellBox.data('commit-no');
               var selectedcellno = selectedCellBox.data('cellNo');
               var selectedBedNum = selectedCellBox.data('bed-no');
               var sbino = $('#sbiNumberInput').val();
               var userId = localStorage.getItem('userId');         
               var location1 = localStorage.getItem('location1');
               var parts = location1.split("-");
               var instNum = parts[1].trim();
               var action='ASSIGN'
              var occupiedFlag=null;
               var nonRhRsnFlag=null;
               /* fetchCommitNumber(assignBed);  */
        	$.ajax({
                url: contextPath + 'assignbed',
                method: 'POST',  
                data: {
                    sbino: sbino,
                    instNum: instNum,
                    buildNum: bldNum,
                    unitId: unitId,
                    floorNum: floorNum,
                    tierNum: tierNum,
                    cellNo: selectedcellno,
                    bedNo: selectedBedNum,
                    action: action,
                    stDateTime: startDateTime,
                    resnCode: reason,
                    toDate: endDateTime,
                    nonRhRsnFlag: nonRhRsnFlag
                },
                success: function(response) {                   
                    $('#securitymodal').modal('hide');
                      message('S',0,0);
                     
                    $.ajax({
                        url: contextPath + "spupdatefornotselected",
                        method: "GET",
                        data: { commitNo: selectedCommit,
                        	userId:userId},
                        success: function(procResponse) {
                            console.log("Procedure executed:", procResponse);
                            // ✅ Explicitly refresh bed cells
                            fetchBedCells(
                                sbino,         // offender number
                                instNum,       // institution number
                                bldNum,        // building
                                unitId,        // unit
                                floorNum,      // floor
                                tierNum,       // tier
                                null,          // cellNum
                                null,          // occupiedFlag (null = show all)
                                true           // update counters
                            );
                            $('#bedTabs .nav-link').removeClass('active');
                            $('#bedTabsContent .tab-pane').removeClass('active show');
                            $('#AllBeds-tab').addClass('active');
                            $('#AllBeds').addClass('active show');
                        },
                        error: function(jqXHR, textStatus, errorThrown) {
                            console.error("Error calling procedure:", textStatus, errorThrown);
                        }
                    }); 
                    
                   /*  setTimeout(callFetchBedCells, 300); // ✅ safer
                    $('#bedcellselected').click();                  
        	        fetchCellInmateDetails(commitNo, instNum);
        	 	    setTimeout(function() {            	     
            	            $('#bedcellselect').trigger('click');
            	            $('.CellBoxes.selected').removeClass('selected');
            	          
            	    }, 100);       	 	  
	                updateCounters(); */
	                callFetchBedCells();
	                selectedCellBox.removeClass('selected'); 	                	      
                },
                error: function(jqXHR, textStatus, errorThrown) {
                    // Handle AJAX error
                    console.error("Error assigning bed:", textStatus, errorThrown);
                    alert("Error occurred while assigning bed. Please try again.");
                }
            });
        }

	    
	    function doAssignBed(){      	
	    	var bldNum   = localStorage.getItem("bldNum");
	    	var unitId   = localStorage.getItem("unitId");
	    	var floorNum = localStorage.getItem("floorNum");
	    	var tierNum  = localStorage.getItem("tierNum");        
            var reason = $('#reasonDropDown').val(); 
            var startDate = $('#reasondate').val();
            var startDateTime= convertToMMDDYYYY(startDate);
            var endDate = $('#enddate').val();
            var endDateTime = convertToMMDDYYYY(endDate);
            var userId = localStorage.getItem('userId');         
            var cellSelected = $('.CellBoxes.selected').length > 0;
            var selectedCellBox = $('.CellBoxes.selected');
            var selectedcellno = selectedCellBox.data('cellNo');
            var selectedBedNum = selectedCellBox.data('bed-no');
            var sbino = $('#sbiNumberInput').val();
            var location1 = localStorage.getItem('location1');
            var parts = location1.split("-");
            var instNum = parts[1].trim();
            var action='ASSIGN'
            var  nonRhRsnFlag = null 
            var occupiedFlag=null
            $.ajax({
                url: contextPath + 'assignbed',
                method: 'POST',
                data: {
                    sbino: sbino,
                    instNum: instNum,
                    buildNum: bldNum,
                    unitId: unitId,
                    floorNum: floorNum,
                    tierNum: tierNum,
                    cellNo: selectedcellno,
                    bedNo: selectedBedNum,
                    action: action,
                    stDateTime: startDateTime,
                    resnCode: reason,
                    toDate: endDateTime,
                    nonRhRsnFlag: nonRhRsnFlag,
                    userId:userId
                },
                success: function(response) {     
                	  $('#NonRhreason').modal('hide');  
                	  message('S',0,0);
                      $.ajax({
                          url: contextPath + "spupdatefornotselected",
                          method: "GET",
                          data: { commitNo: selectedCommit,
                        	  userId:userId  }, 
                          success: function(procResponse) {
                              console.log("Procedure executed:", procResponse);
                              // ✅ Explicitly refresh bed cells
                              fetchBedCells(
                                  sbino,        
                                  instNum,       
                                  bldNum,      
                                  unitId,       
                                  floorNum,      
                                  tierNum,       
                                  null,          
                                  null,       
                                  true         
                              );
                              $('#bedTabs .nav-link').removeClass('active');
                              $('#bedTabsContent .tab-pane').removeClass('active show');
                              $('#AllBeds-tab').addClass('active');
                              $('#AllBeds').addClass('active show');
                          },
                          error: function(jqXHR, textStatus, errorThrown) {
                              console.error("Error calling procedure:", textStatus, errorThrown);
                          }
                      }); 
             
                	  message('S',0,0);   
                      localStorage.removeItem('bldNum');
            	        localStorage.removeItem('unitId');
            	        localStorage.removeItem('floorNum');
            	        localStorage.removeItem('tierNum');
            	        localStorage.removeItem('cellNum');
                	    selectedCellBox.removeClass('selected');                  	                 	                	              	 
                },
                error: function(xhr, status, error) {
                    alert('Error executing procedure: ' + xhr.responseText);
                }
            });
        }

	   
	    // inmate details for occupied bed in occupied/reserved/No contact detail fields //
	       function fetchCellInmateDetails(commitNo, instNum) {
	    		    clearOccupiedFields();
	    		    var location1 = localStorage.getItem('location1');
	    		    let parts = location1.split("-");
	    		    var instNum = parts[1].trim();
	    		    var selectedCellBox = $('.CellBoxes.selected'); 
	    		    var selectedcomitno = selectedCellBox.data('commit-no');
	    		    var selectedcellno = selectedCellBox.data('cellNo');
	    		    var selectedBedNum = selectedCellBox.data('bed-no');

	    		    $.ajax({
	    		        url: contextPath + 'cellinmateDetails',
	    		        type: 'GET',
	    		        data: { commitNo: selectedcomitno, instNum: instNum },
	    		        success: function(response) {
	    		            $('#showhousingdetails').removeAttr('disabled');
	    		            $('#showhousingdetails').removeAttr('readonly');
	    		            $('#showhousingdetails').css('pointer-events', '');
	    		            let dataArray = [];
	    		            if (Array.isArray(response)) {
	    		                dataArray = response;
	    		            } else if (response && typeof response === 'object') {
	    		                dataArray = [response]; 
	    		            }

	    		            if (dataArray.length > 0) {
	    		                populateInmateDetails(dataArray[0]);
	    		            } else {
	    		                console.error('Unexpected response format:', response);
	    		            }
	    		        },
	    		        error: function(error) {
	    		            console.error('CellinmateDetails Error:', error);
	    		        }
	    		    });
	    		}
	    		    
	    		function populateInmateDetails(data) {
	    		    $('#occupiedsbino').css('pointer-events', 'auto').val(data.SBI_MST_SBI_NO || '');
	    		    let fullName = 
	    		        (data.COMMIT_LNAME || '') + ' ' +
	    		        (data.COMMIT_FNAME || '') + ' ' +
	    		        (data.COMMIT_MNAME || '') + ' ' +
	    		        (data.COMMIT_SNAME || '');
	    		    let fullnamedisplay = formatName(fullName.trim());	    
	    		    $('#occupiedname').css('pointer-events', 'auto').val(fullnamedisplay);
	    		    $('#occupieddob').css('pointer-events', 'auto').val(
	    		        data.PRIMARY_DOB ? convertToMMDDYYYY(data.PRIMARY_DOB.split('T')[0]) : ''
	    		    );
	    		    $('#occupiedsex').css('pointer-events', 'auto').val(data.SEX || '');
	    		    $('#occupiedrace').css('pointer-events', 'auto').val(data.RACE_CODE || '');		  
	    		    $('#occupiedrhreason').css('pointer-events', 'auto').val(data.RH_REASON || '');
	    		    $('#showhousingdetails').removeAttr('disabled');
	    		    $('#protectedoffbtn').removeAttr('disabled');	    
	    		    const releaseFieldKey = "DECODE(:B2,ADD_MONTHS(TRUNC(SYSDATE),12*600),'INDEFINITE',TO_CHAR(:B2,'MM/DD/RRRR'))";
	    		    const releaseVal = data[releaseFieldKey];
	    		    let display = '';
	    		    if (releaseVal && releaseVal !== 'INDEFINITE') {
	    		        const [mm, dd, yyyy] = releaseVal.split('/');
	    		        const dateObj = new Date(`${yyyy}-${mm}-${dd}`);
	    		        display = !isNaN(dateObj) ? dateObj.toLocaleDateString() : releaseVal;
	    		    } else {
	    		        display = releaseVal || '';
	    		    }
	    		    $('#occupiedreleaseDate')
	    		        .css('pointer-events', 'auto')
	    		        .val(display);
	    		}
	    		
	    		
	    		//function for displaying building details in selected bed details text area//
	    			function fetchBuildingDetails(instNum, bedNo) {
	    		    $.ajax({
	    		        url: contextPath + 'buildingsdetails',
	    		        type: 'GET',
	    		        data: { instNum: instNum, bedNo: bedNo },
	    		        success: function(data) {
	    		            console.log(data);
	    		            var resultsDiv = $('#results');
	    		            var selBedDtlsInput = $('#sel_bed_dtls');
	    		            resultsDiv.empty();
	    		            if (data.length > 0) {
	    		                var resultsText = data.map(function(row) {
	    		                    return row.join(' | ');
	    		                }).join('\n');

	    		                data.forEach(function(row) {
	    		                    var rowHtml = '<div>' + row.join(' | ') + '</div>';
	    		                    resultsDiv.append(rowHtml);
	    		                });
	    		            
	    		                selBedDtlsInput.val(resultsText);
	    		            } else {
	    		                resultsDiv.append('<div>No results found.</div>');
	    		                selBedDtlsInput.val('No results found.');
	    		            }
	    		        },
	    		        error: function(xhr, status, error) {
	    		            $('#results').html('<div>An error occurred: ' + error + '</div>');		       
	    		        }
	    		    });
	    		}
	    		
	    		
	    			
	    			 /////////// clear funtion for clear button ///////////	
	    			 
	    			 
	    			$('#clear-btn').on('click', function() {
	    			    $('#AllBedsradio').prop('disabled', true);
	    			    $('#Unoccupiedradio').prop('disabled', true);
	    			    $('#Reservedradio').prop('disabled', true);
	    			    $('#Occupiedradio').prop('disabled', true);
	    			    clearFormHeaderData();
	    			    var totalBoxes = 48;
	    			    var cellBoxesContainer = $('#cellBoxContainer');
	    			    cellBoxesContainer.empty();
	    			    for (var i = 0; i < totalBoxes; i++) {
	    			        var greyedBox = $('<div class="CellBoxes unoccupied"></div>');
	    			        greyedBox.html(' ').css('background-color', '#d3d3d3');
	    			        cellBoxesContainer.append(greyedBox);
	    			    }
	    			    $(".sidebartest").empty();
	    			  
	    			    $('#ocuupiedrhreasonstatus').val('').css('pointer-events', 'auto');
	    			    localStorage.removeItem('bldNum');
	    			    localStorage.removeItem('unitId');
	    			    localStorage.removeItem('floorNum');
	    			    localStorage.removeItem('tierNum');
	    			    localStorage.removeItem('cellNum');		   
	    			    localStorage.removeItem('location1');		   		   
	    			    $('#reasonDropDown').empty().append('<option value="">Select Reason</option>');
	    			    $('#bldNumDropdown, #unitNumDropdown, #FloorNumDropdown, #tierNumDropdown, #cellNumDropdown')
	    			        .val('') 
	    			        .empty()
	    			        .attr('disabled', 'disabled')
	    			        .css('pointer-events', 'none');
	    			    clearInmateDetails();		            	 
	    			    document.getElementById('sel_bed_dtls').value = '';
	    			    document.querySelector("#dt-basic-example tbody").innerHTML = "";
	    			    $('.CellBoxes').removeClass('selected');
	    			    
	    			});


	    			$('#clearbtnselecthousingunit').on('click', function() {	    
	    			    var totalBoxes = 48;
	    			    var cellBoxesContainer = $('#cellBoxContainer');
	    			    cellBoxesContainer.empty();
	    			    for (var i = 0; i < totalBoxes; i++) {
	    			        var greyedBox = $('<div class="CellBoxes unoccupied"></div>');
	    			        greyedBox.html(' ').css('background-color', '#d3d3d3');
	    			        cellBoxesContainer.append(greyedBox);
	    			    }
	    			    $(".sidebartest").empty();
	    			  
	    			    localStorage.removeItem('location1');		      
	    			    $('#bldNumDropdown, #unitNumDropdown, #FloorNumDropdown, #tierNumDropdown, #cellNumDropdown,#reasonDropDown')
	    			        .val('')
	    			        .empty()
	    			        .attr('disabled', 'disabled')
	    			        .css('pointer-events', 'none');

	    			    clearInmateDetails();
	    			    localStorage.removeItem('bldNum');
	    			    localStorage.removeItem('unitId');
	    			    localStorage.removeItem('floorNum');
	    			    localStorage.removeItem('tierNum');
	    			    localStorage.removeItem('cellNum');		   
	    			    localStorage.removeItem('location1');		
	    			    document.getElementById('sel_bed_dtls').value = '';
	    			    $('#AllBedsradio').prop('disabled', true);
	    			    $('#Unoccupiedradio').prop('disabled', true);
	    			    $('#Reservedradio').prop('disabled', true);
	    			    $('#Occupiedradio').prop('disabled', true);
	    			    $('#reasondate').removeAttr('disabled').removeAttr('readonly').css('pointer-events', 'auto');
	    			    $('#reasontime').removeAttr('disabled').removeAttr('readonly').css('pointer-events', 'auto');
	    			    $('#reasonDropDown').val('').removeAttr('disabled').removeAttr('readonly').css('pointer-events', 'auto');
	    			    $('#enddate').removeAttr('disabled').removeAttr('readonly').css('pointer-events', 'auto');
	    			    $('#endtime').removeAttr('disabled').removeAttr('readonly').css('pointer-events', 'auto');
	    			    $('#searchButton').trigger('click');		
	    			    $('.CellBoxes').removeClass('selected');
	    			});


	    			
	    			function clearInmateDetails() {
	    				  $('#occupiedsbino').val('').css('pointer-events', 'auto');
	    				  $('#occupiedname').val('').css('pointer-events', 'auto');
	    				  $('#occupieddob').val('').css('pointer-events', 'auto');
	    				  $('#occupiedsex').val('').css('pointer-events', 'auto');
	    				  $('#occupiedrace').val('').css('pointer-events', 'auto');
	    				  $('#occupiedrhreason').val('').css('pointer-events', 'auto');
	    				  $('#reasondate').val('').css('pointer-events', 'auto');
	    				  $('#reasontime').val('').css('pointer-events', 'auto');
	    				  $('#enddate').val('').css('pointer-events', 'auto');
	    				  $('#endtime').val('').css('pointer-events', 'auto');	
	    				  $(' #occupiedreleaseDate').val('').css('pointer-events', 'auto');		 
	    				  $('#showhousingdetails').attr('disabled', true);
	    				  $("#allbedcount").text(" (0)");
		    			    $("#unoccupiedCount").text(" (0)");
		    			    $("#reservedCount").text(" (0)");
		    			    $("#occupiedCount").text(" (0)");
		    			    $("#RecommandedHousingCount").text(" (0)");
	    				  $('#currentoffender').text(`Current Offender(${'0'})`);	   				   
	    				}
	    		
		function clearOccupiedFields() {
		    $('#occupiedsbino, #occupiedname, #occupieddob, #occupiedsex, #occupiedrace, #occupiedreleaseDate, #occupiedrhreason')
		        .val('')
		        .attr('disabled', 'disabled')
		        .css('pointer-events', 'none');
		    $('#showhousingdetails, #protectedoffbtn').attr('disabled', 'disabled');
		}

		
		
	
	
//end//	      	 
	   
	


	$(document).ready(function () {	  
		
			$(function () {
				$('.select2').select2();

				$(".select2-placeholder-multiple").select2(
					{
						placeholder: "Select State"
					});
				$(".js-hide-search").select2(
					{
						minimumResultsForSearch: 1 / 0
					});
				$(".js-max-length").select2(
					{
						maximumSelectionLength: 2,
						placeholder: "Select maximum 2 items"
					});
				$(".select2-placeholder").select2(
					{
						placeholder: "Select a state",
						allowClear: true
					});



				$(".js-select2-icons").select2(
					{
						minimumResultsForSearch: 1 / 0,
						templateResult: icon,
						templateSelection: icon,
						escapeMarkup: function (elm) {
							return elm
						}
					});

				function icon(elm) {
					elm.element;
					return elm.id ? "<i class='" + $(elm.element).data("icon") + " mr-2'></i>" + elm.text : elm.text
				}

				$(".js-data-example-ajax").select2(
					{
						ajax:
						{
							url: "https://api.github.com/search/repositories",
							dataType: 'json',
							delay: 250,
							data: function (params) {
								return {
									q: params.term, // search term
									page: params.page
								};
							},
							processResults: function (data, params) {
								// parse the results into the format expected by Select2
								// since we are using custom formatting functions we do not need to
								// alter the remote JSON data, except to indicate that infinite
								// scrolling can be used
								params.page = params.page || 1;

								return {
									results: data.items,
									pagination:
									{
										more: (params.page * 30) < data.total_count
									}
								};
							},
							cache: true
						},
						placeholder: 'Search for a repository',
						escapeMarkup: function (markup) {
							return markup;
						}, // let our custom formatter work
						minimumInputLength: 1,
						templateResult: formatRepo,
						templateSelection: formatRepoSelection
					});

				function formatRepo(repo) {
					if (repo.loading) {
						return repo.text;
					}

					var markup = "<div class='select2-result-repository clearfix d-flex'>" +
						"<div class='select2-result-repository__avatar mr-2'><img src='" + repo.owner.avatar_url + "' class='width-2 height-2 mt-1 rounded' /></div>" +
						"<div class='select2-result-repository__meta'>" +
						"<div class='select2-result-repository__title fs-lg fw-500'>" + repo.full_name + "</div>";

					if (repo.description) {
						markup += "<div class='select2-result-repository__description fs-xs opacity-80 mb-1'>" + repo.description + "</div>";
					}

					markup += "<div class='select2-result-repository__statistics d-flex fs-sm'>" +
						"<div class='select2-result-repository__forks mr-2'><i class='fal fa-lightbulb'></i> " + repo.forks_count + " Forks</div>" +
						"<div class='select2-result-repository__stargazers mr-2'><i class='fal fa-star'></i> " + repo.stargazers_count + " Stars</div>" +
						"<div class='select2-result-repository__watchers mr-2'><i class='fal fa-eye'></i> " + repo.watchers_count + " Watchers</div>" +
						"</div>" +
						"</div></div>";

					return markup;
				}

				function formatRepoSelection(repo) {
					return repo.full_name || repo.text;
				}

			});
			
					/* 	getAttrModify(); */

			function getAttrModify() {
				var scrncode = $('#screenCode').val();
				$.ajax({
					type: "POST",
					url: contextPath + "getAttr",
					dataType: "json",
					data: {screenCode: scrncode},
					success: function (response) {

						for (var i = 0; i < response.length; i++) {

							//var ide = $("[name='" + response[i]['FIELD_NAME'] + "']").attr("id");

							if (response[i]['READ_ONLY_FLAG'] == 'Y') {
								$("." + response[i]['FIELD_NAME']).attr('readonly', true);
								$("." + response[i]['FIELD_NAME']).css('pointer-events', 'none');
								$("." + response[i]['FIELD_NAME']).attr('disabled', true);
							}

							if (response[i]['MANDATORY_FLAG'] == 'Y') {
								var txt = $(".lbl-" + response[i]['FIELD_NAME']).text();
								$(".lbl-" + response[i]['FIELD_NAME']).html(txt + "<span class='text-danger'>*</span>");
								$("." + response[i]['FIELD_NAME']).addClass('mandatory');
							}

							/*if (response[i]['MANDATORY_FLAG'] == 'Y') {
								$('label[for="' + ide + '"]').html(response[i]['FIELD_LABEL'] + "<span style='color:#f00;'>*</span>");
								$('#' + ide).addClass('mandatory');
							} else {
								$('label[for="' + ide + '"]').html(response[i]['FIELD_LABEL']);
								$('#' + ide).removeClass('mandatory');
							}*/


						}

					},
					error: function () {
						/* alert("json not found"); */
					}
				});
			}

		/* 	getLOV(); */

			function getLOV() {
				var scrncode = $('#screenCode').val();

				console.log('scrncode is ' + scrncode);

				$.ajax({
					url: contextPath + 'getLOV',
					method: 'POST',
					dataType: "json",
					data: {screenCode: scrncode},
					success: function (response) {
						for (var i = 0; i < response.length; i++) {
							console.log(response[i]['ALGORITHM_QUERY'] + " for " + response[i]['FIELD_NAME']);

							var cat = response[i]['ALGORITHM_QUERY'].split('::')[0];
							var vals = response[i]['ALGORITHM_QUERY'].split('::')[1];

							if (cat == 'hardcoded' && vals != '') {
								vals = vals.split(',');
								var content = '<option value="">Select ' + response[i]['FIELD_LABEL'] + '</option>';
								for (var j = 0; j < vals.length; j++) {
									content += '<option value="' + vals[j].split(':')[0] + '">' + vals[j].split(':')[1] + '</option>';
								}

								$('.' + response[i]['FIELD_NAME']).html(content);
							}

							if (cat == 'query' && vals != '') {
								setOption(vals, response[i]['FIELD_NAME'], response[i]['FIELD_LABEL']);
							}

						}
					},
					error: function (error) {
						//console.error("Error getting table names:", error);
					}
				});
			}

		/* 	getValid(); */

			function getValid() {
				var scrncode = $('#screenCode').val();

				console.log('scrncode is ' + scrncode);

				$.ajax({
					url: contextPath + 'getValid',
					method: 'POST',
					dataType: "json",
					data: {screenCode: scrncode},
					success: function (response) {

						console.log('asif try 1');
						console.log('response.length : ' + response.length);

						for (var i = 0; i < response.length; i++) {
							console.log(response[i]['VALIDATION_LOGIC'] + " for " + response[i]['FIELD_NAME']);

							var typ = response[i]['VALIDATION_LOGIC'].split('::')[0];
							var rul = response[i]['VALIDATION_LOGIC'].split('::')[1];
							var len = response[i]['VALIDATION_LOGIC'].split('::')[2];

							if (typ == 'Text') {
								if (rul == 'Number') {
									$('.' + response[i]['FIELD_NAME']).addClass('num');
								}

								if (rul == 'Email') {
									$('.' + response[i]['FIELD_NAME']).addClass('mail');
								}

								if (len != 'X' && len > 0) {
									$('.' + response[i]['FIELD_NAME']).prop('maxlength', len);
								}
							} else if (typ == 'Date') {
								rules = rul.split(",");

								var min = '';
								var max = '';
								var ddates = [];

								for (var j = 0; j < rules.length; j++) {
									var rule = rules[j].split(":")[0];
									var value = rules[j].split(":")[1].split('|||')[0];
									switch (rule) {
										case 'mindt':
											min = chkToday(value);
											break;
										case 'maxdt':
											max = chkToday(value);
											break;
										case 'mindt+':
											min = differDay(chkToday(value), 'N');
											break;
										case 'maxdt-':
											max = differDay(chkToday(value), 'P');
											break;
										case 'not':
											ddates.push(chkToday(value));
											break;
									}

								}

								//alert(response[i]['FIELD_NAME']);
								var valid_info = min + '::' + max + '::' + ddates.join(',');
								$('#' + response[i]['FIELD_NAME']).attr('data-valid', valid_info);
								$('#' + response[i]['FIELD_NAME']).attr('data-check', rul);
								applyRange(min, max, ddates, response[i]['FIELD_NAME']);
							}



							/*
							if (cat == 'hardcoded' && vals != '') {
								vals = vals.split(',');
								var content = '<option value="">Select ' + response[i]['FIELD_LABEL'] + '</option>';
								for (var j = 0; j < vals.length; j++) {
									content += '<option value="' + vals[j].split(':')[0] + '">' + vals[j].split(':')[1] + '</option>';
								}
	
								$('.' + response[i]['FIELD_NAME']).html(content);
							}
	
							if (cat == 'query' && vals != '') {
								setOption(vals, response[i]['FIELD_NAME'], response[i]['FIELD_LABEL']);
							}
							*/

						}
					},
					error: function (error) {
						//console.error("Error getting table names:", error);
					}
				});
			}

			function setOption(vals, field, label) {
				$.ajax({
					url: contextPath + 'getVals',
					method: 'POST',
					dataType: "json",
					data: {vals: vals},
					success: function (response) {
						var content = '<option value="">Select ' + label + '</option>';
						for (var i = 0; i < response.length; i++) {
							content += '<option value="' + response[i]['VAL'] + '">' + response[i]['OPT'] + '</option>';
						}
						$('.' + field).html(content);
					},
					error: function (error) {
						//console.error("Error getting table names:", error);
					}
				});
			}

			function applyRange(min, max, ddates, cls) {

				if (min == '') {
					min = null;
				}

				if (max == '') {
					max = null;
				}

				$("." + cls).datepicker({
					dateFormat: "mm/dd/yy",
					minDate: min,
					maxDate: max,
					beforeShowDay: function (date) {
						var string = jQuery.datepicker.formatDate('mm/dd/yy', date);
						return [ddates.indexOf(string) == -1];
					}
				});

				$("." + cls).attr("autocomplete", "off");

			}

			function chkToday(str) {
				if (str == 'today') {
					const d = new Date();
					let year = d.getFullYear();
					let month = d.getMonth() + 1;
					let date = d.getDate();
					str = padDigits(month, 2) + "/" + padDigits(date, 2) + "/" + padDigits(year, 4);
				}

				console.log('str check ' + str);

				return str;
			}

			function padDigits(number, digits) {
				return Array(Math.max(digits - String(number).length + 1, 0)).join(0) + number;
			}

			function differDay(dt, diff) {
				var day = new Date(dt);

				var nd = new Date(day);
				if (diff == 'N') {
					nd.setDate(day.getDate() + 1);
				} else {
					nd.setDate(day.getDate() - 1);
				}

				let year = nd.getFullYear();
				let month = nd.getMonth() + 1;
				let date = nd.getDate();
				var str = padDigits(month, 2) + "/" + padDigits(date, 2) + "/" + padDigits(year, 4);
				return str;
			}

			$(document).on('blur', '.hasDatepicker', function () {
				var fld = $(this).attr('data-field');
				if ($(this).val() != '') {
					var mydate = $(this).val();
					if (!valDate(mydate)) {
						$(this).val('');
						//alert("Invalid Date");
						Swal.fire('Alert', 'Date is not valid', 'warning');
					} else {
						var newdt = padDigits(mydate.split("/")[0], 2) + "/" + padDigits(mydate.split("/")[1], 2) + "/" + mydate.split("/")[2];

						if (dateCheck(newdt, fld) != '') {
							$(this).val('');
							var msg = dateCheck(newdt, fld);
							Swal.fire('Alert', msg, 'warning');
							return;
						}

						if (checkAvailable(newdt, fld)) {
							$(this).val(newdt);
						} else {

							$(this).val('');

							var date_check = $('#' + fld).attr('data-check');

							date_rules = date_check.split(',');

							for (var i = 0; i < date_rules.length; i++) {

								if (!date_rules[i].includes('today')) {
									//console.log('here some specific : ' + date_rules[i]);

									if (date_rules[i].includes('not:')) {
										var getdt = date_rules[i].split("not:")[1].split("|||")[0];
										var getmsg = date_rules[i].split("not:")[1].split("|||")[1];
										if (newdt == getdt) {
											if (getmsg != '') {
												Swal.fire('Alert', getmsg, 'warning');
												return;
											}
										}
									}

									if (date_rules[i].includes('maxdt-:')) {
										var getdt = date_rules[i].split("maxdt-:")[1].split("|||")[0];
										var getmsg = date_rules[i].split("maxdt-:")[1].split("|||")[1];

										var d1 = new Date(newdt.split('/')[2], newdt.split('/')[0] - 1, newdt.split('/')[1]);
										var d2 = new Date(getdt.split('/')[2], getdt.split('/')[0] - 1, getdt.split('/')[1]);

										if (newdt == getdt || d1 > d2) {
											if (getmsg != '') {
												Swal.fire('Alert', getmsg, 'warning');
												return;
											}
										}
									}

									if (date_rules[i].includes('mindt+:')) {
										var getdt = date_rules[i].split("mindt+:")[1].split("|||")[0];
										var getmsg = date_rules[i].split("mindt+:")[1].split("|||")[1];

										var d1 = new Date(newdt.split('/')[2], newdt.split('/')[0] - 1, newdt.split('/')[1]);
										var d2 = new Date(getdt.split('/')[2], getdt.split('/')[0] - 1, getdt.split('/')[1]);

										if (newdt == getdt || d1 < d2) {
											if (getmsg != '') {
												Swal.fire('Alert', getmsg, 'warning');
												return;
											}
										}
									}

									if (date_rules[i].includes('maxdt:')) {
										var getdt = date_rules[i].split("maxdt:")[1].split("|||")[0];
										var getmsg = date_rules[i].split("maxdt:")[1].split("|||")[1];

										var d1 = new Date(newdt.split('/')[2], newdt.split('/')[0] - 1, newdt.split('/')[1]);
										var d2 = new Date(getdt.split('/')[2], getdt.split('/')[0] - 1, getdt.split('/')[1]);

										if (d1 > d2) {
											if (getmsg != '') {
												Swal.fire('Alert', getmsg, 'warning');
												return;
											}
										}
									}

									if (date_rules[i].includes('mindt:')) {
										var getdt = date_rules[i].split("mindt:")[1].split("|||")[0];
										var getmsg = date_rules[i].split("mindt:")[1].split("|||")[1];

										console.log('test alpha : ' + newdt);
										console.log('test beta : ' + getdt);

										var d1 = new Date(newdt.split('/')[2], newdt.split('/')[0] - 1, newdt.split('/')[1]);
										var d2 = new Date(getdt.split('/')[2], getdt.split('/')[0] - 1, getdt.split('/')[1]);

										if (d1 < d2) {
											if (getmsg != '') {
												Swal.fire('Alert', getmsg, 'warning');
												return;
											}
										}
									}


								}

							}

							//alert("Disabled Date Not Allowed");
							Swal.fire('Alert', 'You cannot enter this date ' + newdt, 'warning');
						}

					}
				}
			});

			function dateCheck(dt, fld) {
				var date_check = $('#' + fld).attr('data-check');
				var ret_msg = '';

				const d = new Date();
				let year = d.getFullYear();
				let month = d.getMonth() + 1;
				let date = d.getDate();
				var today = padDigits(month, 2) + "/" + padDigits(date, 2) + "/" + padDigits(year, 4);

				if (dt == today) {
					/*if(date_check.includes('not:today') || date_check.includes('maxdt-:today') || date_check.includes('mindt+:today')) {
						ret_msg = 'You cannot able to enter today date';
					}*/

					if (date_check.includes('not:today')) {

						//console.log('Test: ' + date_check.split('not:today')[1].split(',')[0].split('|||')[1]);

						if (date_check.split('not:today')[1].split(',')[0].split('|||')[1] != '') {
							ret_msg = date_check.split('not:today')[1].split(',')[0].split('|||')[1];
						} else {
							ret_msg = 'You cannot able to enter today date';
						}

					} else if (date_check.includes('maxdt-:today')) {

						if (date_check.split('maxdt-:today')[1].split(',')[0].split('|||')[1] != '') {
							ret_msg = date_check.split('maxdt-:today')[1].split(',')[0].split('|||')[1];
						} else {
							ret_msg = 'You cannot able to enter today date';
						}

					} else if (date_check.includes('mindt+:today')) {

						if (date_check.split('mindt+:today')[1].split(',')[0].split('|||')[1] != '') {
							ret_msg = date_check.split('mindt+:today')[1].split(',')[0].split('|||')[1];
						} else {
							ret_msg = 'You cannot able to enter today date';
						}

					}

				}

				var d1 = new Date(dt.split('/')[2], dt.split('/')[0] - 1, dt.split('/')[1]);

				if (d1 > d) {
					/*if (date_check.includes('maxdt-:today') || date_check.includes('maxdt:today')) {
						ret_msg = 'You cannot able to enter future date';
					}*/

					if (date_check.includes('maxdt-:today')) {

						if (date_check.split('maxdt-:today')[1].split(',')[0].split('|||')[1] != '') {
							ret_msg = date_check.split('maxdt-:today')[1].split(',')[0].split('|||')[1];
						} else {
							ret_msg = 'You cannot able to enter future date';
						}

					} else if (date_check.includes('maxdt:today')) {

						if (date_check.split('maxdt:today')[1].split(',')[0].split('|||')[1] != '') {
							ret_msg = date_check.split('maxdt:today')[1].split(',')[0].split('|||')[1];
						} else {
							ret_msg = 'You cannot able to enter future date';
						}

					}
				}

				if (d1 < d) {
					/*if (date_check.includes('mindt+:today') || date_check.includes('mindt:today')) {
						ret_msg = 'You cannot able to enter past date';
					}*/

					if (date_check.includes('mindt+:today')) {

						if (date_check.split('mindt+:today')[1].split(',')[0].split('|||')[1] != '') {
							ret_msg = date_check.split('mindt+:today')[1].split(',')[0].split('|||')[1];
						} else {
							ret_msg = 'You cannot able to enter past date';
						}

					} else if (date_check.includes('mindt:today')) {

						if (date_check.split('mindt:today')[1].split(',')[0].split('|||')[1] != '') {
							ret_msg = date_check.split('mindt:today')[1].split(',')[0].split('|||')[1];
						} else {
							ret_msg = 'You cannot able to enter past date';
						}

					}

				}

				return ret_msg;

			}

			function checkAvailable(dt, fld) {
				var valid_dt = $('#' + fld).attr('data-valid');
				var mindt = valid_dt.split('::')[0];
				var maxdt = valid_dt.split('::')[1];
				var ddates = valid_dt.split('::')[2].split(',');

				if (mindt != '') {
					var d1 = new Date(dt.split('/')[2], dt.split('/')[0] - 1, dt.split('/')[1]);
					var d2 = new Date(mindt.split('/')[2], mindt.split('/')[0] - 1, mindt.split('/')[1]);

					if (d1 < d2) {
						return false;
					}

				}

				if (maxdt != '') {
					var d1 = new Date(dt.split('/')[2], dt.split('/')[0] - 1, dt.split('/')[1]);
					var d2 = new Date(maxdt.split('/')[2], maxdt.split('/')[0] - 1, maxdt.split('/')[1]);

					if (d1 > d2) {
						return false;
					}

				}

				for (var i = 0; i < ddates.length; i++) {
					if (dt == ddates[i]) {
						return false;
					}
				}

				return true;

			}

			function valDate(mydate) {
				var valid = true;
				if (mydate.indexOf("/") == -1) {
					valid = false;
				}
				if (mydate.split('/').length != 3) {
					valid = false;
				}
				var mn = parseInt(mydate.split('/')[0]);
				var dt = parseInt(mydate.split('/')[1]);
				var yr = parseInt(mydate.split('/')[2]);
				if (mn > 12 || mn < 1) {
					valid = false;
				}
				if (mn == 1 || mn == 3 || mn == 5 || mn == 7 || mn == 8 || mn == 10 || mn == 12) {
					if (dt > 31 || dt < 1) {
						valid = false;
					}
				}
				if (mn == 4 || mn == 6 || mn == 9 || mn == 11) {
					if (dt > 30 || dt < 1) {
						valid = false;
					}
				}
				if (mn == 2) {
					if (yr % 4 == 0) {
						if (dt > 29 || dt < 1) {
							valid = false;
						}
					} else {
						if (dt > 28 || dt < 1) {
							valid = false;
						}
					}
				}
				if (yr > 2100 || yr < 2000) {
					valid = false;
				}
				return valid;
			}
			
		});
		
		$(document).ready(function() {
			// initialize datatable
			$('#PrintStatusSheetCase').dataTable({
				scrollY: "585px",
	            scrollCollapse: true,
	            paging: false,
	            searching: false,
	            ordering: false,
	            showNEntries: false,
	            info: false,
			});

		});
		
		
		    
		  </script>				
			<script type="text/javascript">
				$('#js-page-content').smartPanel();
			</script>
		</body>
			<!-- BEGIN Page Footer -->
		 		<div th:replace="~{fragments/footer :: footer}"></div>
		    <!-- END Page Footer -->
		</html>