<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:th="http://www.thymeleaf.org">
<meta charset="utf-8">
<title class="Registrationsidebar">Property Tracking</title>
<div th:replace="~{fragments/head :: head}"></div> 

<style>
	.nav-function-top .page-content-wrapper {
		margin-top: 4rem;
	}
	.floatingFields input:not(:placeholder-shown) + label {
	    background: #fff !important;
	}
	.money-container { 
	  position: relative;
	  display: inline-block;
	}

	.money-symbol {
	  position: absolute;
	  top: 50%;
	  left: 3px;
	  transform: translateY(-50%);
	  color: #555;
	  font-size: 0.9em;
	  pointer-events: none;
	  z-index: 2;
	}

	.money-input {
	  padding-left: 1.0em; /* Make room for the $ symbol */
	}
	
	.date-input-blockFuture {
	  min-width: 80px; /* or 140px if you want more */
	  /*flex-shrink: 0;    prevents it from shrinking */
	}
</style>

<body class="mod-bg-1 mod-nav-link">
				<div th:replace="~{fragments/header :: header}"></div>
				<div th:replace="~{fragments/navmenus :: navmenus}"></div>
	<!-- BEGIN Page Wrapper --> 
	<div class="page-wrapper">
		<div class="page-inner">
			<!-- BEGIN Left Aside -->
			<div th:replace="~{fragments/sidebar :: sidebar}"></div>
			<!-- END Left Aside --> 
			<div class="page-content-wrapper">
				<!-- BEGIN Page Header --> 

				<!-- END Page Header -->
				<!-- BEGIN Page Content -->
				<!-- the #js-page-content id is needed for some plugins to initialize -->
				<main id="js-page-content" role="main" class="page-content">
					<div class="subheader position-relative mb-1">
						<h1 class="subheader-title">
							<div th:replace="~{fragments/toggleMenu :: toggleMenu}"></div>
							<!--<span><i class='subheader-icon fal'></i> PROPERTY TRACKING - CBI_PRTR </span> -->
							<i class='subheader-icon fal fa-'></i> <span id="screenNameHolder" th:data-name="${screenCode}" th:text="${screenName}"></span></span>
						</h1>
						<div class="frame-wrap bg-transparent">
							<div class="btn-group">
							<div class="col-12 pr-0">
									<div class="js-get-date">[your date here]</div>
								</div>
								<div class="mr-2">
									<div class="input-append date position-relative w-100">
										<span class="add-on"></span>
									</div>
								</div>
							</div>
							<a id="addNewProperty" href="javascript:void(0);"
								class="btn btn-primary btn-sm btn-icon waves-effect waves-themed"
								data-toggle="tooltip" data-placement="top" data-original-title="Add"> <i
									class="fal fa-plus"></i>
							</a> <a href="javascript:void(0);"
								class="btn btn-warning btn-sm btn-icon waves-effect waves-themed disabled"
								data-toggle="tooltip" data-placement="top" data-original-title="Print"> <i
									class="fal fa-print"></i>
							</a> <a id="cancel" href="javascript:void(0);"
								class="btn btn-secondary btn-sm btn-icon waves-effect waves-themed"
								data-toggle="tooltip" data-placement="top" data-original-title="Clear"> <i
									class="fal fa-times"></i>
							</a> <a id="saveProperty" href="javascript:void(0);"
								class="btn btn-success btn-sm btn-icon waves-effect waves-themed" data-toggle="tooltip"
								data-placement="top" data-original-title="OK/Save"> <i class="fal fa-save"></i>
							</a> <a href="javascript:void(0);" id="exit"
								class="btn btn-danger btn-sm btn-icon waves-effect waves-themed" data-toggle="tooltip"
								data-placement="top" data-original-title="Cancel/Exit"> <i class="fal fa-sign-out"></i>
							</a>
						</div>

					</div>

					<div class="row">
						<div class="col-lg-12">
							<div th:replace="~{fragments/formheader :: formheader}"></div>
							<input type="hidden" name="screenCode" id="screenCode" value="CBI_PRTR">
							<div class="panel mb-0">
								<div class="panel-content">
									<ul class="nav nav-tabs text-nowrap" role="tablist" style="flex-wrap: nowrap; overflow-y: hidden;">
                                        <li class="nav-item" id="PropertyTrackingItems_TabHead"><a class="nav-link active" data-toggle="tab"
                                                href="#PropertyTrackingItems_Tab" role="tab">Items Collected</a></li>
                                        <li class="nav-item" id="PropertyTrackingDepartment_TabHead"><a class="nav-link" data-toggle="tab"
                                                href="#PropertyTrackingDepartment_Tab" role="tab">Department Issued</a></li>
                                    </ul>
                                    <div class="tab-content p-0">
                                        <div class="tab-pane fade show active mt-1" id="PropertyTrackingItems_Tab" role="tabpanel">
	                                        <div th:replace="~{PropertyTrackingItemsTab:: PropertyTrackingItemsTab}"></div>
										</div>
										<div class="tab-pane fade show mt-1" id="PropertyTrackingDepartment_Tab" role="tabpanel">
	                                        <div th:replace="~{PropertyTrackingDepartmentTab:: PropertyTrackingDepartmentTab}"></div>
										</div>
									</div>
								</div>
							</div>
						</div>
					</div>
				</main> 
				<!-- this overlay is activated only when mobile menu is triggered -->
				<div class="page-content-overlay" data-action="toggle" data-class="mobile-nav-on"></div>
				<!-- END Page Content -->
				
				<!-- Modal Large -->
				<div class="modal fade" id="default-example-modal-lg" tabindex="-1" role="dialog" aria-hidden="true">
					<div class="modal-dialog modal-lg" role="document">
						<div class="modal-content">
							<div class="modal-header">
								<h5 class="modal-title">Staff Name</h5>
								<button type="button" class="close" data-dismiss="modal" aria-label="Close">
									<span aria-hidden="true"><i class="fal fa-times"></i></span>
								</button>
							</div>
							<div class="modal-body">
								<div class="form-group row">
									<label for="staffSearch"
										class="col-form-label col-12 col-lg-1 form-label">Search</label>
									<div class="col-12 col-lg-11">
										<input type="text" class="form-control" aria-label="staffSearch"
											name="staffSearch" id="staffSearch" value="">
									</div>

								</div>
								<div class="table-responsive-lg">
									<table class="table table-bordered m-0">
										<thead>
											<tr>
												<th>Last Name</th>
												<th>First Name</th>
												<th>MI</th>
												<th>Suffix</th>
											</tr>
										</thead>
										<tbody>
											<tr>
												<td>14</td>
												<td>Staff</td>
												<td></td>
												<td></td>
											</tr>
											<tr>
												<td>14</td>
												<td>Staff</td>
												<td></td>
												<td></td>
											</tr>
											<tr>
												<td>14</td>
												<td>Staff</td>
												<td></td>
												<td></td>
											</tr>
											<tr>
												<td>14</td>
												<td>Staff</td>
												<td></td>
												<td></td>
											</tr>
											<tr>
												<td>14</td>
												<td>Staff</td>
												<td></td>
												<td></td>
											</tr>

										</tbody>
									</table>
								</div>
							</div>

						</div>
					</div>
				</div>
				<!-- BEGIN Shortcuts -->
				<!-- modal shortcut -->
				<div class="modal fade modal-backdrop-transparent" id="modal-shortcut" tabindex="-1" role="dialog"
					aria-labelledby="modal-shortcut" aria-hidden="true">
					<div class="modal-dialog modal-dialog-top modal-transparent" role="document">
						<div class="modal-content">
							<div class="modal-body">
								<ul class="app-list w-auto h-auto p-0 text-left">
									<li>
										<a href="intel_introduction.html" class="app-list-item text-white border-0 m-0">
											<div class="icon-stack">
												<i class="base base-7 icon-stack-3x opacity-100 color-primary-500 "></i>
												<i class="base base-7 icon-stack-2x opacity-100 color-primary-300 "></i>
												<i class="fal fa-home icon-stack-1x opacity-100 color-white"></i>
											</div>
											<span class="app-list-name">
												Home
											</span>
										</a>
									</li>
									<li>
										<a href="page_inbox_general.html" class="app-list-item text-white border-0 m-0">
											<div class="icon-stack">
												<i class="base base-7 icon-stack-3x opacity-100 color-success-500 "></i>
												<i class="base base-7 icon-stack-2x opacity-100 color-success-300 "></i>
												<i class="ni ni-envelope icon-stack-1x text-white"></i>
											</div>
											<span class="app-list-name">
												Inbox
											</span>
										</a>
									</li>
									<li>
										<a href="intel_introduction.html" class="app-list-item text-white border-0 m-0">
											<div class="icon-stack">
												<i class="base base-7 icon-stack-2x opacity-100 color-primary-300 "></i>
												<i class="fal fa-plus icon-stack-1x opacity-100 color-white"></i>
											</div>
											<span class="app-list-name">
												Add More
											</span>
										</a>
									</li>
								</ul>
							</div>
						</div>
					</div>
				</div> <!-- END Shortcuts -->
			</div>
		</div>
	</div>
	<!-- END Page Wrapper -->
	<!-- BEGIN Quick Menu -->
	<!-- to add more items, please make sure to change the variable '$menu-items: number;' in your _page-components-shortcut.scss -->
	<nav class="shortcut-menu d-none d-sm-block"> <input
	type="checkbox" class="menu-open" name="menu-open" id="menu_open" />
	<label for="menu_open" class="menu-open-button "> <span
	class="app-shortcut-icon d-block"></span>
	</label> <a href="#" class="menu-item btn" data-toggle="tooltip"
	data-placement="left" title="Scroll Top"> <i
	class="fal fa-arrow-up"></i>
	</a> <a href="page_login-alt.html" class="menu-item btn"
	data-toggle="tooltip" data-placement="left" title="Logout"> <i
	class="fal fa-sign-out"></i>
	</a> <a href="#" class="menu-item btn" data-action="app-fullscreen"
	data-toggle="tooltip" data-placement="left" title="Full Screen"> <i
	class="fal fa-expand"></i>
	</a> <a href="#" class="menu-item btn" data-action="app-print"
	data-toggle="tooltip" data-placement="left" title="Print page"> <i
	class="fal fa-print"></i>
	</a> <a href="#" class="menu-item btn" data-action="app-voice"
	data-toggle="tooltip" data-placement="left" title="Voice command">
	<i class="fal fa-microphone"></i>
	</a> </nav>
	<!-- END Quick Menu -->
	<!-- BEGIN Messenger -->
	<div class="modal fade js-modal-messenger modal-backdrop-transparent" tabindex="-1" role="dialog"
		aria-hidden="true">
		<div class="modal-dialog modal-dialog-right">
			<div class="modal-content h-100">
				<div class="dropdown-header bg-trans-gradient d-flex align-items-center w-100">
					<div class="d-flex flex-row align-items-center mt-1 mb-1 color-white">
						<span class="mr-2">
							<span class="rounded-circle profile-image d-block"
								style="background-image:url('img/demo/avatars/avatar-d.png'); background-size: cover;"></span>
						</span>
						<div class="info-card-text">
							<a href="javascript:void(0);" class="fs-lg text-truncate text-truncate-lg text-white"
								data-toggle="dropdown" aria-expanded="false">
								Tracey Chang
								<i class="fal fa-angle-down d-inline-block ml-1 text-white fs-md"></i>
							</a>
							<div class="dropdown-menu">
								<a class="dropdown-item" href="#">Send Email</a>
								<a class="dropdown-item" href="#">Create Appointment</a>
								<a class="dropdown-item" href="#">Block User</a>
							</div>
							<span class="text-truncate text-truncate-md opacity-80">IT Director</span>
						</div>
					</div>
					<button type="button" class="close text-white position-absolute pos-top pos-right p-2 m-1 mr-2"
						data-dismiss="modal" aria-label="Close">
						<span aria-hidden="true"><i class="fal fa-times"></i></span>
					</button>
				</div>
				<div class="modal-body p-0 h-100 d-flex">
					<!-- BEGIN msgr-list -->
					<div
						class="msgr-list d-flex flex-column bg-faded border-faded border-top-0 border-right-0 border-bottom-0 position-absolute pos-top pos-bottom">
						<div>
							<div
								class="height-4 width-3 h3 m-0 d-flex justify-content-center flex-column color-primary-500 pl-3 mt-2">
								<i class="fal fa-search"></i>
							</div>
							<input type="text" class="form-control bg-white" id="msgr_listfilter_input"
								name="msgr_listfilter_input" placeholder="Filter contacts" aria-label="FilterSearch"
								value="" data-listfilter="#js-msgr-listfilter">
						</div>
						<div class="flex-1 h-100 custom-scroll">
							<div class="w-100">
								<ul id="js-msgr-listfilter" class="list-unstyled m-0">
									<li>
										<a href="#" class="d-table w-100 px-2 py-2 text-dark hover-white"
											data-filter-tags="tracey chang online">
											<div class="d-table-cell align-middle status status-success status-sm ">
												<span class="profile-image-md rounded-circle d-block"
													style="background-image:url('img/demo/avatars/avatar-d.png'); background-size: cover;"></span>
											</div>
											<div class="d-table-cell w-100 align-middle pl-2 pr-2">
												<div class="text-truncate text-truncate-md">
													Tracey Chang
													<small class="d-block font-italic text-success fs-xs">
														Online
													</small>
												</div>
											</div>
										</a>
									</li>
									<li>
										<a href="#" class="d-table w-100 px-2 py-2 text-dark hover-white"
											data-filter-tags="oliver kopyuv online">
											<div class="d-table-cell align-middle status status-success status-sm ">
												<span class="profile-image-md rounded-circle d-block"
													style="background-image:url('img/demo/avatars/avatar-b.png'); background-size: cover;"></span>
											</div>
											<div class="d-table-cell w-100 align-middle pl-2 pr-2">
												<div class="text-truncate text-truncate-md">
													Oliver Kopyuv
													<small class="d-block font-italic text-success fs-xs">
														Online
													</small>
												</div>
											</div>
										</a>
									</li>
									<li>
										<a href="#" class="d-table w-100 px-2 py-2 text-dark hover-white"
											data-filter-tags="dr john cook phd away">
											<div class="d-table-cell align-middle status status-warning status-sm ">
												<span class="profile-image-md rounded-circle d-block"
													style="background-image:url('img/demo/avatars/avatar-e.png'); background-size: cover;"></span>
											</div>
											<div class="d-table-cell w-100 align-middle pl-2 pr-2">
												<div class="text-truncate text-truncate-md">
													Dr. John Cook PhD
													<small class="d-block font-italic fs-xs">
														Away
													</small>
												</div>
											</div>
										</a>
									</li>
									<li>
										<a href="#" class="d-table w-100 px-2 py-2 text-dark hover-white"
											data-filter-tags="ali amdaney online">
											<div class="d-table-cell align-middle status status-success status-sm ">
												<span class="profile-image-md rounded-circle d-block"
													style="background-image:url('img/demo/avatars/avatar-g.png'); background-size: cover;"></span>
											</div>
											<div class="d-table-cell w-100 align-middle pl-2 pr-2">
												<div class="text-truncate text-truncate-md">
													Ali Amdaney
													<small class="d-block font-italic fs-xs text-success">
														Online
													</small>
												</div>
											</div>
										</a>
									</li>
									<li>
										<a href="#" class="d-table w-100 px-2 py-2 text-dark hover-white"
											data-filter-tags="sarah mcbrook online">
											<div class="d-table-cell align-middle status status-success status-sm">
												<span class="profile-image-md rounded-circle d-block"
													style="background-image:url('img/demo/avatars/avatar-h.png'); background-size: cover;"></span>
											</div>
											<div class="d-table-cell w-100 align-middle pl-2 pr-2">
												<div class="text-truncate text-truncate-md">
													Sarah McBrook
													<small class="d-block font-italic fs-xs text-success">
														Online
													</small>
												</div>
											</div>
										</a>
									</li>
									<li>
										<a href="#" class="d-table w-100 px-2 py-2 text-dark hover-white"
											data-filter-tags="ali amdaney offline">
											<div class="d-table-cell align-middle status status-sm">
												<span class="profile-image-md rounded-circle d-block"
													style="background-image:url('img/demo/avatars/avatar-a.png'); background-size: cover;"></span>
											</div>
											<div class="d-table-cell w-100 align-middle pl-2 pr-2">
												<div class="text-truncate text-truncate-md">
													oliver.kopyuv@gotbootstrap.com
													<small class="d-block font-italic fs-xs">
														Offline
													</small>
												</div>
											</div>
										</a>
									</li>
									<li>
										<a href="#" class="d-table w-100 px-2 py-2 text-dark hover-white"
											data-filter-tags="ali amdaney busy">
											<div class="d-table-cell align-middle status status-danger status-sm">
												<span class="profile-image-md rounded-circle d-block"
													style="background-image:url('img/demo/avatars/avatar-j.png'); background-size: cover;"></span>
											</div>
											<div class="d-table-cell w-100 align-middle pl-2 pr-2">
												<div class="text-truncate text-truncate-md">
													oliver.kopyuv@gotbootstrap.com
													<small class="d-block font-italic fs-xs text-danger">
														Busy
													</small>
												</div>
											</div>
										</a>
									</li>
									<li>
										<a href="#" class="d-table w-100 px-2 py-2 text-dark hover-white"
											data-filter-tags="ali amdaney offline">
											<div class="d-table-cell align-middle status status-sm">
												<span class="profile-image-md rounded-circle d-block"
													style="background-image:url('img/demo/avatars/avatar-c.png'); background-size: cover;"></span>
											</div>
											<div class="d-table-cell w-100 align-middle pl-2 pr-2">
												<div class="text-truncate text-truncate-md">
													oliver.kopyuv@gotbootstrap.com
													<small class="d-block font-italic fs-xs">
														Offline
													</small>
												</div>
											</div>
										</a>
									</li>
									<li>
										<a href="#" class="d-table w-100 px-2 py-2 text-dark hover-white"
											data-filter-tags="ali amdaney inactive">
											<div class="d-table-cell align-middle">
												<span class="profile-image-md rounded-circle d-block"
													style="background-image:url('img/demo/avatars/avatar-m.png'); background-size: cover;"></span>
											</div>
											<div class="d-table-cell w-100 align-middle pl-2 pr-2">
												<div class="text-truncate text-truncate-md">
													+714651347790
													<small class="d-block font-italic fs-xs opacity-50">
														Missed Call
													</small>
												</div>
											</div>
										</a>
									</li>
								</ul>
								<div class="filter-message js-filter-message"></div>
							</div>
						</div>
						<div>
							<a class="fs-xl d-flex align-items-center p-3">
								<i class="fal fa-cogs"></i>
							</a>
						</div>
					</div>
					<!-- END msgr-list -->
					<!-- BEGIN msgr -->
					<div class="msgr d-flex h-100 flex-column bg-white">
						<!-- BEGIN custom-scroll -->
						<div class="custom-scroll flex-1 h-100">
							<div id="chat_container" class="w-100 p-4">
								<!-- start .chat-segment -->
								<div class="chat-segment">
									<div class="time-stamp text-center mb-2 fw-400">
										Jun 19
									</div>
								</div>
								<!--  end .chat-segment -->
								<!-- start .chat-segment -->
								<div class="chat-segment chat-segment-sent">
									<div class="chat-message">
										<p>
											Hey Ching, did you get my files?
										</p>
									</div>
									<div class="text-right fw-300 text-muted mt-1 fs-xs">
										3:00 pm
									</div>
								</div>
								<!--  end .chat-segment -->
								<!-- start .chat-segment -->
								<div class="chat-segment chat-segment-get">
									<div class="chat-message">
										<p>
											Hi
										</p>
										<p>
											Sorry going through a busy time in office. Yes I analyzed the solution.
										</p>
										<p>
											It will require some resource, which I could not manage.
										</p>
									</div>
									<div class="fw-300 text-muted mt-1 fs-xs">
										3:24 pm
									</div>
								</div>
								<!--  end .chat-segment -->
								<!-- start .chat-segment -->
								<div class="chat-segment chat-segment-sent chat-start">
									<div class="chat-message">
										<p>
											Okay
										</p>
									</div>
								</div>
								<!--  end .chat-segment -->
								<!-- start .chat-segment -->
								<div class="chat-segment chat-segment-sent chat-end">
									<div class="chat-message">
										<p>
											Sending you some dough today, you can allocate the resources to this
											project.
										</p>
									</div>
									<div class="text-right fw-300 text-muted mt-1 fs-xs">
										3:26 pm
									</div>
								</div>
								<!--  end .chat-segment -->
								<!-- start .chat-segment -->
								<div class="chat-segment chat-segment-get chat-start">
									<div class="chat-message">
										<p>
											Perfect. Thanks a lot!
										</p>
									</div>
								</div>
								<!--  end .chat-segment -->
								<!-- start .chat-segment -->
								<div class="chat-segment chat-segment-get">
									<div class="chat-message">
										<p>
											I will have them ready by tonight.
										</p>
									</div>
								</div>
								<!--  end .chat-segment -->
								<!-- start .chat-segment -->
								<div class="chat-segment chat-segment-get chat-end">
									<div class="chat-message">
										<p>
											Cheers
										</p>
									</div>
								</div>
								<!--  end .chat-segment -->
								<!-- start .chat-segment for timestamp -->
								<div class="chat-segment">
									<div class="time-stamp text-center mb-2 fw-400">
										Jun 20
									</div>
								</div>
								<!--  end .chat-segment for timestamp -->
							</div>
						</div>
						<!-- END custom-scroll  -->
						<!-- BEGIN msgr__chatinput -->
						<div class="d-flex flex-column">
							<div
								class="border-faded border-right-0 border-bottom-0 border-left-0 flex-1 mr-3 ml-3 position-relative shadow-top">
								<div class="pt-3 pb-1 pr-0 pl-0 rounded-0" tabindex="-1">
									<div id="msgr_input" contenteditable="true"
										data-placeholder="Type your message here..."
										class="height-10 form-content-editable"></div>
								</div>
							</div>
							<div class="height-8 px-3 d-flex flex-row align-items-center flex-wrap flex-shrink-0">
								<a href="javascript:void(0);" class="btn btn-icon fs-xl width-1 mr-1"
									data-toggle="tooltip" data-original-title="More options" data-placement="top">
									<i class="fal fa-ellipsis-v-alt color-fusion-300"></i>
								</a>
								<a href="javascript:void(0);" class="btn btn-icon fs-xl mr-1" data-toggle="tooltip"
									data-original-title="Attach files" data-placement="top">
									<i class="fal fa-paperclip color-fusion-300"></i>
								</a>
								<a href="javascript:void(0);" class="btn btn-icon fs-xl mr-1" data-toggle="tooltip"
									data-original-title="Insert photo" data-placement="top">
									<i class="fal fa-camera color-fusion-300"></i>
								</a>
								<div class="ml-auto">
									<a href="javascript:void(0);" class="btn btn-info">Send</a>
								</div>
							</div>
						</div>
						<!-- END msgr__chatinput -->
					</div>
					<!-- END msgr -->
				</div>
			</div>
		</div>
	</div>
	<!-- END Messenger -->
	<!-- BEGIN Page Settings -->
	<div class="modal fade js-modal-settings modal-backdrop-transparent" tabindex="-1" role="dialog" aria-hidden="true">
		<div class="modal-dialog modal-dialog-right modal-md">
			<div class="modal-content">
				<div class="dropdown-header bg-trans-gradient d-flex justify-content-center align-items-center w-100">
					<h4 class="m-0 text-center color-white">
						Layout Settings
						<small class="mb-0 opacity-80">User Interface Settings</small>
					</h4>
					<button type="button" class="close text-white position-absolute pos-top pos-right p-2 m-1 mr-2"
						data-dismiss="modal" aria-label="Close">
						<span aria-hidden="true"><i class="fal fa-times"></i></span>
					</button>
				</div>
				<div class="modal-body p-0">
					<div class="settings-panel">
						<div class="mt-4 d-table w-100 px-5">
							<div class="d-table-cell align-middle">
								<h5 class="p-0">
									App Layout
								</h5>
							</div>
						</div>
						<div class="list" id="fh">
							<a href="#" onclick="return false;" class="btn btn-switch" data-action="toggle"
								data-class="header-function-fixed"></a>
							<span class="onoffswitch-title">Fixed Header</span>
							<span class="onoffswitch-title-desc">header is in a fixed at all times</span>
						</div>
						<div class="list" id="nff">
							<a href="#" onclick="return false;" class="btn btn-switch" data-action="toggle"
								data-class="nav-function-fixed"></a>
							<span class="onoffswitch-title">Fixed Navigation</span>
							<span class="onoffswitch-title-desc">left panel is fixed</span>
						</div>
						<div class="list" id="nfm">
							<a href="#" onclick="return false;" class="btn btn-switch" data-action="toggle"
								data-class="nav-function-minify"></a>
							<span class="onoffswitch-title">Minify Navigation</span>
							<span class="onoffswitch-title-desc">Skew nav to maximize space</span>
						</div>
						<div class="list" id="nfh">
							<a href="#" onclick="return false;" class="btn btn-switch" data-action="toggle"
								data-class="nav-function-hidden"></a>
							<span class="onoffswitch-title">Hide Navigation</span>
							<span class="onoffswitch-title-desc">roll mouse on edge to reveal</span>
						</div>
						<div class="list" id="nft">
							<a href="#" onclick="return false;" class="btn btn-switch" data-action="toggle"
								data-class="nav-function-top"></a>
							<span class="onoffswitch-title">Top Navigation</span>
							<span class="onoffswitch-title-desc">Relocate left pane to top</span>
						</div>
						<div class="list" id="mmb">
							<a href="#" onclick="return false;" class="btn btn-switch" data-action="toggle"
								data-class="mod-main-boxed"></a>
							<span class="onoffswitch-title">Boxed Layout</span>
							<span class="onoffswitch-title-desc">Encapsulates to a container</span>
						</div>
						<div class="expanded">
							<ul class="">
								<li>
									<div class="bg-fusion-50" data-action="toggle" data-class="mod-bg-1"></div>
								</li>
								<li>
									<div class="bg-warning-200" data-action="toggle" data-class="mod-bg-2"></div>
								</li>
								<li>
									<div class="bg-primary-200" data-action="toggle" data-class="mod-bg-3"></div>
								</li>
								<li>
									<div class="bg-success-300" data-action="toggle" data-class="mod-bg-4"></div>
								</li>
							</ul>
							<div class="list" id="mbgf">
								<a href="#" onclick="return false;" class="btn btn-switch" data-action="toggle"
									data-class="mod-fixed-bg"></a>
								<span class="onoffswitch-title">Fixed Background</span>
							</div>
						</div>
						<!-- <div class="mt-4 d-table w-100 px-5">
                            <div class="d-table-cell align-middle">
                                <h5 class="p-0">
                                    Mobile Menu
                                </h5>
                            </div>
                        </div>
                        <div class="list" id="nmp">
                            <a href="#" onclick="return false;" class="btn btn-switch" data-action="toggle"
                                data-class="nav-mobile-push"></a>
                            <span class="onoffswitch-title">Push Content</span>
                            <span class="onoffswitch-title-desc">Content pushed on menu reveal</span>
                        </div>
                        <div class="list" id="nmno">
                            <a href="#" onclick="return false;" class="btn btn-switch" data-action="toggle"
                                data-class="nav-mobile-no-overlay"></a>
                            <span class="onoffswitch-title">No Overlay</span>
                            <span class="onoffswitch-title-desc">Removes mesh on menu reveal</span>
                        </div>
                        <div class="list" id="sldo">
                            <a href="#" onclick="return false;" class="btn btn-switch" data-action="toggle"
                                data-class="nav-mobile-slide-out"></a>
                            <span class="onoffswitch-title">Off-Canvas <sup>(beta)</sup></span>
                            <span class="onoffswitch-title-desc">Content overlaps menu</span>
                        </div> -->
						<div class="mt-4 d-table w-100 px-5">
							<div class="d-table-cell align-middle">
								<h5 class="p-0">
									Accessibility
								</h5>
							</div>
						</div>
						<div class="list" id="mbf">
							<a href="#" onclick="return false;" class="btn btn-switch" data-action="toggle"
								data-class="mod-bigger-font"></a>
							<span class="onoffswitch-title">Bigger Content Font</span>
							<span class="onoffswitch-title-desc">content fonts are bigger for readability</span>
						</div>
						<div class="list" id="mhc">
							<a href="#" onclick="return false;" class="btn btn-switch" data-action="toggle"
								data-class="mod-high-contrast"></a>
							<span class="onoffswitch-title">High Contrast Text (WCAG 2 AA)</span>
							<span class="onoffswitch-title-desc">4.5:1 text contrast ratio</span>
						</div>
						<div class="list" id="mcb">
							<a href="#" onclick="return false;" class="btn btn-switch" data-action="toggle"
								data-class="mod-color-blind"></a>
							<span class="onoffswitch-title">Daltonism <sup>(beta)</sup> </span>
							<span class="onoffswitch-title-desc">color vision deficiency</span>
						</div>
						<div class="list" id="mpc">
							<a href="#" onclick="return false;" class="btn btn-switch" data-action="toggle"
								data-class="mod-pace-custom"></a>
							<span class="onoffswitch-title">Preloader Inside</span>
							<span class="onoffswitch-title-desc">preloader will be inside content</span>
						</div>
						<div class="mt-4 d-table w-100 px-5">
							<div class="d-table-cell align-middle">
								<h5 class="p-0">
									Global Modifications
								</h5>
							</div>
						</div>
						<div class="list" id="mcbg">
							<a href="#" onclick="return false;" class="btn btn-switch" data-action="toggle"
								data-class="mod-clean-page-bg"></a>
							<span class="onoffswitch-title">Clean Page Background</span>
							<span class="onoffswitch-title-desc">adds more whitespace</span>
						</div>
						<div class="list" id="mhni">
							<a href="#" onclick="return false;" class="btn btn-switch" data-action="toggle"
								data-class="mod-hide-nav-icons"></a>
							<span class="onoffswitch-title">Hide Navigation Icons</span>
							<span class="onoffswitch-title-desc">invisible navigation icons</span>
						</div>
						<div class="list" id="dan">
							<a href="#" onclick="return false;" class="btn btn-switch" data-action="toggle"
								data-class="mod-disable-animation"></a>
							<span class="onoffswitch-title">Disable CSS Animation</span>
							<span class="onoffswitch-title-desc">Disables CSS based animations</span>
						</div>
						<div class="list" id="mhic">
							<a href="#" onclick="return false;" class="btn btn-switch" data-action="toggle"
								data-class="mod-hide-info-card"></a>
							<span class="onoffswitch-title">Hide Info Card</span>
							<span class="onoffswitch-title-desc">Hides info card from left panel</span>
						</div>
						<div class="list" id="mlph">
							<a href="#" onclick="return false;" class="btn btn-switch" data-action="toggle"
								data-class="mod-lean-subheader"></a>
							<span class="onoffswitch-title">Lean Subheader</span>
							<span class="onoffswitch-title-desc">distinguished page header</span>
						</div>
						<div class="list" id="mnl">
							<a href="#" onclick="return false;" class="btn btn-switch" data-action="toggle"
								data-class="mod-nav-link"></a>
							<span class="onoffswitch-title">Hierarchical Navigation</span>
							<span class="onoffswitch-title-desc">Clear breakdown of nav links</span>
						</div>
						<div class="list mt-1">
							<span class="onoffswitch-title">Global Font Size <small>(RESETS ON REFRESH)</small> </span>
							<div class="btn-group btn-group-sm btn-group-toggle my-2" data-toggle="buttons">
								<label for="smRadio" class="btn btn-default btn-sm" data-action="toggle-swap"
									data-class="root-text-sm" data-target="html">
									<input type="radio" aria-label="smRadio" name="smRadio" id="smRadio" value=""> SM
								</label>
								<label for="mdRadio" class="btn btn-default btn-sm" data-action="toggle-swap"
									data-class="root-text" data-target="html">
									<input type="radio" aria-label="mdRadio" name="mdRadio" id="mdRadio" value=""
										checked=""> MD
								</label>
								<label for="lgRadio" class="btn btn-default btn-sm" data-action="toggle-swap"
									data-class="root-text-lg" data-target="html">
									<input type="radio" aria-label="lgRadio" name="lgRadio" id="lgRadio" value=""> LG
								</label>
								<label for="xlRadio" class="btn btn-default btn-sm" data-action="toggle-swap"
									data-class="root-text-xl" data-target="html">
									<input type="radio" aria-label="xlRadio" name="xlRadio" id="xlRadio" value=""> XL
								</label>
							</div>
							<span class="onoffswitch-title-desc d-block mb-g">Change <strong>root</strong> font size to
								effect rem values</span>
						</div>
						<div class="mt-2 d-table w-100 pl-5 pr-3">
							<div class="d-table-cell align-middle">
								<h5 class="p-0">
									Theme colors <small>(overlays base css)</small>
								</h5>
								<!-- <div class="fs-xs text-muted p-2 alert alert-warning mt-3 mb-0">
                                    <i class="fal fa-exclamation-triangle text-warning mr-2"></i>Due to network latency
                                    and CPU utilization, you may experience a brief flickering effect on page load which
                                    may show the intial applied theme for a split second. Setting the prefered
                                    style/theme in the header will prevent this from happening.
                                </div> -->
							</div>
						</div>
						<div class="expanded theme-colors pl-5 pr-3">
							<ul class="m-0">
								<li><a href="#" id="myapp-0" data-action="theme-update" data-themesave data-theme=""
										data-toggle="tooltip" data-placement="top" title="Wisteria (base css)"
										data-original-title="Wisteria (base css)"></a></li>
								<li><a href="#" id="myapp-1" data-action="theme-update" data-themesave
										data-theme="css/themes/cust-theme-1.css" data-toggle="tooltip"
										data-placement="top" title="Tapestry" data-original-title="Tapestry"></a></li>
								<li><a href="#" id="myapp-2" data-action="theme-update" data-themesave
										data-theme="css/themes/cust-theme-2.css" data-toggle="tooltip"
										data-placement="top" title="Atlantis" data-original-title="Atlantis"></a></li>
								<li><a href="#" id="myapp-3" data-action="theme-update" data-themesave
										data-theme="css/themes/cust-theme-3.css" data-toggle="tooltip"
										data-placement="top" title="Indigo" data-original-title="Indigo"></a></li>
								<li><a href="#" id="myapp-4" data-action="theme-update" data-themesave
										data-theme="css/themes/cust-theme-4.css" data-toggle="tooltip"
										data-placement="top" title="Dodger Blue" data-original-title="Dodger Blue"></a>
								</li>
								<li><a href="#" id="myapp-5" data-action="theme-update" data-themesave 
										data-theme="css/themes/cust-theme-5.css" data-toggle="tooltip"
										data-placement="top" title="Tradewind" data-original-title="Tradewind"></a></li>
								<li><a href="#" id="myapp-6" data-action="theme-update" data-themesave
										data-theme="css/themes/cust-theme-6.css" data-toggle="tooltip"
										data-placement="top" title="Cranberry" data-original-title="Cranberry"></a></li>
								<li><a href="#" id="myapp-7" data-action="theme-update" data-themesave
										data-theme="css/themes/cust-theme-7.css" data-toggle="tooltip"
										data-placement="top" title="Oslo Gray" data-original-title="Oslo Gray"></a></li>
								<li><a href="#" id="myapp-8" data-action="theme-update" data-themesave
										data-theme="css/themes/cust-theme-8.css" data-toggle="tooltip"
										data-placement="top" title="Chetwode Blue"
										data-original-title="Chetwode Blue"></a></li>
								<li><a href="#" id="myapp-9" data-action="theme-update" data-themesave
										data-theme="css/themes/cust-theme-9.css" data-toggle="tooltip"
										data-placement="top" title="Apricot" data-original-title="Apricot"></a></li>
								<li><a href="#" id="myapp-10" data-action="theme-update" data-themesave
										data-theme="css/themes/cust-theme-10.css" data-toggle="tooltip"
										data-placement="top" title="Blue Smoke" data-original-title="Blue Smoke"></a>
								</li>
								<li><a href="#" id="myapp-11" data-action="theme-update" data-themesave
										data-theme="css/themes/cust-theme-11.css" data-toggle="tooltip"
										data-placement="top" title="Green Smoke" data-original-title="Green Smoke"></a>
								</li>
								<li><a href="#" id="myapp-12" data-action="theme-update" data-themesave
										data-theme="css/themes/cust-theme-12.css" data-toggle="tooltip"
										data-placement="top" title="Wild Blue Yonder"
										data-original-title="Wild Blue Yonder"></a></li>
								<li><a href="#" id="myapp-13" data-action="theme-update" data-themesave
										data-theme="css/themes/cust-theme-13.css" data-toggle="tooltip"
										data-placement="top" title="Emerald" data-original-title="Emerald"></a></li>
							</ul>
						</div>
						<hr class="mb-0 mt-4">
						<div class="pl-5 pr-3 py-3 bg-faded">
							<div class="row no-gutters">
								<div class="col-6 pr-1">
									<a href="#" class="btn btn-outline-danger fw-500 btn-block"
										data-action="app-reset">Reset Settings</a>
								</div>
								<div class="col-6 pl-1">
									<a href="#" class="btn btn-danger fw-500 btn-block"
										data-action="factory-reset">Factory Reset</a>
								</div>
							</div>
						</div>
					</div>
					<span id="saving"></span>
				</div>
			</div>
		</div>
	</div>
	<!-- END Page Settings -->
	<!-- Modal Start -->
			<div class="modal fade" id="ObservingOfficer" tabindex="-1" role="dialog" aria-hidden="true">
										<div class="modal-dialog modal-dialog-centered modal-lg" role="document">
											<div class="modal-content">
												<div class="modal-header pt-3 pb-2">
													<h6 class="modal-title" id="peopleModalTitle">Observing Officer</h6>
													<button type="button" class="close" data-dismiss="modal" aria-label="Close">
														<span aria-hidden="true"><i class="fal fa-times"></i></span>
													</button>
												</div>
												<div class="modal-body py-0">
													<div class="d-flex align-items-center mb-2">
														<label for="dob" class="form-label mb-0 mr-2 text-nowrap">Find</label>
														<input type="text" class="form-control mr-1" aria-label="dob" name="Find"
															id="Find" placeholder="Search..." autocomplete="off">
															<button type="button" class="btn btn-primary btn-sm"
																id="searchUser">Find</button>
													</div>
													<div id="table-container">
														<div class="tableFixHead">
															<div id="officerTbl" class="w-100"></div>
															<!--<table id="officerTbl"
																class="table table-striped table-bordered table-sm">
																<thead>
																	<tr>
																		<th>Last Name</th>
																		<th>First Name</th>
																		<th style="width: 50px;">Mi</th>
																		<th style="width: 100px;">Suffix</th>
																	</tr>
																</thead>
																<tbody id="officerTblBody">
																</tbody>
															</table>-->
														</div>
													</div>
												</div>
												<div class="modal-footer">
													<!--<button type="button" class="btn btn-primary btn-sm" id="fetchDataBtn" >Ok</button>-->
													<button type="button" id="cancelOfcrPopup" class="btn btn-secondary btn-sm"
														data-dismiss="modal">Cancel</button>
												</div>
											</div>
										</div>
									</div>
									<!-- Modal End -->
	
	<style>
		label{
			font-weight: 500;
		}
		/*#officerTbl {
			max-height: 300px;
			overflow-y: auto;
		}*/
		.checkboxBlock .custom-checkbox{
			width: 70px;
		}
		.levelStatusCheckbox .custom-checkbox{
			width: 95px;
		}
		.dataTables_info{
			position: absolute;
		}
		.panelContentBlock{
			border: 1px solid #7a58ac;	
			border-radius: 5px!important;
		}
		.floatingFields input:not(:placeholder-shown) + label {
		    background: #fff !important;
		}
		@media screen and (max-width: 1024px) {
		    .page-content-wrapper {
		    	margin-top: 0 !important;
		    }
		}
	</style>

	<div th:replace="~{fragments/script :: script}"></div>
	<script src="js/script.js"></script> 
	<script src="js/staticjs.js"></script>
	<script th:inline="javascript">
		$(document).ready(function () {
			$(function () {
				$('.select2').select2();

				$(".select2-placeholder-multiple").select2(
					{
						placeholder: "Select State"
					});
				$(".js-hide-search").select2(
					{
						minimumResultsForSearch: 1 / 0
					});
				$(".js-max-length").select2(
					{
						maximumSelectionLength: 2,
						placeholder: "Select maximum 2 items"
					});
				$(".select2-placeholder").select2(
					{
						placeholder: "Select a state",
						allowClear: true
					});



				$(".js-select2-icons").select2(
					{
						minimumResultsForSearch: 1 / 0,
						templateResult: icon,
						templateSelection: icon,
						escapeMarkup: function (elm) {
							return elm
						}
					});

				function icon(elm) {
					elm.element;
					return elm.id ? "<i class='" + $(elm.element).data("icon") + " mr-2'></i>" + elm.text : elm.text
				}

				$(".js-data-example-ajax").select2(
					{
						ajax:
						{
							url: "https://api.github.com/search/repositories",
							dataType: 'json',
							delay: 250,
							data: function (params) {
								return {
									q: params.term, // search term
									page: params.page
								};
							},
							processResults: function (data, params) {
								params.page = params.page || 1;

								return {
									results: data.items,
									pagination:
									{
										more: (params.page * 30) < data.total_count
									}
								};
							},
							cache: true
						},
						placeholder: 'Search for a repository',
						escapeMarkup: function (markup) {
							return markup;
						}, // let our custom formatter work
						minimumInputLength: 1,
						templateResult: formatRepo,
						templateSelection: formatRepoSelection
					});

				function formatRepo(repo) {
					if (repo.loading) {
						return repo.text;
					}

					var markup = "<div class='select2-result-repository clearfix d-flex'>" +
						"<div class='select2-result-repository__avatar mr-2'><img src='" + repo.owner.avatar_url + "' class='width-2 height-2 mt-1 rounded' /></div>" +
						"<div class='select2-result-repository__meta'>" +
						"<div class='select2-result-repository__title fs-lg fw-500'>" + repo.full_name + "</div>";

					if (repo.description) {
						markup += "<div class='select2-result-repository__description fs-xs opacity-80 mb-1'>" + repo.description + "</div>";
					}

					markup += "<div class='select2-result-repository__statistics d-flex fs-sm'>" +
						"<div class='select2-result-repository__forks mr-2'><i class='fal fa-lightbulb'></i> " + repo.forks_count + " Forks</div>" +
						"<div class='select2-result-repository__stargazers mr-2'><i class='fal fa-star'></i> " + repo.stargazers_count + " Stars</div>" +
						"<div class='select2-result-repository__watchers mr-2'><i class='fal fa-eye'></i> " + repo.watchers_count + " Watchers</div>" +
						"</div>" +
						"</div></div>";

					return markup;
				}

				function formatRepoSelection(repo) {
					return repo.full_name || repo.text;
				}

			});
		});
		
		// Arrow key nav for inp fields
		let lastFocusedInput = null;
		function enableArrowKeyNavigation(selector) {
		  // Utility function to get focusable elements under the selector
		  function getFocusableElements(sel) {
		    return Array.from(document.querySelectorAll(sel)).filter(el => {
		      if (el.tagName === 'INPUT') {
		        return !el.disabled;
		      }
		      if (el.tagName === 'A') {
		        return el.hasAttribute('tabindex') && el.tabIndex >= 0;
		      }
			  if (el.tagName === 'TEXTAREA') {
			  	return !el.disabled;
			  }
			  if (el.tagName === 'SELECT') {
			  	return !el.disabled;
			  }
		      return false;
		    });
		  }
		  const focusableElements = getFocusableElements(selector);
		  focusableElements.forEach((el, idx) => {
		    el.addEventListener('keydown', (e) => {
				if (e.key === 'ArrowDown' || e.key === 'ArrowUp') {
				        e.preventDefault();

				        // If current element is a .date-input, close its datepicker
				        if (el.classList && (el.classList.contains('date-input-blockFuture')||el.classList.contains('date-input-allowFuture'))) {
				          $(el).datepicker('hide');
				        }

				        let newIndex = (e.key === 'ArrowDown') ? (idx + 1) % focusableElements.length : (idx - 1 + focusableElements.length) % focusableElements.length;
				        if (newIndex >= 0 && newIndex < focusableElements.length) {
				          focusableElements[newIndex].focus();
				        }
				      }
		      /*if (e.key === 'ArrowDown') {
		        e.preventDefault();
		        if (idx + 1 < focusableElements.length)
		          focusableElements[idx + 1].focus();
		      } else if (e.key === 'ArrowUp') {
		        e.preventDefault();
		        if (idx - 1 >= 0)
		          focusableElements[idx - 1].focus();
		      }*/
		    });
			el.addEventListener('focus', (event) => {
				lastFocusedInput = document.activeElement;
			});
		  });
		}

		function updateCharCount(textareaId) {
			const textarea = document.getElementById(textareaId);
			const countElem = document.getElementById(textareaId + '-count');
			const len = textarea.value.length;
			if (textarea && countElem) {
				countElem.textContent = len;
			}
		}

		async function apiRequest(method, url, data = null) {
		  try {
		    const options = {
		      method: method.toUpperCase(),
		      headers: { 'Content-Type': 'application/json' },
		      ...(data && { body: typeof data === 'string' ? data : JSON.stringify(data) })
		    };

		    const res = await fetch(contextPath + url, options);
		    const contentType = res.headers.get('content-type');

		    const response = contentType && contentType.includes('application/json')
		      ? await res.json()
		      : await res.text();

		    if (!res.ok) {
		      const message = response?.message || res.statusText || 'Unknown error';
		      console.error('Fetch failed:', message);
		      return null;
		    }

			document.getElementById("commonPerloader").style.display="none";
		    return response;
		  } catch (err) {
		    console.error('Fetch failed:', err.message || err);
		    return null;
		  }
		}
		
		function fetchAJAXTableData(url, thisTabl, thisTablObj){
			thisTablObj.loading = true;

			return apiRequest('GET', url)
				.then(data => {
					if (thisTablObj.currPage == 0){
						thisTabl.setData(data.content);
					}else{
						thisTabl.addData(data.content);
					}
					thisTablObj.totalPages = data.totalPages;
					thisTablObj.currPage++;
					thisTablObj.loading = false;
				});
		}

		const pageSize = 500;
		var user_tbl = new Tabulator("#officerTbl", {
			layout: "fitColumns",
			maxHeight: 200,
			printAsHtml: true,
			printStyled: true,
			columns: [
				{title: "userid", field: "userId", visible: false},
				{title: "Last Name", field: "userLastName"},
				{title: "First Name", field: "userFirstName"},
				{title: "Mi", field: "userMidName", width: 50},
				{title: "Suffix", field: "userSuffixName", width: 100},
			]
		});
		let user_tblObj = {currPage: 0, totalPages: 0, currSrch: "", loading: false}
		fetchAJAXTableData('searchUsers?search='+user_tblObj.currSrch+'&page='+user_tblObj.currPage+'&size='+pageSize, user_tbl, user_tblObj);
		
		$(document).ready(function() {
			// initialize datatable
			$('#PrintStatusSheetCase').dataTable({
				scrollY: "585px",
	            scrollCollapse: true,
	            paging: false,
	            searching: false,
	            ordering: false,
	            showNEntries: false,
	            info: false,
			});

		});

		function clearPropertyScreen(){
			$('#sbiNumberInput').val("");
			currCommitNo = null;

			$("#moneyAmt-Items").val('');
			$("#boxNum").val('');
			$("#dateCollected").val('');
			$("#dateReturned-Items").val('');
			$("#collectedByItemsInp").val('');
			$("#returnedByItemsInp").val('');

			$("#moneyAmt-Dept").val('');
			$("#issuedByDeptInp").val('');
			$("#dateIssued").val('');
			$("#returnedByItemsInp").val('');
			$("#dateReturned-Dept").val('');

			clearItmsPropDescFields();
			clearDeptPropDescFields();

			resetIssdItmsTab();
			resetColtItmsTab();

			enableOrDisableIssdItmsMoveBtns();
			enableOrDisableColtItmsMoveBtns();

			updateCharCount("deptIssdCmnts");
			updateCharCount("itmsColtCmnts");

			//setTimeout(() => {
				$('#sbiNumberInput').focus();
			//}, 300);
			//$('.imageContainerPhoto').attr('src', 'data:image/jpeg;base64,'+imagendatanull);
			clearFormHeaderData();
			
		}

		function onDateInput(e) {
			/*const input = e.target;
			let value = input.value.replace(/\D/g, ""); // Remove non-digits
		
			if (value.length > 8) value = value.slice(0, 8); // Max 8 digits
		
			let formatted = "";
			if (value.length > 0) formatted += value.substring(0, 2);
			if (value.length > 2) formatted += "/" + value.substring(2, 4);
			if (value.length > 4) formatted += "/" + value.substring(4, 8);
		
			input.value = formatted;*/
			
			const input = e.target;
			    const rawValue = input.value;
			    const originalPos = input.selectionStart;

			    // Remove all non-digits
			    let digits = rawValue.replace(/\D/g, "");
			    if (digits.length > 8) digits = digits.slice(0, 8);

			    // Reformat with slashes
			    let formatted = "";
			    if (digits.length > 0) formatted += digits.substring(0, 2);
			    if (digits.length > 2) formatted += "/" + digits.substring(2, 4);
			    if (digits.length > 4) formatted += "/" + digits.substring(4, 8);

			    // Set the new value
			    input.value = formatted;

			    // ===== Caret Adjustment =====
			    // Count how many non-digit characters were added before original cursor position
			    let pos = originalPos;

			    // Adjust if slash was added before current position
			    if (pos > 2 && digits.length >= 3) pos++;
			    if (pos > 4 && digits.length >= 5) pos++;

			    // Restore the caret position
			    input.setSelectionRange(pos, pos);
		}

		function onDateKeyDown(e) {
			const allowedKeys = [
				"Backspace", "ArrowLeft", "ArrowRight", "Tab", "Delete"
			];

			if (
				allowedKeys.includes(e.key) ||
				(e.ctrlKey || e.metaKey) // Allow Ctrl+C, Ctrl+V, etc.
			) {
				return;
			}

			if (!/\d/.test(e.key)) {
				e.preventDefault(); // Block non-numeric keys
			}
		}

		// On blur, pad missing month/day if single digit left
		function onDateBlur(e) {
			/*const input = e.target;
			let parts = input.value.split("/");

			if (parts.length > 0) {
			// Pad month if single digit
			if (parts[0].length === 1) parts[0] = "0" + parts[0];
			}
			if (parts.length > 1) {
			// Pad day if single digit
			if (parts[1].length === 1) parts[1] = "0" + parts[1];
			}
			input.value = parts.filter(Boolean).join("/");*/
			const input = e.target;
			const blockFuture = input.classList.contains("date-input2");
			console.log(blockFuture);
			const inpVal = input.value?.trim();
			
			if (!inpVal) {
				return; // nothing to validate
			}
			
			const result = validateDate(inpVal, blockFuture);

			if (!result.valid) {
				custom_msg('CUW', result.reason);
				input.value = "";
				//$(input).datepicker('hide');
				$(input).trigger("change");
				input.focus();
				return;
			}

				input.value = result.formattedDate;
		}
		function validateDate(inputValue, blockFuture) {
			console.log(inputValue);
			let parts = inputValue.split("/");

			//if (parts.length < 3 && parts.length > 0) return { valid: false, reason: "Invalid date" };

			// Pad month and day
			console.log(parts);
			if (parts[0].length === 1) parts[0] = "0" + parts[0];
			if (parts[1].length === 1) parts[1] = "0" + parts[1];

			const [mm, dd, yyyy] = parts;
			const formattedDate = `${mm}/${dd}/${yyyy}`;

			const dateObj = new Date(`${yyyy}-${mm}-${dd}`);
			if (isNaN(dateObj.getTime())) {
				return { valid: false, reason: "Invalid date format" };
			}

			if(blockFuture){
				const today = new Date();
				dateObj.setHours(0, 0, 0, 0);
				today.setHours(0, 0, 0, 0);

				if (dateObj > today) {
					return { valid: false, reason: "Future date not allowed" };
				}
			}

			return { valid: true, formattedDate };
		}
		
		var relationshipData = [];
		let newPropertyAdded = false;
		$(document).ready(function () {
			
			$('#exit').on('click', function () {
				message('B', 0, function () {
					history.back();
				});
			});
				
				$('#addNewProperty').on('click', async function () {
					if (deptHdrUpdated || deptItmsUpdated || coltItmsUpdated || hdrUpdated) {
						custom_msg('CUW', "Please save your changes before adding new property.");
						return;
					}
					
					if ($('#sbiNumberInput').val() != '' && coltItemsHdrData != [] && issdItemsHdrData != []) {
						//const currTab = localStorage.getItem("lastTab");
						var activeTab = $('.nav-link.active');
						var currTab = activeTab.attr('href');
						if (currTab == "#PropertyTrackingItems_Tab") {
							
							const obj = await createEmptyColtHdrObj(
								coltItemsHdrData.length > 0 ? coltItemsHdrData[0].INSTITUTION_INST_NUM : null, "RPT"
							);
							coltItemsHdrData.unshift(obj);
							currColtPropIndx = 0;
							setPropertyTrackingItemsTabHdr();
							updatedColtItmsHdr = new Set([...updatedColtItmsHdr].map(value => value + 1));
							$('#moneyAmt-Items').focus();
						}
						else if (currTab == "#PropertyTrackingDepartment_Tab") {
							const obj = await createEmptyColtHdrObj(
								issdItemsHdrData.length > 0 ? issdItemsHdrData[0].INSTITUTION_INST_NUM : null, "ISS"
							);
							issdItemsHdrData.unshift(obj);
							currIssdPropIndx = 0;
							setPropertyTrackingDeptTabHdr();
							updatedIssdItmsHdr = new Set([...updatedIssdItmsHdr].map(value => value + 1));
							$('#moneyAmt-Dept').focus();
						}
						newPropertyAdded = true;
					}

				});//}

				$('#cancel').on('click', function () {

					if (deptHdrUpdated || deptItmsUpdated || coltItmsUpdated || hdrUpdated) {

						confirmation("You have unsaved changes. Are you sure you want to clear the screen?", function () {
							//$('#saveProperty').click();
							clearPropertyScreen();
						});
						//document.getElementById("cancel_btn").addEventListener("click", function () {
							//clearPropertyScreen();
							//$('#sbiNumberInput').val("");
							//location.reload();
						//});

					} else {
						clearPropertyScreen();
					}
				});

				$.ajax({
					url: contextPath + 'getRelationshipTable',
					type: 'GET',
					success: function (response) {
						if (response) {
							
							const $select = $("#returnRelationItems");
							            $select.empty().append(`<option value="null"></option>`);

							            $.each(response, function (index, item) {
							                $select.append(new Option(item.RELATIONSHIP_DESC, item.RELATIONSHIP_CODE));
							            });

							            $select.select2({ placeholder: 'Select Relationship' });
							
							//populateDropdown(relationshipData);

							/*var options = "<option value=\"null\"></option>";
							$.each(response, function (index, item) {
								options += "<option value=\"" + item.RELATIONSHIP_CODE + "\">" + item.RELATIONSHIP_DESC + "</option>";
							});
							document.getElementById("returnRelationItems").innerHTML = options;*/

						}
					}
				});
				
				/*$('#RelationSearchInput').on('input', function() {
				    var searchTerm = $(this).val();
				    filterDropdown(searchTerm);
				});*/
				
				// Set moving to next inp field using up/down arrows
				enableArrowKeyNavigation('.formInputField-itms');
				enableArrowKeyNavigation('.formInputField-dept');
				  
				var clickedModalID = "";
				var currModalBtnClicked = null;
				$("#ObservingOfficer").on('shown.bs.modal', function(){
				    $(this).find('#Find').focus();
				});
				$('#ObservingOfficer').on('hidden.bs.modal', function() {
				  setTimeout(function(){
					  currModalBtnClicked.querySelector(".btn").focus();
					  currModalBtnClicked = null;
				  },100);
				});

				user_tbl.on("scrollVertical", function () {
					if(!user_tblObj.loading && user_tblObj.currPage < user_tblObj.totalPages){
						fetchAJAXTableData('searchUsers?search='+user_tblObj.currSrch+'&page='+user_tblObj.currPage+'&size='+pageSize, user_tbl, user_tblObj);
						
					}
				});

				$(".ObservingOfficer").on("click", function () {
					clickedModalID = $(this).attr('id'); // Get the ID of the clicked element
					//$('#Find').val("");
					//user_tbl.clearData();
					
					$("#peopleModalTitle").html($(this).attr('modal-title'));
					currModalBtnClicked = this;
				});

				$('#Find').on('keyup', function (e) {
					user_tblObj.currSrch = $(this).val().trim();
					if (e.keyCode == 13) {
						$('#searchUser').trigger('click');
					}
				});

				$("#searchUser").on("click", function () {
					user_tblObj.currPage = 0;
					fetchAJAXTableData('searchUsers?search='+user_tblObj.currSrch+'&page='+user_tblObj.currPage+'&size='+pageSize, user_tbl, user_tblObj);
					//var value = $('#Find').val().toLowerCase();
					//setOfficerTab(value);
				});
				
				/*function setOfficerTab(srchkey) {
					user_tbl.setData('getPropertyUser?srchkey=' + srchkey);
				}*/
				
				function nullHandler(x) {
					/*if (x == null) {
						x = '';
					}
					return x;*/
					return x == null ? '' : x.trim();
				}

				user_tbl.on("rowClick", function (e, row) {
					var curr_fld = $('#current_fld').val();
					var userID = row.getData().userId;
					
					/*var nameParts = [
					    nullHandler(row.getData().userLastName),
					    nullHandler(row.getData().userFirstName),
					    nullHandler(row.getData().userMidName),
					    nullHandler(row.getData().userSuffixName)
					];*/
					
					var nam = nullHandler(row.getData().userLastName) + ', ' + nullHandler(row.getData().userFirstName) + ' ';
					nam += nullHandler(row.getData().userMidName) + ' ' + nullHandler(row.getData().userSuffixName);
					//var nam = nameParts.filter(part => part !== '').join(', ');
								
					$('#' + clickedModalID + "Inp").val(nam.trim());
						$('#' + clickedModalID + "Hdn").val(nam.trim());

						if (clickedModalID == "collectedByItems") {
							coltItemsHdrData[currColtPropIndx].USERS_USER_ID = userID;
							hdrUpdated = true;
							updatedColtItmsHdr.add(currColtPropIndx);
						}
						else if (clickedModalID == "returnedByItems") {
							coltItemsHdrData[currColtPropIndx].USERS_USER_ID_RETURN_BY = userID;
							hdrUpdated = true;
							updatedColtItmsHdr.add(currColtPropIndx);
						}
						else if (clickedModalID == "issuedByDept") {
							issdItemsHdrData[currIssdPropIndx].USERS_USER_ID = userID;
							deptHdrUpdated = true;
							updatedIssdItmsHdr.add(currIssdPropIndx);
						}
						else if (clickedModalID == "returnedToDept") {
							issdItemsHdrData[currIssdPropIndx].USERS_USER_ID_RETURN_BY = userID;
							deptHdrUpdated = true;
							updatedIssdItmsHdr.add(currIssdPropIndx);
						}
						document.querySelectorAll('.modal-backdrop.fade.show').forEach(el => el.remove());
						$('#ObservingOfficer').modal('hide');
						//document.getElementById(clickedModalID).querySelector(".btn").focus();
						//currModalBtnClicked.querySelector(".btn").focus();
						//currModalBtnClicked = null;
						//user_tbl.clearData();
				});

			
				const textareas = document.querySelectorAll('textarea');
				textareas.forEach(textarea => {
					textarea.addEventListener('input', () => {
						updateCharCount(textarea.id);
						if (textarea.value.length>=2000){
													custom_msg('CUW', "Maximum character limit reached. You cannot Paste or Type additional text");
												}
					});
					/*textarea.addEventListener('keyup', () => {
						if (textarea.value.length>=2000){
							custom_msg('CUW', "Maximum character limit reached. You cannot Paste or Type additional text");
						}
					});*/
					// Initialize count on load
					updateCharCount(textarea.id);
				});
			
				/** Input Restrictions */
				document.querySelectorAll(`.numberInputField`).forEach(input => {
					// Add an event listener for the 'input' event
					
					input.addEventListener('keydown', function(e) {
						const allowedKeys = [
						"Backspace", "ArrowLeft", "ArrowRight", "Tab", "Delete",
						"Home", "End"
						];
						if (e.ctrlKey || e.metaKey) return;
						// Remove any non-numeric characters
						//this.value = this.value.replace(/[^0-9]/g, '');
						/*if (
							allowedKeys.includes(e.key) ||
							/^[0-9]$/.test(e.key)
						) {
							return;
						}*/
						if (
							allowedKeys.includes(e.key) ||
							(e.key.length === 1 && /^[0-9]$/.test(e.key))
						) {
							
							return;
						}
						e.preventDefault();
					});
					input.addEventListener('input', (e) => {
						let value = input.value;
						//console.log(input.dataset.maxLength);
						//if(value.length >6){
							value = value.substring(0, input.dataset.maxLength);
							input.value = value;
						//}
					});
				});
				// For Date Fields
				const dateInputs = document.querySelectorAll(".date-input");
				dateInputs.forEach(input => {
				//input.addEventListener("input", onDateInput);
				input.addEventListener("keydown", onDateKeyDown);
				input.addEventListener("change", onDateBlur);
				});

				document.querySelectorAll('.money-input[type="number"]').forEach(input => {
					input.addEventListener('input', (e) => {
						let value = input.value;

						// Remove '-' if typed
						if (value.includes('-')) {
							value = value.replace(/-/g, '');
						}

						// Allow only digits and one decimal point
						// Remove any invalid characters except digits and '.'
						value = value.replace(/[^0-9.]/g, '');

						// Only allow one decimal point
						const parts = value.split('.');
						if (parts.length > 2) {
							value = parts.shift() + '.' + parts.join('');
						}

						// Restrict to 2 decimal places
						if (parts[1]) {
							parts[1] = parts[1].substring(0, input.dataset.maxDec || 2);
							//value = parts[0] + '.' + parts[1];
						}
						
						// Restrict to 5 digits before decimal
						if (parts[0]) {
							parts[0] = parts[0].substring(0, input.dataset.maxInt || 9);
						}
						
						// Reconstruct the value from sanitized parts
						value = parts[0] || '';
						if (parts[1] !== undefined) {
							value += '.' + parts[1];
						}

						// Update the input if modified
						if (input.value !== value) {
							input.value = value;
						}
					});
				});
				document.querySelectorAll('.nameInputField, .textareaField').forEach(input => {
					input.addEventListener('input', () => {
						
						let value = input.value;
						value = value.substring(0, input.dataset.maxLength);
						input.value = value;
						
						/*let value = input.value;

						// Remove characters prone to SQL injection
						// Block: ; ' " = -- \ / < > etc.
						value = value.replace(/[;"`=<>%]/g, '');

						// Optional: Also normalize multiple spaces
						value = value.replace(/\s{2,}/g, ' ');
						// normalize Multiple '-'s
						value = value.replace(/-{2,}/g, '-');

						value = value.trimStart();
						input.value = value;*/
					});
				});
				
				document.getElementById('ok_btn').addEventListener('click', () => {
					setTimeout(() => {
					  if (lastFocusedInput && typeof lastFocusedInput.focus === 'function') {
					    lastFocusedInput.focus();
					  }
					}, 300); // small delay ensures modal closes first
				});
				
			});
	</script>
	<div th:replace="~{fragments/reusable :: reusable}"></div>
	<div th:replace="~{fragments/msgBox :: msgBox}"></div>
	<script type="text/javascript">
		$('#js-page-content').smartPanel();
	</script>
</body>

</html>